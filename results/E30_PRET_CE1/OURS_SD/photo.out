WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.476, total : 2.476 
 {acc} cls : 4.69
------------------------------
<Losses on train> cls : 1.236, total : 1.236
<Accuracies on train> cls : 74.18
Train epoch time: 51.887
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 54.01
------------------------------
<Accuracies on cartoon> test class : 57.68
------------------------------
<Accuracies on art_painting> test class : 69.19
------------------------------
<Accuracies on sketch> test class : 43.90
------------------------------
Total epoch time: 91.719

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.115, total : 0.115 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.086, total : 0.086
<Accuracies on train> cls : 97.32
Train epoch time: 37.804
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 62.04
------------------------------
<Accuracies on cartoon> test class : 64.93
------------------------------
<Accuracies on art_painting> test class : 71.53
------------------------------
<Accuracies on sketch> test class : 55.36
------------------------------
Total epoch time: 67.227

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.054, total : 0.054
<Accuracies on train> cls : 97.93
Train epoch time: 30.068
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 62.17
------------------------------
<Accuracies on cartoon> test class : 62.37
------------------------------
<Accuracies on art_painting> test class : 69.48
------------------------------
<Accuracies on sketch> test class : 58.23
------------------------------
Total epoch time: 59.986

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.053, total : 0.053 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.054, total : 0.054
<Accuracies on train> cls : 98.06
Train epoch time: 24.921
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 61.28
------------------------------
<Accuracies on cartoon> test class : 55.72
------------------------------
<Accuracies on art_painting> test class : 68.80
------------------------------
<Accuracies on sketch> test class : 60.68
------------------------------
Total epoch time: 55.239

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.032, total : 0.032
<Accuracies on train> cls : 98.88
Train epoch time: 22.355
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 65.74
------------------------------
<Accuracies on cartoon> test class : 64.97
------------------------------
<Accuracies on art_painting> test class : 70.70
------------------------------
<Accuracies on sketch> test class : 63.60
------------------------------
Total epoch time: 52.833

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.08
Train epoch time: 21.281
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 64.54
------------------------------
<Accuracies on cartoon> test class : 63.14
------------------------------
<Accuracies on art_painting> test class : 70.41
------------------------------
<Accuracies on sketch> test class : 62.31
------------------------------
Total epoch time: 51.760

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.05
Train epoch time: 20.723
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 61.33
------------------------------
<Accuracies on cartoon> test class : 61.60
------------------------------
<Accuracies on art_painting> test class : 70.95
------------------------------
<Accuracies on sketch> test class : 56.15
------------------------------
Total epoch time: 50.620

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.39
Train epoch time: 20.614
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 66.33
------------------------------
<Accuracies on cartoon> test class : 62.97
------------------------------
<Accuracies on art_painting> test class : 72.36
------------------------------
<Accuracies on sketch> test class : 65.18
------------------------------
Total epoch time: 50.353

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.019, total : 0.019
<Accuracies on train> cls : 99.29
Train epoch time: 19.331
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 65.81
------------------------------
<Accuracies on cartoon> test class : 68.05
------------------------------
<Accuracies on art_painting> test class : 72.12
------------------------------
<Accuracies on sketch> test class : 61.19
------------------------------
Total epoch time: 49.615

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.69
Train epoch time: 18.244
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.18
------------------------------
<Accuracies on cartoon> test class : 67.06
------------------------------
<Accuracies on art_painting> test class : 70.46
------------------------------
<Accuracies on sketch> test class : 63.43
------------------------------
Total epoch time: 49.171

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.56
Train epoch time: 18.718
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.39
------------------------------
<Accuracies on cartoon> test class : 66.55
------------------------------
<Accuracies on art_painting> test class : 71.73
------------------------------
<Accuracies on sketch> test class : 63.50
------------------------------
Total epoch time: 48.479

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.69
Train epoch time: 20.151
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 65.91
------------------------------
<Accuracies on cartoon> test class : 66.25
------------------------------
<Accuracies on art_painting> test class : 73.19
------------------------------
<Accuracies on sketch> test class : 61.90
------------------------------
Total epoch time: 48.986

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.63
Train epoch time: 19.846
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 69.33
------------------------------
<Accuracies on cartoon> test class : 68.26
------------------------------
<Accuracies on art_painting> test class : 72.80
------------------------------
<Accuracies on sketch> test class : 68.16
------------------------------
Total epoch time: 48.301

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.86
Train epoch time: 20.500
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.56
------------------------------
<Accuracies on cartoon> test class : 68.34
------------------------------
<Accuracies on art_painting> test class : 70.61
------------------------------
<Accuracies on sketch> test class : 65.51
------------------------------
Total epoch time: 49.311

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.73
Train epoch time: 19.125
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 64.64
------------------------------
<Accuracies on cartoon> test class : 68.26
------------------------------
<Accuracies on art_painting> test class : 72.27
------------------------------
<Accuracies on sketch> test class : 58.51
------------------------------
Total epoch time: 48.832

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.90
Train epoch time: 18.783
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 64.27
------------------------------
<Accuracies on cartoon> test class : 69.03
------------------------------
<Accuracies on art_painting> test class : 70.46
------------------------------
<Accuracies on sketch> test class : 58.21
------------------------------
Total epoch time: 48.686

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.90
Train epoch time: 19.118
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.04
------------------------------
<Accuracies on cartoon> test class : 64.04
------------------------------
<Accuracies on art_painting> test class : 70.46
------------------------------
<Accuracies on sketch> test class : 67.04
------------------------------
Total epoch time: 48.126

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.66
Train epoch time: 19.138
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.64
------------------------------
<Accuracies on cartoon> test class : 69.07
------------------------------
<Accuracies on art_painting> test class : 69.58
------------------------------
<Accuracies on sketch> test class : 63.65
------------------------------
Total epoch time: 47.916

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.83
Train epoch time: 19.487
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.40
------------------------------
<Accuracies on cartoon> test class : 70.69
------------------------------
<Accuracies on art_painting> test class : 70.70
------------------------------
<Accuracies on sketch> test class : 61.59
------------------------------
Total epoch time: 48.387

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.90
Train epoch time: 18.829
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.89
------------------------------
<Accuracies on cartoon> test class : 69.28
------------------------------
<Accuracies on art_painting> test class : 71.73
------------------------------
<Accuracies on sketch> test class : 65.05
------------------------------
Total epoch time: 47.808

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.86
Train epoch time: 18.442
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 64.04
------------------------------
<Accuracies on cartoon> test class : 68.98
------------------------------
<Accuracies on art_painting> test class : 72.80
------------------------------
<Accuracies on sketch> test class : 56.53
------------------------------
Total epoch time: 48.121

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.69
Train epoch time: 18.496
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 65.61
------------------------------
<Accuracies on cartoon> test class : 67.62
------------------------------
<Accuracies on art_painting> test class : 71.14
------------------------------
<Accuracies on sketch> test class : 61.52
------------------------------
Total epoch time: 48.216

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.66
Train epoch time: 18.600
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.54
------------------------------
<Accuracies on cartoon> test class : 68.94
------------------------------
<Accuracies on art_painting> test class : 71.44
------------------------------
<Accuracies on sketch> test class : 66.79
------------------------------
Total epoch time: 47.831

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.83
Train epoch time: 19.265
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.48
------------------------------
<Accuracies on cartoon> test class : 69.33
------------------------------
<Accuracies on art_painting> test class : 71.34
------------------------------
<Accuracies on sketch> test class : 66.48
------------------------------
Total epoch time: 48.649

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.97
Train epoch time: 19.696
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.60
------------------------------
<Accuracies on cartoon> test class : 71.80
------------------------------
<Accuracies on art_painting> test class : 71.29
------------------------------
<Accuracies on sketch> test class : 63.17
------------------------------
Total epoch time: 48.931

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.86
Train epoch time: 18.504
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.26
------------------------------
<Accuracies on cartoon> test class : 69.41
------------------------------
<Accuracies on art_painting> test class : 72.95
------------------------------
<Accuracies on sketch> test class : 65.13
------------------------------
Total epoch time: 48.256

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.83
Train epoch time: 18.307
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.60
------------------------------
<Accuracies on cartoon> test class : 69.97
------------------------------
<Accuracies on art_painting> test class : 72.51
------------------------------
<Accuracies on sketch> test class : 61.52
------------------------------
Total epoch time: 48.778

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 100.00
Train epoch time: 18.374
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.59
------------------------------
<Accuracies on cartoon> test class : 70.82
------------------------------
<Accuracies on art_painting> test class : 72.46
------------------------------
<Accuracies on sketch> test class : 63.12
------------------------------
Total epoch time: 47.650

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.80
Train epoch time: 19.726
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.22
------------------------------
<Accuracies on cartoon> test class : 71.59
------------------------------
<Accuracies on art_painting> test class : 72.07
------------------------------
<Accuracies on sketch> test class : 64.21
------------------------------
Total epoch time: 48.478

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.83
Train epoch time: 19.666
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.67
------------------------------
<Accuracies on cartoon> test class : 72.87
------------------------------
<Accuracies on art_painting> test class : 73.93
------------------------------
<Accuracies on sketch> test class : 61.31
------------------------------
Total epoch time: 48.965

******************************
Best val 1, corresponding test 0.613268 - best test: 0.693306

******************************
Best val 1.0, corresponding cartoon test 0.6160409450531006

******************************
Best val 1.0, corresponding art_painting test 0.70947265625

******************************
Best val 1.0, corresponding sketch test 0.5614660382270813
