
Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.048, total : 2.048 
 {acc} cls : 18.75
------------------------------
<Losses on train> cls : 1.005, total : 1.005
<Accuracies on train> cls : 72.62
Train epoch time: 37.696
------------------------------
<Accuracies on val> class : 95.32
------------------------------
<Accuracies on test> class : 53.11
------------------------------
<Accuracies on cartoon> test class : 52.22
------------------------------
<Accuracies on art_painting> test class : 61.52
------------------------------
<Accuracies on sketch> test class : 49.25
------------------------------
Total epoch time: 67.186

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.190, total : 0.190 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.219, total : 0.219
<Accuracies on train> cls : 93.44
Train epoch time: 25.725
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 62.25
------------------------------
<Accuracies on cartoon> test class : 63.40
------------------------------
<Accuracies on art_painting> test class : 65.72
------------------------------
<Accuracies on sketch> test class : 59.76
------------------------------
Total epoch time: 54.443

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.285, total : 0.285 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.200, total : 0.200
<Accuracies on train> cls : 94.33
Train epoch time: 23.294
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 53.17
------------------------------
<Accuracies on cartoon> test class : 60.28
------------------------------
<Accuracies on art_painting> test class : 65.97
------------------------------
<Accuracies on sketch> test class : 42.25
------------------------------
Total epoch time: 52.128

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.133, total : 0.133 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.155, total : 0.155
<Accuracies on train> cls : 95.41
Train epoch time: 21.766
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 59.18
------------------------------
<Accuracies on cartoon> test class : 64.04
------------------------------
<Accuracies on art_painting> test class : 66.46
------------------------------
<Accuracies on sketch> test class : 52.48
------------------------------
Total epoch time: 51.485

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.151, total : 0.151 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.118, total : 0.118
<Accuracies on train> cls : 96.40
Train epoch time: 20.137
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 57.87
------------------------------
<Accuracies on cartoon> test class : 63.48
------------------------------
<Accuracies on art_painting> test class : 68.36
------------------------------
<Accuracies on sketch> test class : 49.05
------------------------------
Total epoch time: 49.620

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.107, total : 0.107 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.118, total : 0.118
<Accuracies on train> cls : 96.33
Train epoch time: 20.484
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 59.20
------------------------------
<Accuracies on cartoon> test class : 62.07
------------------------------
<Accuracies on art_painting> test class : 68.12
------------------------------
<Accuracies on sketch> test class : 52.84
------------------------------
Total epoch time: 48.782

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.072, total : 0.072 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.109, total : 0.109
<Accuracies on train> cls : 96.64
Train epoch time: 20.256
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.61
------------------------------
<Accuracies on cartoon> test class : 69.97
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 63.22
------------------------------
Total epoch time: 48.274

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.081, total : 0.081 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.090, total : 0.090
<Accuracies on train> cls : 97.11
Train epoch time: 19.948
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.49
------------------------------
<Accuracies on cartoon> test class : 66.51
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 69.25
------------------------------
Total epoch time: 48.215

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.104, total : 0.104 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.096, total : 0.096
<Accuracies on train> cls : 97.15
Train epoch time: 19.026
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 64.79
------------------------------
<Accuracies on cartoon> test class : 61.60
------------------------------
<Accuracies on art_painting> test class : 68.46
------------------------------
<Accuracies on sketch> test class : 64.77
------------------------------
Total epoch time: 47.121

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.135, total : 0.135 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.086, total : 0.086
<Accuracies on train> cls : 97.35
Train epoch time: 19.467
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 61.84
------------------------------
<Accuracies on cartoon> test class : 59.85
------------------------------
<Accuracies on art_painting> test class : 66.21
------------------------------
<Accuracies on sketch> test class : 60.75
------------------------------
Total epoch time: 47.676

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.060, total : 0.060 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.063, total : 0.063
<Accuracies on train> cls : 97.96
Train epoch time: 18.748
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 64.02
------------------------------
<Accuracies on cartoon> test class : 62.67
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 62.08
------------------------------
Total epoch time: 47.857

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.138, total : 0.138 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.066, total : 0.066
<Accuracies on train> cls : 97.79
Train epoch time: 17.955
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.82
------------------------------
<Accuracies on cartoon> test class : 67.79
------------------------------
<Accuracies on art_painting> test class : 68.55
------------------------------
<Accuracies on sketch> test class : 67.45
------------------------------
Total epoch time: 48.889

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.064, total : 0.064 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.051, total : 0.051
<Accuracies on train> cls : 98.47
Train epoch time: 17.230
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.15
------------------------------
<Accuracies on cartoon> test class : 65.66
------------------------------
<Accuracies on art_painting> test class : 69.19
------------------------------
<Accuracies on sketch> test class : 64.85
------------------------------
Total epoch time: 48.096

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.046, total : 0.046 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.043, total : 0.043
<Accuracies on train> cls : 98.71
Train epoch time: 18.107
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 61.69
------------------------------
<Accuracies on cartoon> test class : 64.33
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 56.15
------------------------------
Total epoch time: 47.693

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.048, total : 0.048
<Accuracies on train> cls : 98.57
Train epoch time: 17.508
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.38
------------------------------
<Accuracies on cartoon> test class : 66.08
------------------------------
<Accuracies on art_painting> test class : 70.36
------------------------------
<Accuracies on sketch> test class : 66.61
------------------------------
Total epoch time: 46.292

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.88
Train epoch time: 18.937
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.66
------------------------------
<Accuracies on cartoon> test class : 66.72
------------------------------
<Accuracies on art_painting> test class : 69.63
------------------------------
<Accuracies on sketch> test class : 65.08
------------------------------
Total epoch time: 48.001

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.040, total : 0.040
<Accuracies on train> cls : 98.57
Train epoch time: 17.755
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.38
------------------------------
<Accuracies on cartoon> test class : 65.15
------------------------------
<Accuracies on art_painting> test class : 70.12
------------------------------
<Accuracies on sketch> test class : 67.29
------------------------------
Total epoch time: 47.012

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.12
Train epoch time: 18.715
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.55
------------------------------
<Accuracies on cartoon> test class : 67.19
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 64.75
------------------------------
Total epoch time: 47.686

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.038, total : 0.038
<Accuracies on train> cls : 98.61
Train epoch time: 19.029
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 66.77
------------------------------
<Accuracies on cartoon> test class : 64.89
------------------------------
<Accuracies on art_painting> test class : 69.53
------------------------------
<Accuracies on sketch> test class : 66.45
------------------------------
Total epoch time: 47.000

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.035, total : 0.035 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.031, total : 0.031
<Accuracies on train> cls : 99.08
Train epoch time: 20.303
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 67.46
------------------------------
<Accuracies on cartoon> test class : 67.06
------------------------------
<Accuracies on art_painting> test class : 71.44
------------------------------
<Accuracies on sketch> test class : 65.61
------------------------------
Total epoch time: 48.211

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.35
Train epoch time: 20.547
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 68.10
------------------------------
<Accuracies on cartoon> test class : 68.60
------------------------------
<Accuracies on art_painting> test class : 72.12
------------------------------
<Accuracies on sketch> test class : 65.72
------------------------------
Total epoch time: 48.876

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 98.98
Train epoch time: 20.047
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.43
------------------------------
<Accuracies on cartoon> test class : 68.00
------------------------------
<Accuracies on art_painting> test class : 70.46
------------------------------
<Accuracies on sketch> test class : 67.63
------------------------------
Total epoch time: 49.052

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.12
Train epoch time: 18.458
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 68.65
------------------------------
<Accuracies on cartoon> test class : 65.83
------------------------------
<Accuracies on art_painting> test class : 71.44
------------------------------
<Accuracies on sketch> test class : 68.87
------------------------------
Total epoch time: 48.057

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.057, total : 0.057 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.25
Train epoch time: 17.773
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.86
------------------------------
<Accuracies on cartoon> test class : 67.06
------------------------------
<Accuracies on art_painting> test class : 70.65
------------------------------
<Accuracies on sketch> test class : 66.89
------------------------------
Total epoch time: 46.732

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.35
Train epoch time: 18.902
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 65.06
------------------------------
<Accuracies on cartoon> test class : 66.04
------------------------------
<Accuracies on art_painting> test class : 70.41
------------------------------
<Accuracies on sketch> test class : 61.70
------------------------------
Total epoch time: 47.747

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.35
Train epoch time: 18.115
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 67.72
------------------------------
<Accuracies on cartoon> test class : 66.72
------------------------------
<Accuracies on art_painting> test class : 70.36
------------------------------
<Accuracies on sketch> test class : 66.94
------------------------------
Total epoch time: 47.786

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.019, total : 0.019
<Accuracies on train> cls : 99.32
Train epoch time: 17.655
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 67.50
------------------------------
<Accuracies on cartoon> test class : 67.62
------------------------------
<Accuracies on art_painting> test class : 71.00
------------------------------
<Accuracies on sketch> test class : 65.61
------------------------------
Total epoch time: 48.141

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.59
Train epoch time: 17.614
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 68.09
------------------------------
<Accuracies on cartoon> test class : 67.11
------------------------------
<Accuracies on art_painting> test class : 70.85
------------------------------
<Accuracies on sketch> test class : 67.24
------------------------------
Total epoch time: 47.923

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.59
Train epoch time: 17.215
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 68.44
------------------------------
<Accuracies on cartoon> test class : 68.43
------------------------------
<Accuracies on art_painting> test class : 71.78
------------------------------
<Accuracies on sketch> test class : 66.71
------------------------------
Total epoch time: 47.329

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.045, total : 0.045 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.73
Train epoch time: 18.810
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 69.23
------------------------------
<Accuracies on cartoon> test class : 68.94
------------------------------
<Accuracies on art_painting> test class : 71.24
------------------------------
<Accuracies on sketch> test class : 68.36
------------------------------
Total epoch time: 47.592

******************************
Best val 1, corresponding test 0.674558 - best test: 0.692345

******************************
Best val 1.0, corresponding cartoon test 0.670648455619812

******************************
Best val 1.0, corresponding art_painting test 0.71435546875

******************************
Best val 1.0, corresponding sketch test 0.6561465859413147
