
Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 1.974, total : 1.974 
 {acc} cls : 16.41
------------------------------
<Losses on train> cls : 1.150, total : 1.150
<Accuracies on train> cls : 72.15
Train epoch time: 20.671
------------------------------
<Accuracies on val> class : 95.91
------------------------------
<Accuracies on test> class : 53.89
------------------------------
<Accuracies on cartoon> test class : 58.06
------------------------------
<Accuracies on art_painting> test class : 64.60
------------------------------
<Accuracies on sketch> test class : 45.81
------------------------------
Total epoch time: 50.540

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.222, total : 0.222 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.252, total : 0.252
<Accuracies on train> cls : 92.70
Train epoch time: 18.934
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 60.15
------------------------------
<Accuracies on cartoon> test class : 65.10
------------------------------
<Accuracies on art_painting> test class : 68.90
------------------------------
<Accuracies on sketch> test class : 52.63
------------------------------
Total epoch time: 49.128

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.380, total : 0.380 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.190, total : 0.190
<Accuracies on train> cls : 94.60
Train epoch time: 18.542
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 59.25
------------------------------
<Accuracies on cartoon> test class : 61.69
------------------------------
<Accuracies on art_painting> test class : 65.19
------------------------------
<Accuracies on sketch> test class : 54.70
------------------------------
Total epoch time: 49.443

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.085, total : 0.085 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.134, total : 0.134
<Accuracies on train> cls : 95.69
Train epoch time: 18.330
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 66.41
------------------------------
<Accuracies on cartoon> test class : 67.96
------------------------------
<Accuracies on art_painting> test class : 68.26
------------------------------
<Accuracies on sketch> test class : 64.52
------------------------------
Total epoch time: 47.096

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.143, total : 0.143
<Accuracies on train> cls : 95.52
Train epoch time: 19.355
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 64.61
------------------------------
<Accuracies on cartoon> test class : 65.66
------------------------------
<Accuracies on art_painting> test class : 67.53
------------------------------
<Accuracies on sketch> test class : 62.46
------------------------------
Total epoch time: 48.285

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.142, total : 0.142 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.110, total : 0.110
<Accuracies on train> cls : 96.26
Train epoch time: 18.697
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 62.56
------------------------------
<Accuracies on cartoon> test class : 61.82
------------------------------
<Accuracies on art_painting> test class : 67.72
------------------------------
<Accuracies on sketch> test class : 60.32
------------------------------
Total epoch time: 49.259

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.110, total : 0.110 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.099, total : 0.099
<Accuracies on train> cls : 97.01
Train epoch time: 17.813
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 66.75
------------------------------
<Accuracies on cartoon> test class : 67.36
------------------------------
<Accuracies on art_painting> test class : 68.16
------------------------------
<Accuracies on sketch> test class : 65.64
------------------------------
Total epoch time: 49.071

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.025, total : 0.025 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.079, total : 0.079
<Accuracies on train> cls : 97.59
Train epoch time: 17.385
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 66.13
------------------------------
<Accuracies on cartoon> test class : 64.38
------------------------------
<Accuracies on art_painting> test class : 68.85
------------------------------
<Accuracies on sketch> test class : 65.77
------------------------------
Total epoch time: 49.307

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.065, total : 0.065 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.072, total : 0.072
<Accuracies on train> cls : 97.89
Train epoch time: 17.308
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 67.41
------------------------------
<Accuracies on cartoon> test class : 69.16
------------------------------
<Accuracies on art_painting> test class : 70.26
------------------------------
<Accuracies on sketch> test class : 64.88
------------------------------
Total epoch time: 48.270

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.073, total : 0.073 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.078, total : 0.078
<Accuracies on train> cls : 97.42
Train epoch time: 17.776
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.96
------------------------------
<Accuracies on cartoon> test class : 68.22
------------------------------
<Accuracies on art_painting> test class : 69.53
------------------------------
<Accuracies on sketch> test class : 66.99
------------------------------
Total epoch time: 48.508

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.054, total : 0.054
<Accuracies on train> cls : 98.10
Train epoch time: 18.592
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.10
------------------------------
<Accuracies on cartoon> test class : 65.32
------------------------------
<Accuracies on art_painting> test class : 68.41
------------------------------
<Accuracies on sketch> test class : 67.47
------------------------------
Total epoch time: 48.390

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.060, total : 0.060 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.060, total : 0.060
<Accuracies on train> cls : 97.96
Train epoch time: 17.939
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.79
------------------------------
<Accuracies on cartoon> test class : 66.60
------------------------------
<Accuracies on art_painting> test class : 69.92
------------------------------
<Accuracies on sketch> test class : 65.28
------------------------------
Total epoch time: 48.286

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.097, total : 0.097 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.13
Train epoch time: 17.957
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.84
------------------------------
<Accuracies on cartoon> test class : 63.91
------------------------------
<Accuracies on art_painting> test class : 69.63
------------------------------
<Accuracies on sketch> test class : 67.14
------------------------------
Total epoch time: 47.813

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.064, total : 0.064
<Accuracies on train> cls : 97.96
Train epoch time: 18.029
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.19
------------------------------
<Accuracies on cartoon> test class : 64.89
------------------------------
<Accuracies on art_painting> test class : 69.53
------------------------------
<Accuracies on sketch> test class : 65.23
------------------------------
Total epoch time: 47.435

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.077, total : 0.077 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.048, total : 0.048
<Accuracies on train> cls : 98.61
Train epoch time: 18.967
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.94
------------------------------
<Accuracies on cartoon> test class : 70.14
------------------------------
<Accuracies on art_painting> test class : 69.82
------------------------------
<Accuracies on sketch> test class : 69.89
------------------------------
Total epoch time: 48.005

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.041, total : 0.041
<Accuracies on train> cls : 98.64
Train epoch time: 20.010
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.02
------------------------------
<Accuracies on cartoon> test class : 66.77
------------------------------
<Accuracies on art_painting> test class : 70.70
------------------------------
<Accuracies on sketch> test class : 65.26
------------------------------
Total epoch time: 47.602

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.78
Train epoch time: 19.798
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.90
------------------------------
<Accuracies on cartoon> test class : 67.75
------------------------------
<Accuracies on art_painting> test class : 69.82
------------------------------
<Accuracies on sketch> test class : 66.99
------------------------------
Total epoch time: 48.578

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.037, total : 0.037
<Accuracies on train> cls : 98.85
Train epoch time: 19.674
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 69.28
------------------------------
<Accuracies on cartoon> test class : 66.81
------------------------------
<Accuracies on art_painting> test class : 69.63
------------------------------
<Accuracies on sketch> test class : 70.58
------------------------------
Total epoch time: 47.555

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.78
Train epoch time: 19.104
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 68.21
------------------------------
<Accuracies on cartoon> test class : 63.14
------------------------------
<Accuracies on art_painting> test class : 70.80
------------------------------
<Accuracies on sketch> test class : 69.89
------------------------------
Total epoch time: 47.320

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.203, total : 0.203 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.042, total : 0.042
<Accuracies on train> cls : 98.40
Train epoch time: 19.091
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 69.21
------------------------------
<Accuracies on cartoon> test class : 66.89
------------------------------
<Accuracies on art_painting> test class : 70.65
------------------------------
<Accuracies on sketch> test class : 69.84
------------------------------
Total epoch time: 46.988

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.42
Train epoch time: 19.418
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.08
------------------------------
<Accuracies on cartoon> test class : 64.46
------------------------------
<Accuracies on art_painting> test class : 70.17
------------------------------
<Accuracies on sketch> test class : 71.26
------------------------------
Total epoch time: 47.202

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.39
Train epoch time: 18.612
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 70.20
------------------------------
<Accuracies on cartoon> test class : 69.58
------------------------------
<Accuracies on art_painting> test class : 71.58
------------------------------
<Accuracies on sketch> test class : 69.84
------------------------------
Total epoch time: 48.177

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.035, total : 0.035 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.25
Train epoch time: 18.642
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 70.57
------------------------------
<Accuracies on cartoon> test class : 70.14
------------------------------
<Accuracies on art_painting> test class : 70.75
------------------------------
<Accuracies on sketch> test class : 70.73
------------------------------
Total epoch time: 48.403

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.026, total : 0.026
<Accuracies on train> cls : 99.25
Train epoch time: 17.721
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 71.43
------------------------------
<Accuracies on cartoon> test class : 69.20
------------------------------
<Accuracies on art_painting> test class : 71.29
------------------------------
<Accuracies on sketch> test class : 72.84
------------------------------
Total epoch time: 48.247

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.63
Train epoch time: 17.438
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 71.59
------------------------------
<Accuracies on cartoon> test class : 67.92
------------------------------
<Accuracies on art_painting> test class : 71.78
------------------------------
<Accuracies on sketch> test class : 73.68
------------------------------
Total epoch time: 47.465

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.42
Train epoch time: 17.979
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 71.41
------------------------------
<Accuracies on cartoon> test class : 68.47
------------------------------
<Accuracies on art_painting> test class : 71.00
------------------------------
<Accuracies on sketch> test class : 73.38
------------------------------
Total epoch time: 46.819

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.56
Train epoch time: 18.660
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 72.38
------------------------------
<Accuracies on cartoon> test class : 69.62
------------------------------
<Accuracies on art_painting> test class : 71.24
------------------------------
<Accuracies on sketch> test class : 74.62
------------------------------
Total epoch time: 48.272

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.49
Train epoch time: 18.390
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 71.84
------------------------------
<Accuracies on cartoon> test class : 69.67
------------------------------
<Accuracies on art_painting> test class : 71.68
------------------------------
<Accuracies on sketch> test class : 73.22
------------------------------
Total epoch time: 48.059

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.49
Train epoch time: 18.180
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 71.73
------------------------------
<Accuracies on cartoon> test class : 69.71
------------------------------
<Accuracies on art_painting> test class : 71.39
------------------------------
<Accuracies on sketch> test class : 73.12
------------------------------
Total epoch time: 48.293

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.42
Train epoch time: 18.437
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 71.93
------------------------------
<Accuracies on cartoon> test class : 70.65
------------------------------
<Accuracies on art_painting> test class : 71.29
------------------------------
<Accuracies on sketch> test class : 73.02
------------------------------
Total epoch time: 47.507

******************************
Best val 1, corresponding test 0.646076 - best test: 0.723831

******************************
Best val 1.0, corresponding cartoon test 0.6565699577331543

******************************
Best val 1.0, corresponding art_painting test 0.67529296875

******************************
Best val 1.0, corresponding sketch test 0.6245864033699036
