WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: teston

New epoch - lr: 0.003
[1/28 iteration of epoch 1/30] 
 {loss} cls : 1.987, total : 1.987 
 {acc} cls : 18.75
------------------------------
<Losses on train> cls : 1.519, total : 1.519
<Accuracies on train> cls : 66.74
Train epoch time: 28.690
------------------------------
<Accuracies on val> class : 87.50
------------------------------
<Accuracies on test> class : 65.11
------------------------------
<Accuracies on photo> test class : 93.59
------------------------------
<Accuracies on cartoon> test class : 66.51
------------------------------
<Accuracies on sketch> test class : 52.18
------------------------------
Total epoch time: 48.643

New epoch - lr: 0.003
[1/28 iteration of epoch 2/30] 
 {loss} cls : 0.288, total : 0.288 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.245, total : 0.245
<Accuracies on train> cls : 92.86
Train epoch time: 23.135
------------------------------
<Accuracies on val> class : 85.58
------------------------------
<Accuracies on test> class : 71.90
------------------------------
<Accuracies on photo> test class : 96.35
------------------------------
<Accuracies on cartoon> test class : 70.09
------------------------------
<Accuracies on sketch> test class : 62.59
------------------------------
Total epoch time: 43.013

New epoch - lr: 0.003
[1/28 iteration of epoch 3/30] 
 {loss} cls : 0.149, total : 0.149 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.149, total : 0.149
<Accuracies on train> cls : 95.28
Train epoch time: 19.507
------------------------------
<Accuracies on val> class : 87.02
------------------------------
<Accuracies on test> class : 72.47
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 73.93
------------------------------
<Accuracies on sketch> test class : 61.34
------------------------------
Total epoch time: 39.456

New epoch - lr: 0.003
[1/28 iteration of epoch 4/30] 
 {loss} cls : 0.144, total : 0.144 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.127, total : 0.127
<Accuracies on train> cls : 95.56
Train epoch time: 17.447
------------------------------
<Accuracies on val> class : 87.02
------------------------------
<Accuracies on test> class : 71.65
------------------------------
<Accuracies on photo> test class : 95.57
------------------------------
<Accuracies on cartoon> test class : 73.55
------------------------------
<Accuracies on sketch> test class : 60.35
------------------------------
Total epoch time: 38.847

New epoch - lr: 0.003
[1/28 iteration of epoch 5/30] 
 {loss} cls : 0.055, total : 0.055 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.093, total : 0.093
<Accuracies on train> cls : 96.71
Train epoch time: 15.527
------------------------------
<Accuracies on val> class : 89.90
------------------------------
<Accuracies on test> class : 77.63
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 75.68
------------------------------
<Accuracies on sketch> test class : 70.73
------------------------------
Total epoch time: 37.535

New epoch - lr: 0.003
[1/28 iteration of epoch 6/30] 
 {loss} cls : 0.088, total : 0.088 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.071, total : 0.071
<Accuracies on train> cls : 97.88
Train epoch time: 15.682
------------------------------
<Accuracies on val> class : 88.94
------------------------------
<Accuracies on test> class : 78.48
------------------------------
<Accuracies on photo> test class : 95.99
------------------------------
<Accuracies on cartoon> test class : 73.55
------------------------------
<Accuracies on sketch> test class : 73.99
------------------------------
Total epoch time: 36.652

New epoch - lr: 0.003
[1/28 iteration of epoch 7/30] 
 {loss} cls : 0.036, total : 0.036 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.051, total : 0.051
<Accuracies on train> cls : 98.05
Train epoch time: 15.803
------------------------------
<Accuracies on val> class : 87.98
------------------------------
<Accuracies on test> class : 76.92
------------------------------
<Accuracies on photo> test class : 95.93
------------------------------
<Accuracies on cartoon> test class : 75.94
------------------------------
<Accuracies on sketch> test class : 69.43
------------------------------
Total epoch time: 37.426

New epoch - lr: 0.003
[1/28 iteration of epoch 8/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.053, total : 0.053
<Accuracies on train> cls : 97.96
Train epoch time: 15.176
------------------------------
<Accuracies on val> class : 89.42
------------------------------
<Accuracies on test> class : 74.28
------------------------------
<Accuracies on photo> test class : 95.87
------------------------------
<Accuracies on cartoon> test class : 74.02
------------------------------
<Accuracies on sketch> test class : 65.26
------------------------------
Total epoch time: 36.557

New epoch - lr: 0.003
[1/28 iteration of epoch 9/30] 
 {loss} cls : 0.086, total : 0.086 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.043, total : 0.043
<Accuracies on train> cls : 98.47
Train epoch time: 14.849
------------------------------
<Accuracies on val> class : 88.94
------------------------------
<Accuracies on test> class : 78.58
------------------------------
<Accuracies on photo> test class : 96.83
------------------------------
<Accuracies on cartoon> test class : 75.21
------------------------------
<Accuracies on sketch> test class : 72.84
------------------------------
Total epoch time: 37.796

New epoch - lr: 0.003
[1/28 iteration of epoch 10/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.14
Train epoch time: 14.842
------------------------------
<Accuracies on val> class : 88.46
------------------------------
<Accuracies on test> class : 76.85
------------------------------
<Accuracies on photo> test class : 96.41
------------------------------
<Accuracies on cartoon> test class : 72.91
------------------------------
<Accuracies on sketch> test class : 70.88
------------------------------
Total epoch time: 36.686

New epoch - lr: 0.003
[1/28 iteration of epoch 11/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.80
Train epoch time: 15.675
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 76.76
------------------------------
<Accuracies on photo> test class : 96.71
------------------------------
<Accuracies on cartoon> test class : 77.09
------------------------------
<Accuracies on sketch> test class : 68.08
------------------------------
Total epoch time: 37.994

New epoch - lr: 0.003
[1/28 iteration of epoch 12/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 99.00
Train epoch time: 16.359
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 76.29
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 75.30
------------------------------
<Accuracies on sketch> test class : 68.26
------------------------------
Total epoch time: 37.487

New epoch - lr: 0.003
[1/28 iteration of epoch 13/30] 
 {loss} cls : 0.029, total : 0.029 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.30
Train epoch time: 16.576
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 76.33
------------------------------
<Accuracies on photo> test class : 96.71
------------------------------
<Accuracies on cartoon> test class : 74.10
------------------------------
<Accuracies on sketch> test class : 69.00
------------------------------
Total epoch time: 36.533

New epoch - lr: 0.003
[1/28 iteration of epoch 14/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.33
Train epoch time: 17.090
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 77.72
------------------------------
<Accuracies on photo> test class : 97.25
------------------------------
<Accuracies on cartoon> test class : 74.66
------------------------------
<Accuracies on sketch> test class : 71.24
------------------------------
Total epoch time: 37.097

New epoch - lr: 0.003
[1/28 iteration of epoch 15/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.22
Train epoch time: 17.283
------------------------------
<Accuracies on val> class : 89.90
------------------------------
<Accuracies on test> class : 78.45
------------------------------
<Accuracies on photo> test class : 96.47
------------------------------
<Accuracies on cartoon> test class : 75.13
------------------------------
<Accuracies on sketch> test class : 72.77
------------------------------
Total epoch time: 36.705

New epoch - lr: 0.003
[1/28 iteration of epoch 16/30] 
 {loss} cls : 0.025, total : 0.025 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 99.02
Train epoch time: 16.534
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 77.74
------------------------------
<Accuracies on photo> test class : 96.47
------------------------------
<Accuracies on cartoon> test class : 75.64
------------------------------
<Accuracies on sketch> test class : 71.04
------------------------------
Total epoch time: 37.821

New epoch - lr: 0.003
[1/28 iteration of epoch 17/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.55
Train epoch time: 16.650
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 73.75
------------------------------
<Accuracies on photo> test class : 96.53
------------------------------
<Accuracies on cartoon> test class : 75.34
------------------------------
<Accuracies on sketch> test class : 63.12
------------------------------
Total epoch time: 37.196

New epoch - lr: 0.003
[1/28 iteration of epoch 18/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.67
Train epoch time: 15.593
------------------------------
<Accuracies on val> class : 92.31
------------------------------
<Accuracies on test> class : 76.29
------------------------------
<Accuracies on photo> test class : 96.95
------------------------------
<Accuracies on cartoon> test class : 75.73
------------------------------
<Accuracies on sketch> test class : 67.85
------------------------------
Total epoch time: 37.891

New epoch - lr: 0.003
[1/28 iteration of epoch 19/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.50
Train epoch time: 16.208
------------------------------
<Accuracies on val> class : 92.79
------------------------------
<Accuracies on test> class : 76.03
------------------------------
<Accuracies on photo> test class : 96.71
------------------------------
<Accuracies on cartoon> test class : 74.19
------------------------------
<Accuracies on sketch> test class : 68.34
------------------------------
Total epoch time: 38.050

New epoch - lr: 0.003
[1/28 iteration of epoch 20/30] 
 {loss} cls : 0.025, total : 0.025 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.019, total : 0.019
<Accuracies on train> cls : 99.47
Train epoch time: 15.587
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 76.75
------------------------------
<Accuracies on photo> test class : 97.37
------------------------------
<Accuracies on cartoon> test class : 74.57
------------------------------
<Accuracies on sketch> test class : 69.28
------------------------------
Total epoch time: 35.252

New epoch - lr: 0.003
[1/28 iteration of epoch 21/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.55
Train epoch time: 15.809
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 77.19
------------------------------
<Accuracies on photo> test class : 97.07
------------------------------
<Accuracies on cartoon> test class : 74.96
------------------------------
<Accuracies on sketch> test class : 70.07
------------------------------
Total epoch time: 35.333

New epoch - lr: 0.003
[1/28 iteration of epoch 22/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.67
Train epoch time: 15.307
------------------------------
<Accuracies on val> class : 91.35
------------------------------
<Accuracies on test> class : 76.03
------------------------------
<Accuracies on photo> test class : 96.41
------------------------------
<Accuracies on cartoon> test class : 74.19
------------------------------
<Accuracies on sketch> test class : 68.47
------------------------------
Total epoch time: 34.036

New epoch - lr: 0.003
[1/28 iteration of epoch 23/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.72
Train epoch time: 13.493
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 78.09
------------------------------
<Accuracies on photo> test class : 96.53
------------------------------
<Accuracies on cartoon> test class : 74.74
------------------------------
<Accuracies on sketch> test class : 72.26
------------------------------
Total epoch time: 31.615

New epoch - lr: 0.003
[1/28 iteration of epoch 24/30] 
 {loss} cls : 0.046, total : 0.046 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.64
Train epoch time: 13.360
------------------------------
<Accuracies on val> class : 91.35
------------------------------
<Accuracies on test> class : 78.22
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 74.91
------------------------------
<Accuracies on sketch> test class : 72.38
------------------------------
Total epoch time: 31.579

New epoch - lr: 0.003
[1/28 iteration of epoch 25/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.86
Train epoch time: 13.211
------------------------------
<Accuracies on val> class : 89.90
------------------------------
<Accuracies on test> class : 77.62
------------------------------
<Accuracies on photo> test class : 95.87
------------------------------
<Accuracies on cartoon> test class : 73.98
------------------------------
<Accuracies on sketch> test class : 72.03
------------------------------
Total epoch time: 31.182

New epoch - lr: 0.003
[1/28 iteration of epoch 26/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.75
Train epoch time: 12.819
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 77.58
------------------------------
<Accuracies on photo> test class : 96.47
------------------------------
<Accuracies on cartoon> test class : 73.34
------------------------------
<Accuracies on sketch> test class : 72.08
------------------------------
Total epoch time: 30.839

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 27/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.80
Train epoch time: 12.786
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 76.97
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 73.76
------------------------------
<Accuracies on sketch> test class : 70.55
------------------------------
Total epoch time: 32.001

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 28/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.67
Train epoch time: 13.078
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 77.79
------------------------------
<Accuracies on photo> test class : 96.23
------------------------------
<Accuracies on cartoon> test class : 74.40
------------------------------
<Accuracies on sketch> test class : 71.98
------------------------------
Total epoch time: 31.667

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 29/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.80
Train epoch time: 13.052
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 78.32
------------------------------
<Accuracies on photo> test class : 96.47
------------------------------
<Accuracies on cartoon> test class : 75.34
------------------------------
<Accuracies on sketch> test class : 72.38
------------------------------
Total epoch time: 30.713

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 30/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.83
Train epoch time: 13.045
------------------------------
<Accuracies on val> class : 91.35
------------------------------
<Accuracies on test> class : 78.55
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 75.64
------------------------------
<Accuracies on sketch> test class : 72.61
------------------------------
Total epoch time: 30.189

******************************
Best val 0.927885, corresponding test 0.760292 - best test: 0.785849

******************************
Best val 0.9278846383094788, corresponding photo test 0.9670658707618713

******************************
Best val 0.9278846383094788, corresponding cartoon test 0.7418941855430603

******************************
Best val 0.9278846383094788, corresponding sketch test 0.6833800077438354
