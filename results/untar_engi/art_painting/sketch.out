WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: teston

New epoch - lr: 0.003
[1/55 iteration of epoch 1/30] 
 {loss} cls : 1.918, total : 1.918 
 {acc} cls : 18.75
[31/55 iteration of epoch 1/30] 
 {loss} cls : 0.980, total : 0.980 
 {acc} cls : 68.75
------------------------------
<Losses on train> cls : 1.157, total : 1.157
<Accuracies on train> cls : 65.61
Train epoch time: 38.225
------------------------------
<Accuracies on val> class : 86.18
------------------------------
<Accuracies on test> class : 53.51
------------------------------
<Accuracies on photo> test class : 55.09
------------------------------
<Accuracies on cartoon> test class : 59.47
------------------------------
<Accuracies on art_painting> test class : 45.41
------------------------------
Total epoch time: 55.850

New epoch - lr: 0.003
[1/55 iteration of epoch 2/30] 
 {loss} cls : 0.500, total : 0.500 
 {acc} cls : 78.91
[31/55 iteration of epoch 2/30] 
 {loss} cls : 0.328, total : 0.328 
 {acc} cls : 86.72
------------------------------
<Losses on train> cls : 0.452, total : 0.452
<Accuracies on train> cls : 82.43
Train epoch time: 29.314
------------------------------
<Accuracies on val> class : 90.70
------------------------------
<Accuracies on test> class : 63.72
------------------------------
<Accuracies on photo> test class : 68.14
------------------------------
<Accuracies on cartoon> test class : 69.54
------------------------------
<Accuracies on art_painting> test class : 53.47
------------------------------
Total epoch time: 45.673

New epoch - lr: 0.003
[1/55 iteration of epoch 3/30] 
 {loss} cls : 0.364, total : 0.364 
 {acc} cls : 86.72
[31/55 iteration of epoch 3/30] 
 {loss} cls : 0.473, total : 0.473 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.406, total : 0.406
<Accuracies on train> cls : 84.40
Train epoch time: 27.415
------------------------------
<Accuracies on val> class : 92.21
------------------------------
<Accuracies on test> class : 54.98
------------------------------
<Accuracies on photo> test class : 56.41
------------------------------
<Accuracies on cartoon> test class : 66.68
------------------------------
<Accuracies on art_painting> test class : 40.43
------------------------------
Total epoch time: 43.868

New epoch - lr: 0.003
[1/55 iteration of epoch 4/30] 
 {loss} cls : 0.437, total : 0.437 
 {acc} cls : 83.59
[31/55 iteration of epoch 4/30] 
 {loss} cls : 0.433, total : 0.433 
 {acc} cls : 83.59
------------------------------
<Losses on train> cls : 0.367, total : 0.367
<Accuracies on train> cls : 85.65
Train epoch time: 26.782
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 68.28
------------------------------
<Accuracies on photo> test class : 72.75
------------------------------
<Accuracies on cartoon> test class : 77.52
------------------------------
<Accuracies on art_painting> test class : 54.05
------------------------------
Total epoch time: 44.473

New epoch - lr: 0.003
[1/55 iteration of epoch 5/30] 
 {loss} cls : 0.352, total : 0.352 
 {acc} cls : 89.06
[31/55 iteration of epoch 5/30] 
 {loss} cls : 0.289, total : 0.289 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.337, total : 0.337
<Accuracies on train> cls : 87.09
Train epoch time: 24.931
------------------------------
<Accuracies on val> class : 91.71
------------------------------
<Accuracies on test> class : 62.54
------------------------------
<Accuracies on photo> test class : 70.96
------------------------------
<Accuracies on cartoon> test class : 73.29
------------------------------
<Accuracies on art_painting> test class : 43.36
------------------------------
Total epoch time: 42.791

New epoch - lr: 0.003
[1/55 iteration of epoch 6/30] 
 {loss} cls : 0.373, total : 0.373 
 {acc} cls : 86.72
[31/55 iteration of epoch 6/30] 
 {loss} cls : 0.279, total : 0.279 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.334, total : 0.334
<Accuracies on train> cls : 86.59
Train epoch time: 25.368
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 64.10
------------------------------
<Accuracies on photo> test class : 70.18
------------------------------
<Accuracies on cartoon> test class : 74.83
------------------------------
<Accuracies on art_painting> test class : 46.88
------------------------------
Total epoch time: 42.209

New epoch - lr: 0.003
[1/55 iteration of epoch 7/30] 
 {loss} cls : 0.313, total : 0.313 
 {acc} cls : 90.62
[31/55 iteration of epoch 7/30] 
 {loss} cls : 0.276, total : 0.276 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.310, total : 0.310
<Accuracies on train> cls : 87.51
Train epoch time: 26.086
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 66.03
------------------------------
<Accuracies on photo> test class : 77.07
------------------------------
<Accuracies on cartoon> test class : 72.99
------------------------------
<Accuracies on art_painting> test class : 49.07
------------------------------
Total epoch time: 43.027

New epoch - lr: 0.003
[1/55 iteration of epoch 8/30] 
 {loss} cls : 0.259, total : 0.259 
 {acc} cls : 90.62
[31/55 iteration of epoch 8/30] 
 {loss} cls : 0.242, total : 0.242 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.313, total : 0.313
<Accuracies on train> cls : 87.49
Train epoch time: 27.179
------------------------------
<Accuracies on val> class : 91.71
------------------------------
<Accuracies on test> class : 68.51
------------------------------
<Accuracies on photo> test class : 76.89
------------------------------
<Accuracies on cartoon> test class : 73.98
------------------------------
<Accuracies on art_painting> test class : 55.42
------------------------------
Total epoch time: 43.097

New epoch - lr: 0.003
[1/55 iteration of epoch 9/30] 
 {loss} cls : 0.304, total : 0.304 
 {acc} cls : 86.72
[31/55 iteration of epoch 9/30] 
 {loss} cls : 0.304, total : 0.304 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.312, total : 0.312
<Accuracies on train> cls : 87.54
Train epoch time: 27.560
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 72.48
------------------------------
<Accuracies on photo> test class : 83.29
------------------------------
<Accuracies on cartoon> test class : 74.57
------------------------------
<Accuracies on art_painting> test class : 61.28
------------------------------
Total epoch time: 43.916

New epoch - lr: 0.003
[1/55 iteration of epoch 10/30] 
 {loss} cls : 0.182, total : 0.182 
 {acc} cls : 92.19
[31/55 iteration of epoch 10/30] 
 {loss} cls : 0.281, total : 0.281 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.282, total : 0.282
<Accuracies on train> cls : 89.09
Train epoch time: 25.973
------------------------------
<Accuracies on val> class : 93.47
------------------------------
<Accuracies on test> class : 71.82
------------------------------
<Accuracies on photo> test class : 82.69
------------------------------
<Accuracies on cartoon> test class : 75.38
------------------------------
<Accuracies on art_painting> test class : 58.89
------------------------------
Total epoch time: 43.345

New epoch - lr: 0.003
[1/55 iteration of epoch 11/30] 
 {loss} cls : 0.299, total : 0.299 
 {acc} cls : 85.16
[31/55 iteration of epoch 11/30] 
 {loss} cls : 0.391, total : 0.391 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.289, total : 0.289
<Accuracies on train> cls : 88.44
Train epoch time: 25.922
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 70.55
------------------------------
<Accuracies on photo> test class : 81.20
------------------------------
<Accuracies on cartoon> test class : 75.68
------------------------------
<Accuracies on art_painting> test class : 55.96
------------------------------
Total epoch time: 42.996

New epoch - lr: 0.003
[1/55 iteration of epoch 12/30] 
 {loss} cls : 0.262, total : 0.262 
 {acc} cls : 87.50
[31/55 iteration of epoch 12/30] 
 {loss} cls : 0.196, total : 0.196 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.285, total : 0.285
<Accuracies on train> cls : 88.55
Train epoch time: 26.235
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 72.52
------------------------------
<Accuracies on photo> test class : 84.73
------------------------------
<Accuracies on cartoon> test class : 76.83
------------------------------
<Accuracies on art_painting> test class : 57.62
------------------------------
Total epoch time: 43.369

New epoch - lr: 0.003
[1/55 iteration of epoch 13/30] 
 {loss} cls : 0.178, total : 0.178 
 {acc} cls : 93.75
[31/55 iteration of epoch 13/30] 
 {loss} cls : 0.257, total : 0.257 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.286, total : 0.286
<Accuracies on train> cls : 88.79
Train epoch time: 25.573
------------------------------
<Accuracies on val> class : 91.71
------------------------------
<Accuracies on test> class : 73.18
------------------------------
<Accuracies on photo> test class : 85.87
------------------------------
<Accuracies on cartoon> test class : 76.49
------------------------------
<Accuracies on art_painting> test class : 59.03
------------------------------
Total epoch time: 41.863

New epoch - lr: 0.003
[1/55 iteration of epoch 14/30] 
 {loss} cls : 0.155, total : 0.155 
 {acc} cls : 93.75
[31/55 iteration of epoch 14/30] 
 {loss} cls : 0.284, total : 0.284 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.271, total : 0.271
<Accuracies on train> cls : 89.52
Train epoch time: 26.828
------------------------------
<Accuracies on val> class : 94.22
------------------------------
<Accuracies on test> class : 72.15
------------------------------
<Accuracies on photo> test class : 84.73
------------------------------
<Accuracies on cartoon> test class : 76.19
------------------------------
<Accuracies on art_painting> test class : 57.28
------------------------------
Total epoch time: 43.364

New epoch - lr: 0.003
[1/55 iteration of epoch 15/30] 
 {loss} cls : 0.357, total : 0.357 
 {acc} cls : 85.16
[31/55 iteration of epoch 15/30] 
 {loss} cls : 0.269, total : 0.269 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.267, total : 0.267
<Accuracies on train> cls : 89.30
Train epoch time: 25.905
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 75.82
------------------------------
<Accuracies on photo> test class : 86.89
------------------------------
<Accuracies on cartoon> test class : 77.01
------------------------------
<Accuracies on art_painting> test class : 65.43
------------------------------
Total epoch time: 42.758

New epoch - lr: 0.003
[1/55 iteration of epoch 16/30] 
 {loss} cls : 0.208, total : 0.208 
 {acc} cls : 91.41
[31/55 iteration of epoch 16/30] 
 {loss} cls : 0.351, total : 0.351 
 {acc} cls : 83.59
------------------------------
<Losses on train> cls : 0.259, total : 0.259
<Accuracies on train> cls : 89.72
Train epoch time: 25.842
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 76.54
------------------------------
<Accuracies on photo> test class : 86.89
------------------------------
<Accuracies on cartoon> test class : 78.33
------------------------------
<Accuracies on art_painting> test class : 66.06
------------------------------
Total epoch time: 42.736

New epoch - lr: 0.003
[1/55 iteration of epoch 17/30] 
 {loss} cls : 0.112, total : 0.112 
 {acc} cls : 94.53
[31/55 iteration of epoch 17/30] 
 {loss} cls : 0.279, total : 0.279 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.263, total : 0.263
<Accuracies on train> cls : 89.28
Train epoch time: 25.814
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 71.10
------------------------------
<Accuracies on photo> test class : 82.46
------------------------------
<Accuracies on cartoon> test class : 74.02
------------------------------
<Accuracies on art_painting> test class : 58.50
------------------------------
Total epoch time: 42.127

New epoch - lr: 0.003
[1/55 iteration of epoch 18/30] 
 {loss} cls : 0.192, total : 0.192 
 {acc} cls : 91.41
[31/55 iteration of epoch 18/30] 
 {loss} cls : 0.388, total : 0.388 
 {acc} cls : 85.16
------------------------------
<Losses on train> cls : 0.263, total : 0.263
<Accuracies on train> cls : 89.50
Train epoch time: 27.335
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 72.06
------------------------------
<Accuracies on photo> test class : 83.59
------------------------------
<Accuracies on cartoon> test class : 75.94
------------------------------
<Accuracies on art_painting> test class : 58.20
------------------------------
Total epoch time: 44.368

New epoch - lr: 0.003
[1/55 iteration of epoch 19/30] 
 {loss} cls : 0.249, total : 0.249 
 {acc} cls : 89.06
[31/55 iteration of epoch 19/30] 
 {loss} cls : 0.234, total : 0.234 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.259, total : 0.259
<Accuracies on train> cls : 89.55
Train epoch time: 25.747
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 71.21
------------------------------
<Accuracies on photo> test class : 82.40
------------------------------
<Accuracies on cartoon> test class : 75.34
------------------------------
<Accuracies on art_painting> test class : 57.37
------------------------------
Total epoch time: 42.423

New epoch - lr: 0.003
[1/55 iteration of epoch 20/30] 
 {loss} cls : 0.226, total : 0.226 
 {acc} cls : 90.62
[31/55 iteration of epoch 20/30] 
 {loss} cls : 0.296, total : 0.296 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.265, total : 0.265
<Accuracies on train> cls : 89.36
Train epoch time: 25.683
------------------------------
<Accuracies on val> class : 93.47
------------------------------
<Accuracies on test> class : 70.34
------------------------------
<Accuracies on photo> test class : 80.24
------------------------------
<Accuracies on cartoon> test class : 75.64
------------------------------
<Accuracies on art_painting> test class : 56.20
------------------------------
Total epoch time: 43.728

New epoch - lr: 0.003
[1/55 iteration of epoch 21/30] 
 {loss} cls : 0.212, total : 0.212 
 {acc} cls : 90.62
[31/55 iteration of epoch 21/30] 
 {loss} cls : 0.274, total : 0.274 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.248, total : 0.248
<Accuracies on train> cls : 90.07
Train epoch time: 25.129
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 73.03
------------------------------
<Accuracies on photo> test class : 84.13
------------------------------
<Accuracies on cartoon> test class : 77.73
------------------------------
<Accuracies on art_painting> test class : 58.59
------------------------------
Total epoch time: 43.117

New epoch - lr: 0.003
[1/55 iteration of epoch 22/30] 
 {loss} cls : 0.258, total : 0.258 
 {acc} cls : 88.28
[31/55 iteration of epoch 22/30] 
 {loss} cls : 0.271, total : 0.271 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.265, total : 0.265
<Accuracies on train> cls : 89.32
Train epoch time: 25.255
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 70.65
------------------------------
<Accuracies on photo> test class : 82.04
------------------------------
<Accuracies on cartoon> test class : 77.09
------------------------------
<Accuracies on art_painting> test class : 54.00
------------------------------
Total epoch time: 42.457

New epoch - lr: 0.003
[1/55 iteration of epoch 23/30] 
 {loss} cls : 0.285, total : 0.285 
 {acc} cls : 88.28
[31/55 iteration of epoch 23/30] 
 {loss} cls : 0.280, total : 0.280 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.250, total : 0.250
<Accuracies on train> cls : 89.90
Train epoch time: 25.823
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 73.16
------------------------------
<Accuracies on photo> test class : 85.51
------------------------------
<Accuracies on cartoon> test class : 76.96
------------------------------
<Accuracies on art_painting> test class : 58.74
------------------------------
Total epoch time: 42.887

New epoch - lr: 0.003
[1/55 iteration of epoch 24/30] 
 {loss} cls : 0.257, total : 0.257 
 {acc} cls : 92.97
[31/55 iteration of epoch 24/30] 
 {loss} cls : 0.150, total : 0.150 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.249, total : 0.249
<Accuracies on train> cls : 90.09
Train epoch time: 26.683
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 70.31
------------------------------
<Accuracies on photo> test class : 81.86
------------------------------
<Accuracies on cartoon> test class : 75.90
------------------------------
<Accuracies on art_painting> test class : 54.49
------------------------------
Total epoch time: 43.414

New epoch - lr: 0.003
[1/55 iteration of epoch 25/30] 
 {loss} cls : 0.282, total : 0.282 
 {acc} cls : 87.50
[31/55 iteration of epoch 25/30] 
 {loss} cls : 0.268, total : 0.268 
 {acc} cls : 86.72
------------------------------
<Losses on train> cls : 0.252, total : 0.252
<Accuracies on train> cls : 89.80
Train epoch time: 26.685
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 71.40
------------------------------
<Accuracies on photo> test class : 83.65
------------------------------
<Accuracies on cartoon> test class : 74.87
------------------------------
<Accuracies on art_painting> test class : 57.42
------------------------------
Total epoch time: 42.898

New epoch - lr: 0.003
[1/55 iteration of epoch 26/30] 
 {loss} cls : 0.292, total : 0.292 
 {acc} cls : 86.72
[31/55 iteration of epoch 26/30] 
 {loss} cls : 0.214, total : 0.214 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.248, total : 0.248
<Accuracies on train> cls : 90.09
Train epoch time: 23.513
------------------------------
<Accuracies on val> class : 92.46
------------------------------
<Accuracies on test> class : 75.19
------------------------------
<Accuracies on photo> test class : 86.83
------------------------------
<Accuracies on cartoon> test class : 77.01
------------------------------
<Accuracies on art_painting> test class : 63.62
------------------------------
Total epoch time: 37.778

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 27/30] 
 {loss} cls : 0.184, total : 0.184 
 {acc} cls : 90.62
[31/55 iteration of epoch 27/30] 
 {loss} cls : 0.300, total : 0.300 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.244, total : 0.244
<Accuracies on train> cls : 90.17
Train epoch time: 20.594
------------------------------
<Accuracies on val> class : 92.21
------------------------------
<Accuracies on test> class : 74.65
------------------------------
<Accuracies on photo> test class : 86.41
------------------------------
<Accuracies on cartoon> test class : 76.54
------------------------------
<Accuracies on art_painting> test class : 62.89
------------------------------
Total epoch time: 34.746

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 28/30] 
 {loss} cls : 0.283, total : 0.283 
 {acc} cls : 85.94
[31/55 iteration of epoch 28/30] 
 {loss} cls : 0.282, total : 0.282 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.241, total : 0.241
<Accuracies on train> cls : 90.23
Train epoch time: 20.091
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 73.57
------------------------------
<Accuracies on photo> test class : 84.91
------------------------------
<Accuracies on cartoon> test class : 76.28
------------------------------
<Accuracies on art_painting> test class : 61.23
------------------------------
Total epoch time: 33.985

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 29/30] 
 {loss} cls : 0.257, total : 0.257 
 {acc} cls : 89.06
[31/55 iteration of epoch 29/30] 
 {loss} cls : 0.238, total : 0.238 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.241, total : 0.241
<Accuracies on train> cls : 90.30
Train epoch time: 20.338
------------------------------
<Accuracies on val> class : 91.96
------------------------------
<Accuracies on test> class : 74.30
------------------------------
<Accuracies on photo> test class : 85.63
------------------------------
<Accuracies on cartoon> test class : 77.22
------------------------------
<Accuracies on art_painting> test class : 61.72
------------------------------
Total epoch time: 34.541

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 30/30] 
 {loss} cls : 0.217, total : 0.217 
 {acc} cls : 91.41
[31/55 iteration of epoch 30/30] 
 {loss} cls : 0.289, total : 0.289 
 {acc} cls : 86.72
------------------------------
<Losses on train> cls : 0.240, total : 0.240
<Accuracies on train> cls : 90.44
Train epoch time: 19.758
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 74.81
------------------------------
<Accuracies on photo> test class : 85.99
------------------------------
<Accuracies on cartoon> test class : 77.09
------------------------------
<Accuracies on art_painting> test class : 63.09
------------------------------
Total epoch time: 33.805

******************************
Best val 0.947236, corresponding test 0.731607 - best test: 0.765424

******************************
Best val 0.947236180305481, corresponding photo test 0.8550898432731628

******************************
Best val 0.947236180305481, corresponding cartoon test 0.7696245908737183

******************************
Best val 0.947236180305481, corresponding art_painting test 0.58740234375
