WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/32 iteration of epoch 1/30] 
 {loss} cls : 1.936, total : 1.936 
 {acc} cls : 23.44
[31/32 iteration of epoch 1/30] 
 {loss} cls : 0.571, total : 0.571 
 {acc} cls : 86.72
------------------------------
<Losses on train> cls : 1.736, total : 1.736
<Accuracies on train> cls : 65.16
Train epoch time: 33.700
------------------------------
<Accuracies on val> class : 85.23
------------------------------
<Accuracies on test> class : 73.34
------------------------------
<Accuracies on photo> test class : 85.69
------------------------------
<Accuracies on art_painting> test class : 74.32
------------------------------
<Accuracies on sketch> test class : 67.57
------------------------------
Total epoch time: 64.428

New epoch - lr: 0.003
[1/32 iteration of epoch 2/30] 
 {loss} cls : 0.449, total : 0.449 
 {acc} cls : 84.38
[31/32 iteration of epoch 2/30] 
 {loss} cls : 0.585, total : 0.585 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.367, total : 0.367
<Accuracies on train> cls : 88.62
Train epoch time: 30.250
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 69.99
------------------------------
<Accuracies on photo> test class : 84.31
------------------------------
<Accuracies on art_painting> test class : 62.65
------------------------------
<Accuracies on sketch> test class : 67.73
------------------------------
Total epoch time: 56.977

New epoch - lr: 0.003
[1/32 iteration of epoch 3/30] 
 {loss} cls : 0.184, total : 0.184 
 {acc} cls : 96.09
[31/32 iteration of epoch 3/30] 
 {loss} cls : 0.172, total : 0.172 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.247, total : 0.247
<Accuracies on train> cls : 91.28
Train epoch time: 27.575
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 71.78
------------------------------
<Accuracies on photo> test class : 85.45
------------------------------
<Accuracies on art_painting> test class : 67.53
------------------------------
<Accuracies on sketch> test class : 68.19
------------------------------
Total epoch time: 54.852

New epoch - lr: 0.003
[1/32 iteration of epoch 4/30] 
 {loss} cls : 0.109, total : 0.109 
 {acc} cls : 95.31
[31/32 iteration of epoch 4/30] 
 {loss} cls : 0.144, total : 0.144 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.198, total : 0.198
<Accuracies on train> cls : 93.14
Train epoch time: 25.393
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 69.86
------------------------------
<Accuracies on photo> test class : 82.04
------------------------------
<Accuracies on art_painting> test class : 69.53
------------------------------
<Accuracies on sketch> test class : 64.85
------------------------------
Total epoch time: 52.126

New epoch - lr: 0.003
[1/32 iteration of epoch 5/30] 
 {loss} cls : 0.145, total : 0.145 
 {acc} cls : 96.09
[31/32 iteration of epoch 5/30] 
 {loss} cls : 0.165, total : 0.165 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.147, total : 0.147
<Accuracies on train> cls : 94.95
Train epoch time: 25.219
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 73.72
------------------------------
<Accuracies on photo> test class : 87.66
------------------------------
<Accuracies on art_painting> test class : 69.24
------------------------------
<Accuracies on sketch> test class : 70.12
------------------------------
Total epoch time: 52.535

New epoch - lr: 0.003
[1/32 iteration of epoch 6/30] 
 {loss} cls : 0.119, total : 0.119 
 {acc} cls : 96.88
[31/32 iteration of epoch 6/30] 
 {loss} cls : 0.087, total : 0.087 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.136, total : 0.136
<Accuracies on train> cls : 95.14
Train epoch time: 26.016
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 76.28
------------------------------
<Accuracies on photo> test class : 84.19
------------------------------
<Accuracies on art_painting> test class : 75.29
------------------------------
<Accuracies on sketch> test class : 73.43
------------------------------
Total epoch time: 53.721

New epoch - lr: 0.003
[1/32 iteration of epoch 7/30] 
 {loss} cls : 0.135, total : 0.135 
 {acc} cls : 94.53
[31/32 iteration of epoch 7/30] 
 {loss} cls : 0.224, total : 0.224 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.135, total : 0.135
<Accuracies on train> cls : 95.41
Train epoch time: 25.211
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 77.83
------------------------------
<Accuracies on photo> test class : 88.98
------------------------------
<Accuracies on art_painting> test class : 71.88
------------------------------
<Accuracies on sketch> test class : 76.20
------------------------------
Total epoch time: 52.709

New epoch - lr: 0.003
[1/32 iteration of epoch 8/30] 
 {loss} cls : 0.187, total : 0.187 
 {acc} cls : 96.09
[31/32 iteration of epoch 8/30] 
 {loss} cls : 0.139, total : 0.139 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.114, total : 0.114
<Accuracies on train> cls : 96.34
Train epoch time: 24.725
------------------------------
<Accuracies on val> class : 92.83
------------------------------
<Accuracies on test> class : 73.31
------------------------------
<Accuracies on photo> test class : 72.57
------------------------------
<Accuracies on art_painting> test class : 67.87
------------------------------
<Accuracies on sketch> test class : 76.46
------------------------------
Total epoch time: 52.359

New epoch - lr: 0.003
[1/32 iteration of epoch 9/30] 
 {loss} cls : 0.056, total : 0.056 
 {acc} cls : 98.44
[31/32 iteration of epoch 9/30] 
 {loss} cls : 0.113, total : 0.113 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.102, total : 0.102
<Accuracies on train> cls : 96.68
Train epoch time: 24.010
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 74.29
------------------------------
<Accuracies on photo> test class : 85.99
------------------------------
<Accuracies on art_painting> test class : 70.61
------------------------------
<Accuracies on sketch> test class : 71.24
------------------------------
Total epoch time: 51.944

New epoch - lr: 0.003
[1/32 iteration of epoch 10/30] 
 {loss} cls : 0.058, total : 0.058 
 {acc} cls : 98.44
[31/32 iteration of epoch 10/30] 
 {loss} cls : 0.142, total : 0.142 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.098, total : 0.098
<Accuracies on train> cls : 96.66
Train epoch time: 23.471
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 71.83
------------------------------
<Accuracies on photo> test class : 81.68
------------------------------
<Accuracies on art_painting> test class : 68.65
------------------------------
<Accuracies on sketch> test class : 69.31
------------------------------
Total epoch time: 52.220

New epoch - lr: 0.003
[1/32 iteration of epoch 11/30] 
 {loss} cls : 0.042, total : 0.042 
 {acc} cls : 98.44
[31/32 iteration of epoch 11/30] 
 {loss} cls : 0.105, total : 0.105 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.090, total : 0.090
<Accuracies on train> cls : 96.90
Train epoch time: 22.727
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 72.05
------------------------------
<Accuracies on photo> test class : 77.60
------------------------------
<Accuracies on art_painting> test class : 68.21
------------------------------
<Accuracies on sketch> test class : 71.70
------------------------------
Total epoch time: 51.219

New epoch - lr: 0.003
[1/32 iteration of epoch 12/30] 
 {loss} cls : 0.056, total : 0.056 
 {acc} cls : 97.66
[31/32 iteration of epoch 12/30] 
 {loss} cls : 0.077, total : 0.077 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.079, total : 0.079
<Accuracies on train> cls : 97.09
Train epoch time: 23.550
------------------------------
<Accuracies on val> class : 92.83
------------------------------
<Accuracies on test> class : 73.57
------------------------------
<Accuracies on photo> test class : 86.35
------------------------------
<Accuracies on art_painting> test class : 68.60
------------------------------
<Accuracies on sketch> test class : 70.73
------------------------------
Total epoch time: 51.435

New epoch - lr: 0.003
[1/32 iteration of epoch 13/30] 
 {loss} cls : 0.035, total : 0.035 
 {acc} cls : 98.44
[31/32 iteration of epoch 13/30] 
 {loss} cls : 0.059, total : 0.059 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.070, total : 0.070
<Accuracies on train> cls : 97.31
Train epoch time: 23.937
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 74.89
------------------------------
<Accuracies on photo> test class : 83.11
------------------------------
<Accuracies on art_painting> test class : 72.02
------------------------------
<Accuracies on sketch> test class : 72.89
------------------------------
Total epoch time: 51.542

New epoch - lr: 0.003
[1/32 iteration of epoch 14/30] 
 {loss} cls : 0.097, total : 0.097 
 {acc} cls : 96.09
[31/32 iteration of epoch 14/30] 
 {loss} cls : 0.043, total : 0.043 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.068, total : 0.068
<Accuracies on train> cls : 97.31
Train epoch time: 24.615
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 77.56
------------------------------
<Accuracies on photo> test class : 89.34
------------------------------
<Accuracies on art_painting> test class : 75.49
------------------------------
<Accuracies on sketch> test class : 73.63
------------------------------
Total epoch time: 52.568

New epoch - lr: 0.003
[1/32 iteration of epoch 15/30] 
 {loss} cls : 0.064, total : 0.064 
 {acc} cls : 97.66
[31/32 iteration of epoch 15/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.068, total : 0.068
<Accuracies on train> cls : 97.58
Train epoch time: 24.535
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 74.04
------------------------------
<Accuracies on photo> test class : 82.04
------------------------------
<Accuracies on art_painting> test class : 72.61
------------------------------
<Accuracies on sketch> test class : 71.39
------------------------------
Total epoch time: 51.505

New epoch - lr: 0.003
[1/32 iteration of epoch 16/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 99.22
[31/32 iteration of epoch 16/30] 
 {loss} cls : 0.065, total : 0.065 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.051, total : 0.051
<Accuracies on train> cls : 98.44
Train epoch time: 24.761
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 75.78
------------------------------
<Accuracies on photo> test class : 79.58
------------------------------
<Accuracies on art_painting> test class : 73.19
------------------------------
<Accuracies on sketch> test class : 75.52
------------------------------
Total epoch time: 52.264

New epoch - lr: 0.003
[1/32 iteration of epoch 17/30] 
 {loss} cls : 0.046, total : 0.046 
 {acc} cls : 98.44
[31/32 iteration of epoch 17/30] 
 {loss} cls : 0.273, total : 0.273 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.067, total : 0.067
<Accuracies on train> cls : 97.75
Train epoch time: 24.474
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 73.74
------------------------------
<Accuracies on photo> test class : 82.69
------------------------------
<Accuracies on art_painting> test class : 66.02
------------------------------
<Accuracies on sketch> test class : 73.96
------------------------------
Total epoch time: 51.228

New epoch - lr: 0.003
[1/32 iteration of epoch 18/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 98.44
[31/32 iteration of epoch 18/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.07
Train epoch time: 24.477
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 74.46
------------------------------
<Accuracies on photo> test class : 84.49
------------------------------
<Accuracies on art_painting> test class : 68.16
------------------------------
<Accuracies on sketch> test class : 73.48
------------------------------
Total epoch time: 52.476

New epoch - lr: 0.003
[1/32 iteration of epoch 19/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 100.00
[31/32 iteration of epoch 19/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.046, total : 0.046
<Accuracies on train> cls : 98.49
Train epoch time: 22.692
------------------------------
<Accuracies on val> class : 95.36
------------------------------
<Accuracies on test> class : 72.12
------------------------------
<Accuracies on photo> test class : 77.37
------------------------------
<Accuracies on art_painting> test class : 67.09
------------------------------
<Accuracies on sketch> test class : 72.51
------------------------------
Total epoch time: 50.028

New epoch - lr: 0.003
[1/32 iteration of epoch 20/30] 
 {loss} cls : 0.055, total : 0.055 
 {acc} cls : 98.44
[31/32 iteration of epoch 20/30] 
 {loss} cls : 0.079, total : 0.079 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.049, total : 0.049
<Accuracies on train> cls : 98.32
Train epoch time: 24.101
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 74.29
------------------------------
<Accuracies on photo> test class : 84.85
------------------------------
<Accuracies on art_painting> test class : 70.51
------------------------------
<Accuracies on sketch> test class : 71.77
------------------------------
Total epoch time: 50.649

New epoch - lr: 0.003
[1/32 iteration of epoch 21/30] 
 {loss} cls : 0.056, total : 0.056 
 {acc} cls : 96.09
[31/32 iteration of epoch 21/30] 
 {loss} cls : 0.041, total : 0.041 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.048, total : 0.048
<Accuracies on train> cls : 98.22
Train epoch time: 24.272
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 74.88
------------------------------
<Accuracies on photo> test class : 80.12
------------------------------
<Accuracies on art_painting> test class : 71.68
------------------------------
<Accuracies on sketch> test class : 74.32
------------------------------
Total epoch time: 50.684

New epoch - lr: 0.003
[1/32 iteration of epoch 22/30] 
 {loss} cls : 0.098, total : 0.098 
 {acc} cls : 96.09
[31/32 iteration of epoch 22/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.041, total : 0.041
<Accuracies on train> cls : 98.41
Train epoch time: 24.645
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 73.68
------------------------------
<Accuracies on photo> test class : 75.15
------------------------------
<Accuracies on art_painting> test class : 69.68
------------------------------
<Accuracies on sketch> test class : 75.13
------------------------------
Total epoch time: 52.204

New epoch - lr: 0.003
[1/32 iteration of epoch 23/30] 
 {loss} cls : 0.066, total : 0.066 
 {acc} cls : 98.44
[31/32 iteration of epoch 23/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.044, total : 0.044
<Accuracies on train> cls : 98.66
Train epoch time: 25.099
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 72.55
------------------------------
<Accuracies on photo> test class : 78.62
------------------------------
<Accuracies on art_painting> test class : 68.12
------------------------------
<Accuracies on sketch> test class : 72.28
------------------------------
Total epoch time: 51.462

New epoch - lr: 0.003
[1/32 iteration of epoch 24/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 100.00
[31/32 iteration of epoch 24/30] 
 {loss} cls : 0.022, total : 0.022 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.19
Train epoch time: 24.186
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 75.00
------------------------------
<Accuracies on photo> test class : 77.54
------------------------------
<Accuracies on art_painting> test class : 71.14
------------------------------
<Accuracies on sketch> test class : 75.92
------------------------------
Total epoch time: 51.802

New epoch - lr: 0.003
[1/32 iteration of epoch 25/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 99.22
[31/32 iteration of epoch 25/30] 
 {loss} cls : 0.029, total : 0.029 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 98.90
Train epoch time: 23.959
------------------------------
<Accuracies on val> class : 95.36
------------------------------
<Accuracies on test> class : 74.57
------------------------------
<Accuracies on photo> test class : 75.03
------------------------------
<Accuracies on art_painting> test class : 69.82
------------------------------
<Accuracies on sketch> test class : 76.84
------------------------------
Total epoch time: 52.459

New epoch - lr: 0.003
[1/32 iteration of epoch 26/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 99.22
[31/32 iteration of epoch 26/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.32
Train epoch time: 23.190
------------------------------
<Accuracies on val> class : 95.78
------------------------------
<Accuracies on test> class : 74.97
------------------------------
<Accuracies on photo> test class : 79.10
------------------------------
<Accuracies on art_painting> test class : 69.38
------------------------------
<Accuracies on sketch> test class : 76.13
------------------------------
Total epoch time: 51.266

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 27/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 99.22
[31/32 iteration of epoch 27/30] 
 {loss} cls : 0.049, total : 0.049 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 99.19
Train epoch time: 22.908
------------------------------
<Accuracies on val> class : 96.20
------------------------------
<Accuracies on test> class : 76.03
------------------------------
<Accuracies on photo> test class : 78.02
------------------------------
<Accuracies on art_painting> test class : 70.65
------------------------------
<Accuracies on sketch> test class : 77.98
------------------------------
Total epoch time: 52.282

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 28/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 99.22
[31/32 iteration of epoch 28/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.026, total : 0.026
<Accuracies on train> cls : 99.07
Train epoch time: 23.043
------------------------------
<Accuracies on val> class : 95.78
------------------------------
<Accuracies on test> class : 74.02
------------------------------
<Accuracies on photo> test class : 74.97
------------------------------
<Accuracies on art_painting> test class : 69.92
------------------------------
<Accuracies on sketch> test class : 75.74
------------------------------
Total epoch time: 52.079

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 29/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 99.22
[31/32 iteration of epoch 29/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.29
Train epoch time: 22.941
------------------------------
<Accuracies on val> class : 95.78
------------------------------
<Accuracies on test> class : 75.79
------------------------------
<Accuracies on photo> test class : 78.14
------------------------------
<Accuracies on art_painting> test class : 71.44
------------------------------
<Accuracies on sketch> test class : 77.07
------------------------------
Total epoch time: 48.912

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 30/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
[31/32 iteration of epoch 30/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.32
Train epoch time: 22.831
------------------------------
<Accuracies on val> class : 95.78
------------------------------
<Accuracies on test> class : 74.76
------------------------------
<Accuracies on photo> test class : 73.59
------------------------------
<Accuracies on art_painting> test class : 70.56
------------------------------
<Accuracies on sketch> test class : 77.45
------------------------------
Total epoch time: 47.889

******************************
Best val 0.962025, corresponding test 0.760298 - best test: 0.778344

******************************
Best val 0.9620253443717957, corresponding photo test 0.7802395224571228

******************************
Best val 0.9620253443717957, corresponding art_painting test 0.70654296875

******************************
Best val 0.9620253443717957, corresponding sketch test 0.77984219789505
