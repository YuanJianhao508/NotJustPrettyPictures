WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/55 iteration of epoch 1/30] 
 {loss} cls : 2.008, total : 2.008 
 {acc} cls : 23.44
[31/55 iteration of epoch 1/30] 
 {loss} cls : 0.513, total : 0.513 
 {acc} cls : 82.81
------------------------------
<Losses on train> cls : 1.102, total : 1.102
<Accuracies on train> cls : 67.50
Train epoch time: 47.849
------------------------------
<Accuracies on val> class : 86.18
------------------------------
<Accuracies on test> class : 51.91
------------------------------
<Accuracies on photo> test class : 45.33
------------------------------
<Accuracies on cartoon> test class : 63.95
------------------------------
<Accuracies on art_painting> test class : 43.51
------------------------------
Total epoch time: 71.778

New epoch - lr: 0.003
[1/55 iteration of epoch 2/30] 
 {loss} cls : 0.469, total : 0.469 
 {acc} cls : 80.47
[31/55 iteration of epoch 2/30] 
 {loss} cls : 0.309, total : 0.309 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.418, total : 0.418
<Accuracies on train> cls : 84.35
Train epoch time: 43.076
------------------------------
<Accuracies on val> class : 89.20
------------------------------
<Accuracies on test> class : 54.07
------------------------------
<Accuracies on photo> test class : 50.54
------------------------------
<Accuracies on cartoon> test class : 66.42
------------------------------
<Accuracies on art_painting> test class : 42.82
------------------------------
Total epoch time: 66.561

New epoch - lr: 0.003
[1/55 iteration of epoch 3/30] 
 {loss} cls : 0.314, total : 0.314 
 {acc} cls : 89.06
[31/55 iteration of epoch 3/30] 
 {loss} cls : 0.465, total : 0.465 
 {acc} cls : 80.47
------------------------------
<Losses on train> cls : 0.364, total : 0.364
<Accuracies on train> cls : 86.01
Train epoch time: 39.351
------------------------------
<Accuracies on val> class : 91.21
------------------------------
<Accuracies on test> class : 59.47
------------------------------
<Accuracies on photo> test class : 56.95
------------------------------
<Accuracies on cartoon> test class : 70.86
------------------------------
<Accuracies on art_painting> test class : 48.49
------------------------------
Total epoch time: 63.926

New epoch - lr: 0.003
[1/55 iteration of epoch 4/30] 
 {loss} cls : 0.313, total : 0.313 
 {acc} cls : 87.50
[31/55 iteration of epoch 4/30] 
 {loss} cls : 0.259, total : 0.259 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.340, total : 0.340
<Accuracies on train> cls : 87.07
Train epoch time: 38.521
------------------------------
<Accuracies on val> class : 92.46
------------------------------
<Accuracies on test> class : 58.18
------------------------------
<Accuracies on photo> test class : 53.89
------------------------------
<Accuracies on cartoon> test class : 69.84
------------------------------
<Accuracies on art_painting> test class : 48.34
------------------------------
Total epoch time: 62.888

New epoch - lr: 0.003
[1/55 iteration of epoch 5/30] 
 {loss} cls : 0.265, total : 0.265 
 {acc} cls : 92.19
[31/55 iteration of epoch 5/30] 
 {loss} cls : 0.282, total : 0.282 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.295, total : 0.295
<Accuracies on train> cls : 88.79
Train epoch time: 37.481
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 61.18
------------------------------
<Accuracies on photo> test class : 57.49
------------------------------
<Accuracies on cartoon> test class : 69.45
------------------------------
<Accuracies on art_painting> test class : 54.74
------------------------------
Total epoch time: 59.838

New epoch - lr: 0.003
[1/55 iteration of epoch 6/30] 
 {loss} cls : 0.313, total : 0.313 
 {acc} cls : 88.28
[31/55 iteration of epoch 6/30] 
 {loss} cls : 0.380, total : 0.380 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.289, total : 0.289
<Accuracies on train> cls : 88.89
Train epoch time: 37.501
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 59.85
------------------------------
<Accuracies on photo> test class : 57.90
------------------------------
<Accuracies on cartoon> test class : 68.00
------------------------------
<Accuracies on art_painting> test class : 52.10
------------------------------
Total epoch time: 59.907

New epoch - lr: 0.003
[1/55 iteration of epoch 7/30] 
 {loss} cls : 0.310, total : 0.310 
 {acc} cls : 88.28
[31/55 iteration of epoch 7/30] 
 {loss} cls : 0.241, total : 0.241 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.277, total : 0.277
<Accuracies on train> cls : 89.16
Train epoch time: 38.122
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 58.66
------------------------------
<Accuracies on photo> test class : 55.93
------------------------------
<Accuracies on cartoon> test class : 67.92
------------------------------
<Accuracies on art_painting> test class : 50.29
------------------------------
Total epoch time: 61.052

New epoch - lr: 0.003
[1/55 iteration of epoch 8/30] 
 {loss} cls : 0.179, total : 0.179 
 {acc} cls : 92.97
[31/55 iteration of epoch 8/30] 
 {loss} cls : 0.306, total : 0.306 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.276, total : 0.276
<Accuracies on train> cls : 89.38
Train epoch time: 36.410
------------------------------
<Accuracies on val> class : 95.98
------------------------------
<Accuracies on test> class : 59.80
------------------------------
<Accuracies on photo> test class : 57.01
------------------------------
<Accuracies on cartoon> test class : 70.39
------------------------------
<Accuracies on art_painting> test class : 49.95
------------------------------
Total epoch time: 61.157

New epoch - lr: 0.003
[1/55 iteration of epoch 9/30] 
 {loss} cls : 0.317, total : 0.317 
 {acc} cls : 88.28
[31/55 iteration of epoch 9/30] 
 {loss} cls : 0.218, total : 0.218 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.247, total : 0.247
<Accuracies on train> cls : 90.23
Train epoch time: 35.855
------------------------------
<Accuracies on val> class : 95.23
------------------------------
<Accuracies on test> class : 60.94
------------------------------
<Accuracies on photo> test class : 57.60
------------------------------
<Accuracies on cartoon> test class : 72.61
------------------------------
<Accuracies on art_painting> test class : 50.29
------------------------------
Total epoch time: 59.958

New epoch - lr: 0.003
[1/55 iteration of epoch 10/30] 
 {loss} cls : 0.345, total : 0.345 
 {acc} cls : 85.16
[31/55 iteration of epoch 10/30] 
 {loss} cls : 0.353, total : 0.353 
 {acc} cls : 85.16
------------------------------
<Losses on train> cls : 0.264, total : 0.264
<Accuracies on train> cls : 89.38
Train epoch time: 34.983
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 59.35
------------------------------
<Accuracies on photo> test class : 57.37
------------------------------
<Accuracies on cartoon> test class : 70.22
------------------------------
<Accuracies on art_painting> test class : 48.54
------------------------------
Total epoch time: 58.222

New epoch - lr: 0.003
[1/55 iteration of epoch 11/30] 
 {loss} cls : 0.222, total : 0.222 
 {acc} cls : 93.75
[31/55 iteration of epoch 11/30] 
 {loss} cls : 0.202, total : 0.202 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.241, total : 0.241
<Accuracies on train> cls : 90.60
Train epoch time: 36.170
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 59.88
------------------------------
<Accuracies on photo> test class : 58.44
------------------------------
<Accuracies on cartoon> test class : 69.11
------------------------------
<Accuracies on art_painting> test class : 50.49
------------------------------
Total epoch time: 58.824

New epoch - lr: 0.003
[1/55 iteration of epoch 12/30] 
 {loss} cls : 0.322, total : 0.322 
 {acc} cls : 85.16
[31/55 iteration of epoch 12/30] 
 {loss} cls : 0.181, total : 0.181 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.230, total : 0.230
<Accuracies on train> cls : 90.99
Train epoch time: 35.622
------------------------------
<Accuracies on val> class : 95.23
------------------------------
<Accuracies on test> class : 57.27
------------------------------
<Accuracies on photo> test class : 54.61
------------------------------
<Accuracies on cartoon> test class : 68.98
------------------------------
<Accuracies on art_painting> test class : 46.04
------------------------------
Total epoch time: 58.169

New epoch - lr: 0.003
[1/55 iteration of epoch 13/30] 
 {loss} cls : 0.147, total : 0.147 
 {acc} cls : 94.53
[31/55 iteration of epoch 13/30] 
 {loss} cls : 0.318, total : 0.318 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.225, total : 0.225
<Accuracies on train> cls : 91.04
Train epoch time: 35.581
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 60.61
------------------------------
<Accuracies on photo> test class : 57.13
------------------------------
<Accuracies on cartoon> test class : 71.72
------------------------------
<Accuracies on art_painting> test class : 50.73
------------------------------
Total epoch time: 57.597

New epoch - lr: 0.003
[1/55 iteration of epoch 14/30] 
 {loss} cls : 0.227, total : 0.227 
 {acc} cls : 91.41
[31/55 iteration of epoch 14/30] 
 {loss} cls : 0.290, total : 0.290 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.225, total : 0.225
<Accuracies on train> cls : 91.11
Train epoch time: 35.918
------------------------------
<Accuracies on val> class : 94.22
------------------------------
<Accuracies on test> class : 59.17
------------------------------
<Accuracies on photo> test class : 55.21
------------------------------
<Accuracies on cartoon> test class : 70.52
------------------------------
<Accuracies on art_painting> test class : 49.41
------------------------------
Total epoch time: 57.768

New epoch - lr: 0.003
[1/55 iteration of epoch 15/30] 
 {loss} cls : 0.322, total : 0.322 
 {acc} cls : 87.50
[31/55 iteration of epoch 15/30] 
 {loss} cls : 0.193, total : 0.193 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.234, total : 0.234
<Accuracies on train> cls : 90.77
Train epoch time: 36.481
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 62.97
------------------------------
<Accuracies on photo> test class : 62.34
------------------------------
<Accuracies on cartoon> test class : 73.55
------------------------------
<Accuracies on art_painting> test class : 51.37
------------------------------
Total epoch time: 59.313

New epoch - lr: 0.003
[1/55 iteration of epoch 16/30] 
 {loss} cls : 0.272, total : 0.272 
 {acc} cls : 89.06
[31/55 iteration of epoch 16/30] 
 {loss} cls : 0.173, total : 0.173 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.224, total : 0.224
<Accuracies on train> cls : 91.08
Train epoch time: 35.564
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 59.39
------------------------------
<Accuracies on photo> test class : 57.96
------------------------------
<Accuracies on cartoon> test class : 69.62
------------------------------
<Accuracies on art_painting> test class : 48.83
------------------------------
Total epoch time: 60.212

New epoch - lr: 0.003
[1/55 iteration of epoch 17/30] 
 {loss} cls : 0.208, total : 0.208 
 {acc} cls : 91.41
[31/55 iteration of epoch 17/30] 
 {loss} cls : 0.246, total : 0.246 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.213, total : 0.213
<Accuracies on train> cls : 91.49
Train epoch time: 35.029
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 58.41
------------------------------
<Accuracies on photo> test class : 57.66
------------------------------
<Accuracies on cartoon> test class : 69.24
------------------------------
<Accuracies on art_painting> test class : 46.63
------------------------------
Total epoch time: 59.130

New epoch - lr: 0.003
[1/55 iteration of epoch 18/30] 
 {loss} cls : 0.223, total : 0.223 
 {acc} cls : 92.19
[31/55 iteration of epoch 18/30] 
 {loss} cls : 0.200, total : 0.200 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.216, total : 0.216
<Accuracies on train> cls : 91.26
Train epoch time: 35.264
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 60.11
------------------------------
<Accuracies on photo> test class : 59.16
------------------------------
<Accuracies on cartoon> test class : 68.69
------------------------------
<Accuracies on art_painting> test class : 51.07
------------------------------
Total epoch time: 58.228

New epoch - lr: 0.003
[1/55 iteration of epoch 19/30] 
 {loss} cls : 0.147, total : 0.147 
 {acc} cls : 93.75
[31/55 iteration of epoch 19/30] 
 {loss} cls : 0.268, total : 0.268 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.219, total : 0.219
<Accuracies on train> cls : 91.28
Train epoch time: 36.491
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 56.37
------------------------------
<Accuracies on photo> test class : 52.93
------------------------------
<Accuracies on cartoon> test class : 69.92
------------------------------
<Accuracies on art_painting> test class : 43.65
------------------------------
Total epoch time: 58.517

New epoch - lr: 0.003
[1/55 iteration of epoch 20/30] 
 {loss} cls : 0.198, total : 0.198 
 {acc} cls : 91.41
[31/55 iteration of epoch 20/30] 
 {loss} cls : 0.244, total : 0.244 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.219, total : 0.219
<Accuracies on train> cls : 90.87
Train epoch time: 35.927
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 60.74
------------------------------
<Accuracies on photo> test class : 57.84
------------------------------
<Accuracies on cartoon> test class : 71.37
------------------------------
<Accuracies on art_painting> test class : 50.93
------------------------------
Total epoch time: 59.008

New epoch - lr: 0.003
[1/55 iteration of epoch 21/30] 
 {loss} cls : 0.163, total : 0.163 
 {acc} cls : 93.75
[31/55 iteration of epoch 21/30] 
 {loss} cls : 0.204, total : 0.204 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.208, total : 0.208
<Accuracies on train> cls : 91.61
Train epoch time: 35.981
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 56.68
------------------------------
<Accuracies on photo> test class : 53.71
------------------------------
<Accuracies on cartoon> test class : 69.16
------------------------------
<Accuracies on art_painting> test class : 44.82
------------------------------
Total epoch time: 59.125

New epoch - lr: 0.003
[1/55 iteration of epoch 22/30] 
 {loss} cls : 0.184, total : 0.184 
 {acc} cls : 92.19
[31/55 iteration of epoch 22/30] 
 {loss} cls : 0.324, total : 0.324 
 {acc} cls : 83.59
------------------------------
<Losses on train> cls : 0.204, total : 0.204
<Accuracies on train> cls : 91.86
Train epoch time: 35.337
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 57.11
------------------------------
<Accuracies on photo> test class : 53.11
------------------------------
<Accuracies on cartoon> test class : 70.09
------------------------------
<Accuracies on art_painting> test class : 45.51
------------------------------
Total epoch time: 58.726

New epoch - lr: 0.003
[1/55 iteration of epoch 23/30] 
 {loss} cls : 0.266, total : 0.266 
 {acc} cls : 89.06
[31/55 iteration of epoch 23/30] 
 {loss} cls : 0.172, total : 0.172 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.204, total : 0.204
<Accuracies on train> cls : 91.66
Train epoch time: 34.929
------------------------------
<Accuracies on val> class : 95.73
------------------------------
<Accuracies on test> class : 56.17
------------------------------
<Accuracies on photo> test class : 54.25
------------------------------
<Accuracies on cartoon> test class : 69.92
------------------------------
<Accuracies on art_painting> test class : 41.99
------------------------------
Total epoch time: 58.686

New epoch - lr: 0.003
[1/55 iteration of epoch 24/30] 
 {loss} cls : 0.147, total : 0.147 
 {acc} cls : 94.53
[31/55 iteration of epoch 24/30] 
 {loss} cls : 0.126, total : 0.126 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.198, total : 0.198
<Accuracies on train> cls : 92.19
Train epoch time: 35.486
------------------------------
<Accuracies on val> class : 95.23
------------------------------
<Accuracies on test> class : 58.69
------------------------------
<Accuracies on photo> test class : 55.63
------------------------------
<Accuracies on cartoon> test class : 71.59
------------------------------
<Accuracies on art_painting> test class : 46.44
------------------------------
Total epoch time: 58.235

New epoch - lr: 0.003
[1/55 iteration of epoch 25/30] 
 {loss} cls : 0.129, total : 0.129 
 {acc} cls : 95.31
[31/55 iteration of epoch 25/30] 
 {loss} cls : 0.152, total : 0.152 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.200, total : 0.200
<Accuracies on train> cls : 91.95
Train epoch time: 35.625
------------------------------
<Accuracies on val> class : 94.22
------------------------------
<Accuracies on test> class : 54.72
------------------------------
<Accuracies on photo> test class : 51.20
------------------------------
<Accuracies on cartoon> test class : 68.98
------------------------------
<Accuracies on art_painting> test class : 41.26
------------------------------
Total epoch time: 58.485

New epoch - lr: 0.003
[1/55 iteration of epoch 26/30] 
 {loss} cls : 0.193, total : 0.193 
 {acc} cls : 91.41
[31/55 iteration of epoch 26/30] 
 {loss} cls : 0.145, total : 0.145 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.197, total : 0.197
<Accuracies on train> cls : 92.14
Train epoch time: 34.553
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 57.51
------------------------------
<Accuracies on photo> test class : 53.29
------------------------------
<Accuracies on cartoon> test class : 72.31
------------------------------
<Accuracies on art_painting> test class : 43.99
------------------------------
Total epoch time: 57.034

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 27/30] 
 {loss} cls : 0.153, total : 0.153 
 {acc} cls : 95.31
[31/55 iteration of epoch 27/30] 
 {loss} cls : 0.282, total : 0.282 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.192, total : 0.192
<Accuracies on train> cls : 92.39
Train epoch time: 30.133
------------------------------
<Accuracies on val> class : 95.48
------------------------------
<Accuracies on test> class : 57.90
------------------------------
<Accuracies on photo> test class : 52.87
------------------------------
<Accuracies on cartoon> test class : 72.53
------------------------------
<Accuracies on art_painting> test class : 45.26
------------------------------
Total epoch time: 49.998

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 28/30] 
 {loss} cls : 0.152, total : 0.152 
 {acc} cls : 94.53
[31/55 iteration of epoch 28/30] 
 {loss} cls : 0.222, total : 0.222 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.191, total : 0.191
<Accuracies on train> cls : 92.23
Train epoch time: 28.746
------------------------------
<Accuracies on val> class : 95.23
------------------------------
<Accuracies on test> class : 57.27
------------------------------
<Accuracies on photo> test class : 52.46
------------------------------
<Accuracies on cartoon> test class : 72.57
------------------------------
<Accuracies on art_painting> test class : 43.70
------------------------------
Total epoch time: 50.086

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 29/30] 
 {loss} cls : 0.179, total : 0.179 
 {acc} cls : 91.41
[31/55 iteration of epoch 29/30] 
 {loss} cls : 0.240, total : 0.240 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.195, total : 0.195
<Accuracies on train> cls : 92.13
Train epoch time: 28.918
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 57.31
------------------------------
<Accuracies on photo> test class : 53.05
------------------------------
<Accuracies on cartoon> test class : 71.54
------------------------------
<Accuracies on art_painting> test class : 44.48
------------------------------
Total epoch time: 49.364

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 30/30] 
 {loss} cls : 0.179, total : 0.179 
 {acc} cls : 92.19
[31/55 iteration of epoch 30/30] 
 {loss} cls : 0.236, total : 0.236 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.192, total : 0.192
<Accuracies on train> cls : 92.13
Train epoch time: 29.400
------------------------------
<Accuracies on val> class : 94.97
------------------------------
<Accuracies on test> class : 58.79
------------------------------
<Accuracies on photo> test class : 55.03
------------------------------
<Accuracies on cartoon> test class : 72.48
------------------------------
<Accuracies on art_painting> test class : 46.19
------------------------------
Total epoch time: 49.487

******************************
Best val 0.959799, corresponding test 0.597987 - best test: 0.62966

******************************
Best val 0.9597989916801453, corresponding photo test 0.5700598955154419

******************************
Best val 0.9597989916801453, corresponding cartoon test 0.7039248943328857

******************************
Best val 0.9597989916801453, corresponding art_painting test 0.49951171875
