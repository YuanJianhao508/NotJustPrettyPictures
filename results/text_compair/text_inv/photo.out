WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.112, total : 2.112 
 {acc} cls : 14.84
------------------------------
<Losses on train> cls : 2.215, total : 2.215
<Accuracies on train> cls : 64.03
Train epoch time: 29.665
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 58.32
------------------------------
<Accuracies on cartoon> test class : 61.09
------------------------------
<Accuracies on art_painting> test class : 66.02
------------------------------
<Accuracies on sketch> test class : 52.66
------------------------------
Total epoch time: 65.522

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.272, total : 0.272 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.330, total : 0.330
<Accuracies on train> cls : 92.63
Train epoch time: 25.981
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 55.57
------------------------------
<Accuracies on cartoon> test class : 65.02
------------------------------
<Accuracies on art_painting> test class : 67.53
------------------------------
<Accuracies on sketch> test class : 43.70
------------------------------
Total epoch time: 54.302

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.135, total : 0.135 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.193, total : 0.193
<Accuracies on train> cls : 94.80
Train epoch time: 22.674
------------------------------
<Accuracies on val> class : 96.49
------------------------------
<Accuracies on test> class : 51.29
------------------------------
<Accuracies on cartoon> test class : 61.69
------------------------------
<Accuracies on art_painting> test class : 60.79
------------------------------
<Accuracies on sketch> test class : 40.14
------------------------------
Total epoch time: 51.493

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.156, total : 0.156 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.159, total : 0.159
<Accuracies on train> cls : 95.28
Train epoch time: 21.671
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 59.79
------------------------------
<Accuracies on cartoon> test class : 65.61
------------------------------
<Accuracies on art_painting> test class : 64.89
------------------------------
<Accuracies on sketch> test class : 53.65
------------------------------
Total epoch time: 50.482

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.093, total : 0.093 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.114, total : 0.114
<Accuracies on train> cls : 96.57
Train epoch time: 21.046
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 60.56
------------------------------
<Accuracies on cartoon> test class : 65.74
------------------------------
<Accuracies on art_painting> test class : 67.14
------------------------------
<Accuracies on sketch> test class : 54.03
------------------------------
Total epoch time: 49.787

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.145, total : 0.145 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.098, total : 0.098
<Accuracies on train> cls : 96.84
Train epoch time: 20.004
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 62.87
------------------------------
<Accuracies on cartoon> test class : 66.64
------------------------------
<Accuracies on art_painting> test class : 67.97
------------------------------
<Accuracies on sketch> test class : 57.95
------------------------------
Total epoch time: 50.276

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.207, total : 0.207 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.095, total : 0.095
<Accuracies on train> cls : 97.32
Train epoch time: 19.675
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 64.10
------------------------------
<Accuracies on cartoon> test class : 64.76
------------------------------
<Accuracies on art_painting> test class : 68.02
------------------------------
<Accuracies on sketch> test class : 61.67
------------------------------
Total epoch time: 50.511

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.089, total : 0.089 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.086, total : 0.086
<Accuracies on train> cls : 97.15
Train epoch time: 18.671
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 64.72
------------------------------
<Accuracies on cartoon> test class : 65.27
------------------------------
<Accuracies on art_painting> test class : 67.43
------------------------------
<Accuracies on sketch> test class : 62.97
------------------------------
Total epoch time: 49.097

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.086, total : 0.086 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.071, total : 0.071
<Accuracies on train> cls : 97.49
Train epoch time: 18.116
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 64.63
------------------------------
<Accuracies on cartoon> test class : 67.41
------------------------------
<Accuracies on art_painting> test class : 63.38
------------------------------
<Accuracies on sketch> test class : 63.63
------------------------------
Total epoch time: 49.040

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.074, total : 0.074 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.071, total : 0.071
<Accuracies on train> cls : 97.79
Train epoch time: 18.880
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.01
------------------------------
<Accuracies on cartoon> test class : 63.44
------------------------------
<Accuracies on art_painting> test class : 65.23
------------------------------
<Accuracies on sketch> test class : 67.96
------------------------------
Total epoch time: 49.245

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.070, total : 0.070
<Accuracies on train> cls : 97.83
Train epoch time: 19.273
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 66.65
------------------------------
<Accuracies on cartoon> test class : 64.12
------------------------------
<Accuracies on art_painting> test class : 65.67
------------------------------
<Accuracies on sketch> test class : 68.67
------------------------------
Total epoch time: 49.372

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.049, total : 0.049 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.40
Train epoch time: 18.573
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.74
------------------------------
<Accuracies on cartoon> test class : 64.16
------------------------------
<Accuracies on art_painting> test class : 68.95
------------------------------
<Accuracies on sketch> test class : 73.48
------------------------------
Total epoch time: 49.552

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.045, total : 0.045 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.043, total : 0.043
<Accuracies on train> cls : 98.47
Train epoch time: 18.625
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.63
------------------------------
<Accuracies on cartoon> test class : 67.88
------------------------------
<Accuracies on art_painting> test class : 69.09
------------------------------
<Accuracies on sketch> test class : 70.96
------------------------------
Total epoch time: 49.182

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.040, total : 0.040 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.044, total : 0.044
<Accuracies on train> cls : 98.74
Train epoch time: 17.989
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.37
------------------------------
<Accuracies on cartoon> test class : 66.85
------------------------------
<Accuracies on art_painting> test class : 68.60
------------------------------
<Accuracies on sketch> test class : 69.15
------------------------------
Total epoch time: 48.476

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.051, total : 0.051 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.046, total : 0.046
<Accuracies on train> cls : 98.51
Train epoch time: 18.696
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 70.50
------------------------------
<Accuracies on cartoon> test class : 67.36
------------------------------
<Accuracies on art_painting> test class : 70.07
------------------------------
<Accuracies on sketch> test class : 72.59
------------------------------
Total epoch time: 48.460

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.039, total : 0.039 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.042, total : 0.042
<Accuracies on train> cls : 98.40
Train epoch time: 19.521
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.88
------------------------------
<Accuracies on cartoon> test class : 66.94
------------------------------
<Accuracies on art_painting> test class : 71.63
------------------------------
<Accuracies on sketch> test class : 72.84
------------------------------
Total epoch time: 49.531

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.036, total : 0.036
<Accuracies on train> cls : 98.68
Train epoch time: 19.615
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.99
------------------------------
<Accuracies on cartoon> test class : 67.62
------------------------------
<Accuracies on art_painting> test class : 70.26
------------------------------
<Accuracies on sketch> test class : 71.26
------------------------------
Total epoch time: 48.053

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.047, total : 0.047 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.91
Train epoch time: 19.621
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 68.57
------------------------------
<Accuracies on cartoon> test class : 66.55
------------------------------
<Accuracies on art_painting> test class : 69.92
------------------------------
<Accuracies on sketch> test class : 69.08
------------------------------
Total epoch time: 48.160

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.048, total : 0.048 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.037, total : 0.037
<Accuracies on train> cls : 98.81
Train epoch time: 19.668
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 70.29
------------------------------
<Accuracies on cartoon> test class : 67.32
------------------------------
<Accuracies on art_painting> test class : 70.80
------------------------------
<Accuracies on sketch> test class : 71.80
------------------------------
Total epoch time: 47.670

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.041, total : 0.041
<Accuracies on train> cls : 98.68
Train epoch time: 18.918
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.79
------------------------------
<Accuracies on cartoon> test class : 69.07
------------------------------
<Accuracies on art_painting> test class : 71.68
------------------------------
<Accuracies on sketch> test class : 69.23
------------------------------
Total epoch time: 47.088

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.054, total : 0.054 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.038, total : 0.038
<Accuracies on train> cls : 98.68
Train epoch time: 19.253
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 70.27
------------------------------
<Accuracies on cartoon> test class : 67.79
------------------------------
<Accuracies on art_painting> test class : 68.99
------------------------------
<Accuracies on sketch> test class : 72.41
------------------------------
Total epoch time: 47.910

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.028, total : 0.028 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.32
Train epoch time: 20.324
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 69.64
------------------------------
<Accuracies on cartoon> test class : 68.13
------------------------------
<Accuracies on art_painting> test class : 70.12
------------------------------
<Accuracies on sketch> test class : 70.30
------------------------------
Total epoch time: 48.774

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.029, total : 0.029 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.025, total : 0.025
<Accuracies on train> cls : 99.35
Train epoch time: 19.730
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.50
------------------------------
<Accuracies on cartoon> test class : 70.35
------------------------------
<Accuracies on art_painting> test class : 70.85
------------------------------
<Accuracies on sketch> test class : 68.29
------------------------------
Total epoch time: 49.240

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.025, total : 0.025 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.35
Train epoch time: 19.464
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.60
------------------------------
<Accuracies on cartoon> test class : 68.81
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 70.22
------------------------------
Total epoch time: 49.567

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.105, total : 0.105 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.39
Train epoch time: 18.375
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.04
------------------------------
<Accuracies on cartoon> test class : 66.89
------------------------------
<Accuracies on art_painting> test class : 69.73
------------------------------
<Accuracies on sketch> test class : 72.08
------------------------------
Total epoch time: 49.135

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.35
Train epoch time: 18.227
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.49
------------------------------
<Accuracies on cartoon> test class : 67.62
------------------------------
<Accuracies on art_painting> test class : 70.95
------------------------------
<Accuracies on sketch> test class : 69.84
------------------------------
Total epoch time: 49.003

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.15
Train epoch time: 18.309
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.34
------------------------------
<Accuracies on cartoon> test class : 66.13
------------------------------
<Accuracies on art_painting> test class : 70.80
------------------------------
<Accuracies on sketch> test class : 70.50
------------------------------
Total epoch time: 49.232

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.071, total : 0.071 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.42
Train epoch time: 18.877
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.93
------------------------------
<Accuracies on cartoon> test class : 69.28
------------------------------
<Accuracies on art_painting> test class : 71.04
------------------------------
<Accuracies on sketch> test class : 71.85
------------------------------
Total epoch time: 49.852

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.63
Train epoch time: 18.613
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.07
------------------------------
<Accuracies on cartoon> test class : 69.41
------------------------------
<Accuracies on art_painting> test class : 70.65
------------------------------
<Accuracies on sketch> test class : 72.28
------------------------------
Total epoch time: 48.910

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.63
Train epoch time: 18.302
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.12
------------------------------
<Accuracies on cartoon> test class : 69.71
------------------------------
<Accuracies on art_painting> test class : 70.95
------------------------------
<Accuracies on sketch> test class : 72.05
------------------------------
Total epoch time: 48.602

******************************
Best val 1, corresponding test 0.711213 - best test: 0.711213

******************************
Best val 1.0, corresponding cartoon test 0.697098970413208

******************************
Best val 1.0, corresponding art_painting test 0.70947265625

******************************
Best val 1.0, corresponding sketch test 0.7205395698547363
