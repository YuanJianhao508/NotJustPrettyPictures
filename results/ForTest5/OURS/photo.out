
Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.140, total : 2.140 
 {acc} cls : 14.06
------------------------------
<Losses on train> cls : 0.808, total : 0.808
<Accuracies on train> cls : 75.78
Train epoch time: 28.376
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 58.45
------------------------------
<Accuracies on cartoon> test class : 63.65
------------------------------
<Accuracies on art_painting> test class : 64.99
------------------------------
<Accuracies on sketch> test class : 51.95
------------------------------
Total epoch time: 68.239

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.221, total : 0.221 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.177, total : 0.177
<Accuracies on train> cls : 94.87
Train epoch time: 24.916
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 62.70
------------------------------
<Accuracies on cartoon> test class : 70.69
------------------------------
<Accuracies on art_painting> test class : 68.75
------------------------------
<Accuracies on sketch> test class : 54.77
------------------------------
Total epoch time: 63.626

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.119, total : 0.119
<Accuracies on train> cls : 96.30
Train epoch time: 23.557
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 49.89
------------------------------
<Accuracies on cartoon> test class : 66.51
------------------------------
<Accuracies on art_painting> test class : 70.95
------------------------------
<Accuracies on sketch> test class : 28.99
------------------------------
Total epoch time: 62.655

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.151, total : 0.151 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.111, total : 0.111
<Accuracies on train> cls : 96.60
Train epoch time: 24.253
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.71
------------------------------
<Accuracies on cartoon> test class : 68.98
------------------------------
<Accuracies on art_painting> test class : 70.56
------------------------------
<Accuracies on sketch> test class : 65.46
------------------------------
Total epoch time: 64.725

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.080, total : 0.080 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.081, total : 0.081
<Accuracies on train> cls : 97.38
Train epoch time: 24.404
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.95
------------------------------
<Accuracies on cartoon> test class : 71.93
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 62.76
------------------------------
Total epoch time: 63.078

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.097, total : 0.097 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.069, total : 0.069
<Accuracies on train> cls : 98.00
Train epoch time: 23.366
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 66.64
------------------------------
<Accuracies on cartoon> test class : 74.15
------------------------------
<Accuracies on art_painting> test class : 72.95
------------------------------
<Accuracies on sketch> test class : 58.87
------------------------------
Total epoch time: 64.460

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.142, total : 0.142 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.059, total : 0.059
<Accuracies on train> cls : 98.06
Train epoch time: 23.970
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 63.11
------------------------------
<Accuracies on cartoon> test class : 65.61
------------------------------
<Accuracies on art_painting> test class : 71.73
------------------------------
<Accuracies on sketch> test class : 57.11
------------------------------
Total epoch time: 63.076

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.052, total : 0.052 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.071, total : 0.071
<Accuracies on train> cls : 97.83
Train epoch time: 22.400
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.40
------------------------------
<Accuracies on cartoon> test class : 70.39
------------------------------
<Accuracies on art_painting> test class : 69.53
------------------------------
<Accuracies on sketch> test class : 64.49
------------------------------
Total epoch time: 62.078

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.051, total : 0.051
<Accuracies on train> cls : 98.27
Train epoch time: 22.733
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 64.46
------------------------------
<Accuracies on cartoon> test class : 73.68
------------------------------
<Accuracies on art_painting> test class : 73.93
------------------------------
<Accuracies on sketch> test class : 54.03
------------------------------
Total epoch time: 60.940

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.044, total : 0.044
<Accuracies on train> cls : 98.61
Train epoch time: 24.128
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 65.38
------------------------------
<Accuracies on cartoon> test class : 72.91
------------------------------
<Accuracies on art_painting> test class : 72.56
------------------------------
<Accuracies on sketch> test class : 57.14
------------------------------
Total epoch time: 61.105

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.95
Train epoch time: 24.655
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 66.67
------------------------------
<Accuracies on cartoon> test class : 72.48
------------------------------
<Accuracies on art_painting> test class : 73.10
------------------------------
<Accuracies on sketch> test class : 59.86
------------------------------
Total epoch time: 61.161

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.035, total : 0.035
<Accuracies on train> cls : 98.88
Train epoch time: 24.784
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 67.28
------------------------------
<Accuracies on cartoon> test class : 72.95
------------------------------
<Accuracies on art_painting> test class : 73.10
------------------------------
<Accuracies on sketch> test class : 60.86
------------------------------
Total epoch time: 62.526

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.031, total : 0.031
<Accuracies on train> cls : 98.88
Train epoch time: 23.562
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 67.43
------------------------------
<Accuracies on cartoon> test class : 73.17
------------------------------
<Accuracies on art_painting> test class : 70.75
------------------------------
<Accuracies on sketch> test class : 62.28
------------------------------
Total epoch time: 60.652

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.038, total : 0.038 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.025, total : 0.025
<Accuracies on train> cls : 99.18
Train epoch time: 24.388
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 67.24
------------------------------
<Accuracies on cartoon> test class : 72.57
------------------------------
<Accuracies on art_painting> test class : 73.00
------------------------------
<Accuracies on sketch> test class : 61.06
------------------------------
Total epoch time: 61.689

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.01
Train epoch time: 23.898
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.64
------------------------------
<Accuracies on cartoon> test class : 76.24
------------------------------
<Accuracies on art_painting> test class : 72.12
------------------------------
<Accuracies on sketch> test class : 64.42
------------------------------
Total epoch time: 62.845

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.29
Train epoch time: 24.040
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 68.29
------------------------------
<Accuracies on cartoon> test class : 74.40
------------------------------
<Accuracies on art_painting> test class : 73.73
------------------------------
<Accuracies on sketch> test class : 61.80
------------------------------
Total epoch time: 63.641

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.019, total : 0.019
<Accuracies on train> cls : 99.42
Train epoch time: 23.364
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 66.25
------------------------------
<Accuracies on cartoon> test class : 74.15
------------------------------
<Accuracies on art_painting> test class : 75.59
------------------------------
<Accuracies on sketch> test class : 56.68
------------------------------
Total epoch time: 63.955

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.05
Train epoch time: 24.798
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.59
------------------------------
<Accuracies on cartoon> test class : 76.83
------------------------------
<Accuracies on art_painting> test class : 72.56
------------------------------
<Accuracies on sketch> test class : 67.96
------------------------------
Total epoch time: 65.077

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.52
Train epoch time: 22.911
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.98
------------------------------
<Accuracies on cartoon> test class : 75.73
------------------------------
<Accuracies on art_painting> test class : 74.37
------------------------------
<Accuracies on sketch> test class : 64.27
------------------------------
Total epoch time: 63.163

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.49
Train epoch time: 23.559
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.96
------------------------------
<Accuracies on cartoon> test class : 70.65
------------------------------
<Accuracies on art_painting> test class : 73.24
------------------------------
<Accuracies on sketch> test class : 67.83
------------------------------
Total epoch time: 62.308

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.18
Train epoch time: 22.798
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 70.35
------------------------------
<Accuracies on cartoon> test class : 75.73
------------------------------
<Accuracies on art_painting> test class : 76.03
------------------------------
<Accuracies on sketch> test class : 64.19
------------------------------
Total epoch time: 60.871

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.025, total : 0.025
<Accuracies on train> cls : 99.05
Train epoch time: 22.374
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 72.79
------------------------------
<Accuracies on cartoon> test class : 74.70
------------------------------
<Accuracies on art_painting> test class : 73.24
------------------------------
<Accuracies on sketch> test class : 71.42
------------------------------
Total epoch time: 61.696

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.49
Train epoch time: 23.595
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 72.84
------------------------------
<Accuracies on cartoon> test class : 73.46
------------------------------
<Accuracies on art_painting> test class : 74.90
------------------------------
<Accuracies on sketch> test class : 71.39
------------------------------
Total epoch time: 62.259

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.043, total : 0.043 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.32
Train epoch time: 25.133
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.81
------------------------------
<Accuracies on cartoon> test class : 73.89
------------------------------
<Accuracies on art_painting> test class : 73.14
------------------------------
<Accuracies on sketch> test class : 65.64
------------------------------
Total epoch time: 62.738

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.73
Train epoch time: 25.299
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.59
------------------------------
<Accuracies on cartoon> test class : 74.40
------------------------------
<Accuracies on art_painting> test class : 72.56
------------------------------
<Accuracies on sketch> test class : 69.41
------------------------------
Total epoch time: 63.496

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.63
Train epoch time: 24.929
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.27
------------------------------
<Accuracies on cartoon> test class : 72.14
------------------------------
<Accuracies on art_painting> test class : 72.85
------------------------------
<Accuracies on sketch> test class : 69.92
------------------------------
Total epoch time: 62.815

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.42
Train epoch time: 23.336
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.17
------------------------------
<Accuracies on cartoon> test class : 73.68
------------------------------
<Accuracies on art_painting> test class : 74.27
------------------------------
<Accuracies on sketch> test class : 68.06
------------------------------
Total epoch time: 61.870

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.63
Train epoch time: 23.669
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 72.15
------------------------------
<Accuracies on cartoon> test class : 75.55
------------------------------
<Accuracies on art_painting> test class : 73.63
------------------------------
<Accuracies on sketch> test class : 69.36
------------------------------
Total epoch time: 61.327

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.59
Train epoch time: 24.184
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.33
------------------------------
<Accuracies on cartoon> test class : 74.27
------------------------------
<Accuracies on art_painting> test class : 74.02
------------------------------
<Accuracies on sketch> test class : 68.16
------------------------------
Total epoch time: 62.067

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.63
Train epoch time: 23.557
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.54
------------------------------
<Accuracies on cartoon> test class : 73.17
------------------------------
<Accuracies on art_painting> test class : 72.61
------------------------------
<Accuracies on sketch> test class : 70.02
------------------------------
Total epoch time: 61.924

******************************
Best val 1, corresponding test 0.715419 - best test: 0.728398

******************************
Best val 1.0, corresponding cartoon test 0.7316552996635437

******************************
Best val 1.0, corresponding art_painting test 0.72607421875

******************************
Best val 1.0, corresponding sketch test 0.7001781463623047
