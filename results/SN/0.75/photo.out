WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.004, total : 2.004 
 {acc} cls : 17.19
------------------------------
<Losses on train> cls : 2.268, total : 2.268
<Accuracies on train> cls : 47.01
Train epoch time: 10.735
------------------------------
<Accuracies on val> class : 67.84
------------------------------
<Accuracies on test> class : 21.28
------------------------------
<Accuracies on cartoon> test class : 19.45
------------------------------
<Accuracies on art_painting> test class : 26.66
------------------------------
<Accuracies on sketch> test class : 19.57
------------------------------
Total epoch time: 42.354

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.483, total : 0.483 
 {acc} cls : 79.69
------------------------------
<Losses on train> cls : 0.621, total : 0.621
<Accuracies on train> cls : 77.24
Train epoch time: 10.682
------------------------------
<Accuracies on val> class : 81.29
------------------------------
<Accuracies on test> class : 29.00
------------------------------
<Accuracies on cartoon> test class : 24.02
------------------------------
<Accuracies on art_painting> test class : 39.89
------------------------------
<Accuracies on sketch> test class : 26.29
------------------------------
Total epoch time: 51.596

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.504, total : 0.504 
 {acc} cls : 82.81
------------------------------
<Losses on train> cls : 0.406, total : 0.406
<Accuracies on train> cls : 84.17
Train epoch time: 12.748
------------------------------
<Accuracies on val> class : 84.80
------------------------------
<Accuracies on test> class : 32.42
------------------------------
<Accuracies on cartoon> test class : 29.86
------------------------------
<Accuracies on art_painting> test class : 42.53
------------------------------
<Accuracies on sketch> test class : 28.68
------------------------------
Total epoch time: 56.891

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.207, total : 0.207 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.283, total : 0.283
<Accuracies on train> cls : 89.06
Train epoch time: 11.260
------------------------------
<Accuracies on val> class : 87.13
------------------------------
<Accuracies on test> class : 41.38
------------------------------
<Accuracies on cartoon> test class : 34.26
------------------------------
<Accuracies on art_painting> test class : 41.94
------------------------------
<Accuracies on sketch> test class : 45.33
------------------------------
Total epoch time: 53.506

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.144, total : 0.144 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.212, total : 0.212
<Accuracies on train> cls : 92.80
Train epoch time: 10.241
------------------------------
<Accuracies on val> class : 86.55
------------------------------
<Accuracies on test> class : 34.50
------------------------------
<Accuracies on cartoon> test class : 30.08
------------------------------
<Accuracies on art_painting> test class : 43.46
------------------------------
<Accuracies on sketch> test class : 32.48
------------------------------
Total epoch time: 52.297

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.230, total : 0.230 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.186, total : 0.186
<Accuracies on train> cls : 93.41
Train epoch time: 10.239
------------------------------
<Accuracies on val> class : 88.30
------------------------------
<Accuracies on test> class : 36.98
------------------------------
<Accuracies on cartoon> test class : 28.11
------------------------------
<Accuracies on art_painting> test class : 45.51
------------------------------
<Accuracies on sketch> test class : 37.82
------------------------------
Total epoch time: 53.467

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.108, total : 0.108 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.124, total : 0.124
<Accuracies on train> cls : 95.65
Train epoch time: 10.760
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 33.22
------------------------------
<Accuracies on cartoon> test class : 26.19
------------------------------
<Accuracies on art_painting> test class : 47.17
------------------------------
<Accuracies on sketch> test class : 30.13
------------------------------
Total epoch time: 53.232

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.145, total : 0.145 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.115, total : 0.115
<Accuracies on train> cls : 96.06
Train epoch time: 10.280
------------------------------
<Accuracies on val> class : 89.47
------------------------------
<Accuracies on test> class : 33.02
------------------------------
<Accuracies on cartoon> test class : 24.27
------------------------------
<Accuracies on art_painting> test class : 48.58
------------------------------
<Accuracies on sketch> test class : 30.13
------------------------------
Total epoch time: 51.602

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.084, total : 0.084 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.086, total : 0.086
<Accuracies on train> cls : 97.08
Train epoch time: 9.987
------------------------------
<Accuracies on val> class : 89.47
------------------------------
<Accuracies on test> class : 36.46
------------------------------
<Accuracies on cartoon> test class : 27.09
------------------------------
<Accuracies on art_painting> test class : 44.34
------------------------------
<Accuracies on sketch> test class : 37.95
------------------------------
Total epoch time: 51.373

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.078, total : 0.078 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.075, total : 0.075
<Accuracies on train> cls : 98.03
Train epoch time: 10.133
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 35.80
------------------------------
<Accuracies on cartoon> test class : 29.22
------------------------------
<Accuracies on art_painting> test class : 47.90
------------------------------
<Accuracies on sketch> test class : 33.42
------------------------------
Total epoch time: 52.702

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.054, total : 0.054
<Accuracies on train> cls : 98.37
Train epoch time: 10.220
------------------------------
<Accuracies on val> class : 90.06
------------------------------
<Accuracies on test> class : 42.71
------------------------------
<Accuracies on cartoon> test class : 36.18
------------------------------
<Accuracies on art_painting> test class : 46.83
------------------------------
<Accuracies on sketch> test class : 44.46
------------------------------
Total epoch time: 52.000

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.039, total : 0.039 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.043, total : 0.043
<Accuracies on train> cls : 98.64
Train epoch time: 10.956
------------------------------
<Accuracies on val> class : 88.30
------------------------------
<Accuracies on test> class : 42.52
------------------------------
<Accuracies on cartoon> test class : 36.18
------------------------------
<Accuracies on art_painting> test class : 46.88
------------------------------
<Accuracies on sketch> test class : 44.03
------------------------------
Total epoch time: 56.417

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.71
Train epoch time: 10.851
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 35.98
------------------------------
<Accuracies on cartoon> test class : 31.48
------------------------------
<Accuracies on art_painting> test class : 48.78
------------------------------
<Accuracies on sketch> test class : 31.99
------------------------------
Total epoch time: 59.837

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.049, total : 0.049
<Accuracies on train> cls : 98.30
Train epoch time: 10.617
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 39.53
------------------------------
<Accuracies on cartoon> test class : 34.00
------------------------------
<Accuracies on art_painting> test class : 46.73
------------------------------
<Accuracies on sketch> test class : 39.07
------------------------------
Total epoch time: 54.347

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.51
Train epoch time: 10.694
------------------------------
<Accuracies on val> class : 90.64
------------------------------
<Accuracies on test> class : 43.04
------------------------------
<Accuracies on cartoon> test class : 37.20
------------------------------
<Accuracies on art_painting> test class : 48.05
------------------------------
<Accuracies on sketch> test class : 43.90
------------------------------
Total epoch time: 57.213

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.18
Train epoch time: 10.210
------------------------------
<Accuracies on val> class : 90.06
------------------------------
<Accuracies on test> class : 39.33
------------------------------
<Accuracies on cartoon> test class : 32.04
------------------------------
<Accuracies on art_painting> test class : 48.68
------------------------------
<Accuracies on sketch> test class : 38.81
------------------------------
Total epoch time: 57.627

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.032, total : 0.032
<Accuracies on train> cls : 98.85
Train epoch time: 10.049
------------------------------
<Accuracies on val> class : 89.47
------------------------------
<Accuracies on test> class : 36.10
------------------------------
<Accuracies on cartoon> test class : 30.63
------------------------------
<Accuracies on art_painting> test class : 47.75
------------------------------
<Accuracies on sketch> test class : 33.29
------------------------------
Total epoch time: 54.508

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.048, total : 0.048 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.25
Train epoch time: 10.422
------------------------------
<Accuracies on val> class : 87.72
------------------------------
<Accuracies on test> class : 45.76
------------------------------
<Accuracies on cartoon> test class : 39.21
------------------------------
<Accuracies on art_painting> test class : 49.27
------------------------------
<Accuracies on sketch> test class : 47.85
------------------------------
Total epoch time: 53.754

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.32
Train epoch time: 11.142
------------------------------
<Accuracies on val> class : 90.06
------------------------------
<Accuracies on test> class : 41.70
------------------------------
<Accuracies on cartoon> test class : 33.96
------------------------------
<Accuracies on art_painting> test class : 47.36
------------------------------
<Accuracies on sketch> test class : 43.37
------------------------------
Total epoch time: 51.637

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.05
Train epoch time: 11.155
------------------------------
<Accuracies on val> class : 90.06
------------------------------
<Accuracies on test> class : 43.14
------------------------------
<Accuracies on cartoon> test class : 33.87
------------------------------
<Accuracies on art_painting> test class : 49.46
------------------------------
<Accuracies on sketch> test class : 45.38
------------------------------
Total epoch time: 50.468

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.019, total : 0.019
<Accuracies on train> cls : 99.52
Train epoch time: 11.351
------------------------------
<Accuracies on val> class : 88.30
------------------------------
<Accuracies on test> class : 40.72
------------------------------
<Accuracies on cartoon> test class : 34.60
------------------------------
<Accuracies on art_painting> test class : 48.39
------------------------------
<Accuracies on sketch> test class : 40.37
------------------------------
Total epoch time: 55.907

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.39
Train epoch time: 12.381
------------------------------
<Accuracies on val> class : 89.47
------------------------------
<Accuracies on test> class : 36.07
------------------------------
<Accuracies on cartoon> test class : 29.52
------------------------------
<Accuracies on art_painting> test class : 50.20
------------------------------
<Accuracies on sketch> test class : 32.60
------------------------------
Total epoch time: 53.654

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.66
Train epoch time: 12.398
------------------------------
<Accuracies on val> class : 88.30
------------------------------
<Accuracies on test> class : 42.93
------------------------------
<Accuracies on cartoon> test class : 37.12
------------------------------
<Accuracies on art_painting> test class : 49.32
------------------------------
<Accuracies on sketch> test class : 43.06
------------------------------
Total epoch time: 54.104

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.80
Train epoch time: 12.101
------------------------------
<Accuracies on val> class : 91.23
------------------------------
<Accuracies on test> class : 43.95
------------------------------
<Accuracies on cartoon> test class : 38.87
------------------------------
<Accuracies on art_painting> test class : 47.41
------------------------------
<Accuracies on sketch> test class : 45.18
------------------------------
Total epoch time: 52.525

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.52
Train epoch time: 12.190
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 38.54
------------------------------
<Accuracies on cartoon> test class : 32.47
------------------------------
<Accuracies on art_painting> test class : 48.88
------------------------------
<Accuracies on sketch> test class : 36.78
------------------------------
Total epoch time: 54.957

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.80
Train epoch time: 10.513
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 36.27
------------------------------
<Accuracies on cartoon> test class : 31.83
------------------------------
<Accuracies on art_painting> test class : 48.00
------------------------------
<Accuracies on sketch> test class : 32.81
------------------------------
Total epoch time: 55.679

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.73
Train epoch time: 9.700
------------------------------
<Accuracies on val> class : 90.64
------------------------------
<Accuracies on test> class : 37.21
------------------------------
<Accuracies on cartoon> test class : 33.23
------------------------------
<Accuracies on art_painting> test class : 48.78
------------------------------
<Accuracies on sketch> test class : 33.55
------------------------------
Total epoch time: 54.597

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.80
Train epoch time: 9.765
------------------------------
<Accuracies on val> class : 91.23
------------------------------
<Accuracies on test> class : 36.40
------------------------------
<Accuracies on cartoon> test class : 31.70
------------------------------
<Accuracies on art_painting> test class : 49.95
------------------------------
<Accuracies on sketch> test class : 32.15
------------------------------
Total epoch time: 47.949

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.93
Train epoch time: 9.688
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 37.03
------------------------------
<Accuracies on cartoon> test class : 32.68
------------------------------
<Accuracies on art_painting> test class : 49.90
------------------------------
<Accuracies on sketch> test class : 32.91
------------------------------
Total epoch time: 46.014

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.86
Train epoch time: 9.344
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 38.28
------------------------------
<Accuracies on cartoon> test class : 33.49
------------------------------
<Accuracies on art_painting> test class : 51.12
------------------------------
<Accuracies on sketch> test class : 34.44
------------------------------
Total epoch time: 41.878

******************************
Best val 0.929825, corresponding test 0.382766 - best test: 0.457637

******************************
Best val 0.9298245906829834, corresponding cartoon test 0.33489760756492615

******************************
Best val 0.9298245906829834, corresponding art_painting test 0.51123046875

******************************
Best val 0.9298245906829834, corresponding sketch test 0.34436243772506714
