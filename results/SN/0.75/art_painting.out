WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/28 iteration of epoch 1/30] 
 {loss} cls : 2.182, total : 2.182 
 {acc} cls : 10.94
------------------------------
<Losses on train> cls : 5.000, total : 5.000
<Accuracies on train> cls : 21.88
Train epoch time: 13.975
------------------------------
<Accuracies on val> class : 29.81
------------------------------
<Accuracies on test> class : 22.43
------------------------------
<Accuracies on photo> test class : 23.23
------------------------------
<Accuracies on cartoon> test class : 22.18
------------------------------
<Accuracies on sketch> test class : 22.24
------------------------------
Total epoch time: 43.536

New epoch - lr: 0.003
[1/28 iteration of epoch 2/30] 
 {loss} cls : 2.000, total : 2.000 
 {acc} cls : 31.25
------------------------------
<Losses on train> cls : 1.897, total : 1.897
<Accuracies on train> cls : 39.01
Train epoch time: 13.321
------------------------------
<Accuracies on val> class : 50.96
------------------------------
<Accuracies on test> class : 33.77
------------------------------
<Accuracies on photo> test class : 50.30
------------------------------
<Accuracies on cartoon> test class : 32.72
------------------------------
<Accuracies on sketch> test class : 27.36
------------------------------
Total epoch time: 50.020

New epoch - lr: 0.003
[1/28 iteration of epoch 3/30] 
 {loss} cls : 1.683, total : 1.683 
 {acc} cls : 45.31
------------------------------
<Losses on train> cls : 1.352, total : 1.352
<Accuracies on train> cls : 55.75
Train epoch time: 13.534
------------------------------
<Accuracies on val> class : 57.69
------------------------------
<Accuracies on test> class : 48.62
------------------------------
<Accuracies on photo> test class : 58.98
------------------------------
<Accuracies on cartoon> test class : 46.33
------------------------------
<Accuracies on sketch> test class : 45.58
------------------------------
Total epoch time: 51.009

New epoch - lr: 0.003
[1/28 iteration of epoch 4/30] 
 {loss} cls : 0.964, total : 0.964 
 {acc} cls : 65.62
------------------------------
<Losses on train> cls : 1.119, total : 1.119
<Accuracies on train> cls : 63.95
Train epoch time: 13.548
------------------------------
<Accuracies on val> class : 62.50
------------------------------
<Accuracies on test> class : 49.64
------------------------------
<Accuracies on photo> test class : 59.04
------------------------------
<Accuracies on cartoon> test class : 51.79
------------------------------
<Accuracies on sketch> test class : 44.36
------------------------------
Total epoch time: 49.500

New epoch - lr: 0.003
[1/28 iteration of epoch 5/30] 
 {loss} cls : 0.709, total : 0.709 
 {acc} cls : 75.00
------------------------------
<Losses on train> cls : 0.873, total : 0.873
<Accuracies on train> cls : 70.98
Train epoch time: 12.882
------------------------------
<Accuracies on val> class : 64.90
------------------------------
<Accuracies on test> class : 58.47
------------------------------
<Accuracies on photo> test class : 58.92
------------------------------
<Accuracies on cartoon> test class : 54.48
------------------------------
<Accuracies on sketch> test class : 60.65
------------------------------
Total epoch time: 50.684

New epoch - lr: 0.003
[1/28 iteration of epoch 6/30] 
 {loss} cls : 0.830, total : 0.830 
 {acc} cls : 76.56
------------------------------
<Losses on train> cls : 0.672, total : 0.672
<Accuracies on train> cls : 76.84
Train epoch time: 12.641
------------------------------
<Accuracies on val> class : 68.75
------------------------------
<Accuracies on test> class : 61.24
------------------------------
<Accuracies on photo> test class : 66.65
------------------------------
<Accuracies on cartoon> test class : 57.30
------------------------------
<Accuracies on sketch> test class : 61.29
------------------------------
Total epoch time: 52.116

New epoch - lr: 0.003
[1/28 iteration of epoch 7/30] 
 {loss} cls : 0.653, total : 0.653 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.527, total : 0.527
<Accuracies on train> cls : 81.75
Train epoch time: 11.650
------------------------------
<Accuracies on val> class : 67.79
------------------------------
<Accuracies on test> class : 61.07
------------------------------
<Accuracies on photo> test class : 69.64
------------------------------
<Accuracies on cartoon> test class : 55.89
------------------------------
<Accuracies on sketch> test class : 60.52
------------------------------
Total epoch time: 50.787

New epoch - lr: 0.003
[1/28 iteration of epoch 8/30] 
 {loss} cls : 0.313, total : 0.313 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.393, total : 0.393
<Accuracies on train> cls : 87.00
Train epoch time: 11.810
------------------------------
<Accuracies on val> class : 69.23
------------------------------
<Accuracies on test> class : 53.85
------------------------------
<Accuracies on photo> test class : 69.64
------------------------------
<Accuracies on cartoon> test class : 49.06
------------------------------
<Accuracies on sketch> test class : 49.99
------------------------------
Total epoch time: 51.697

New epoch - lr: 0.003
[1/28 iteration of epoch 9/30] 
 {loss} cls : 0.339, total : 0.339 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.380, total : 0.380
<Accuracies on train> cls : 87.44
Train epoch time: 11.295
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 59.23
------------------------------
<Accuracies on photo> test class : 75.27
------------------------------
<Accuracies on cartoon> test class : 52.39
------------------------------
<Accuracies on sketch> test class : 56.50
------------------------------
Total epoch time: 50.158

New epoch - lr: 0.003
[1/28 iteration of epoch 10/30] 
 {loss} cls : 0.235, total : 0.235 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.286, total : 0.286
<Accuracies on train> cls : 89.90
Train epoch time: 10.847
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 62.66
------------------------------
<Accuracies on photo> test class : 74.37
------------------------------
<Accuracies on cartoon> test class : 57.47
------------------------------
<Accuracies on sketch> test class : 60.78
------------------------------
Total epoch time: 49.601

New epoch - lr: 0.003
[1/28 iteration of epoch 11/30] 
 {loss} cls : 0.483, total : 0.483 
 {acc} cls : 79.69
------------------------------
<Losses on train> cls : 0.270, total : 0.270
<Accuracies on train> cls : 90.62
Train epoch time: 11.146
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 62.17
------------------------------
<Accuracies on photo> test class : 74.31
------------------------------
<Accuracies on cartoon> test class : 60.11
------------------------------
<Accuracies on sketch> test class : 58.23
------------------------------
Total epoch time: 50.960

New epoch - lr: 0.003
[1/28 iteration of epoch 12/30] 
 {loss} cls : 0.107, total : 0.107 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.238, total : 0.238
<Accuracies on train> cls : 92.13
Train epoch time: 11.743
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 61.74
------------------------------
<Accuracies on photo> test class : 71.92
------------------------------
<Accuracies on cartoon> test class : 56.44
------------------------------
<Accuracies on sketch> test class : 60.58
------------------------------
Total epoch time: 50.732

New epoch - lr: 0.003
[1/28 iteration of epoch 13/30] 
 {loss} cls : 0.231, total : 0.231 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.188, total : 0.188
<Accuracies on train> cls : 93.69
Train epoch time: 12.190
------------------------------
<Accuracies on val> class : 74.52
------------------------------
<Accuracies on test> class : 63.94
------------------------------
<Accuracies on photo> test class : 72.46
------------------------------
<Accuracies on cartoon> test class : 59.68
------------------------------
<Accuracies on sketch> test class : 62.87
------------------------------
Total epoch time: 55.112

New epoch - lr: 0.003
[1/28 iteration of epoch 14/30] 
 {loss} cls : 0.088, total : 0.088 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.166, total : 0.166
<Accuracies on train> cls : 94.20
Train epoch time: 13.147
------------------------------
<Accuracies on val> class : 74.04
------------------------------
<Accuracies on test> class : 63.87
------------------------------
<Accuracies on photo> test class : 78.20
------------------------------
<Accuracies on cartoon> test class : 58.75
------------------------------
<Accuracies on sketch> test class : 60.83
------------------------------
Total epoch time: 53.231

New epoch - lr: 0.003
[1/28 iteration of epoch 15/30] 
 {loss} cls : 0.134, total : 0.134 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.164, total : 0.164
<Accuracies on train> cls : 94.14
Train epoch time: 13.892
------------------------------
<Accuracies on val> class : 76.92
------------------------------
<Accuracies on test> class : 60.33
------------------------------
<Accuracies on photo> test class : 75.27
------------------------------
<Accuracies on cartoon> test class : 55.55
------------------------------
<Accuracies on sketch> test class : 56.83
------------------------------
Total epoch time: 53.710

New epoch - lr: 0.003
[1/28 iteration of epoch 16/30] 
 {loss} cls : 0.097, total : 0.097 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.142, total : 0.142
<Accuracies on train> cls : 95.87
Train epoch time: 14.116
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 61.88
------------------------------
<Accuracies on photo> test class : 72.22
------------------------------
<Accuracies on cartoon> test class : 59.26
------------------------------
<Accuracies on sketch> test class : 59.05
------------------------------
Total epoch time: 50.406

New epoch - lr: 0.003
[1/28 iteration of epoch 17/30] 
 {loss} cls : 0.275, total : 0.275 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.128, total : 0.128
<Accuracies on train> cls : 95.59
Train epoch time: 13.110
------------------------------
<Accuracies on val> class : 78.85
------------------------------
<Accuracies on test> class : 63.19
------------------------------
<Accuracies on photo> test class : 76.41
------------------------------
<Accuracies on cartoon> test class : 57.00
------------------------------
<Accuracies on sketch> test class : 61.26
------------------------------
Total epoch time: 49.605

New epoch - lr: 0.003
[1/28 iteration of epoch 18/30] 
 {loss} cls : 0.186, total : 0.186 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.140, total : 0.140
<Accuracies on train> cls : 95.20
Train epoch time: 12.544
------------------------------
<Accuracies on val> class : 75.48
------------------------------
<Accuracies on test> class : 59.15
------------------------------
<Accuracies on photo> test class : 71.38
------------------------------
<Accuracies on cartoon> test class : 54.35
------------------------------
<Accuracies on sketch> test class : 56.81
------------------------------
Total epoch time: 49.438

New epoch - lr: 0.003
[1/28 iteration of epoch 19/30] 
 {loss} cls : 0.044, total : 0.044 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.081, total : 0.081
<Accuracies on train> cls : 97.10
Train epoch time: 12.040
------------------------------
<Accuracies on val> class : 79.81
------------------------------
<Accuracies on test> class : 65.04
------------------------------
<Accuracies on photo> test class : 76.29
------------------------------
<Accuracies on cartoon> test class : 59.73
------------------------------
<Accuracies on sketch> test class : 63.43
------------------------------
Total epoch time: 52.122

New epoch - lr: 0.003
[1/28 iteration of epoch 20/30] 
 {loss} cls : 0.104, total : 0.104 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.085, total : 0.085
<Accuracies on train> cls : 96.65
Train epoch time: 12.378
------------------------------
<Accuracies on val> class : 78.85
------------------------------
<Accuracies on test> class : 62.09
------------------------------
<Accuracies on photo> test class : 65.45
------------------------------
<Accuracies on cartoon> test class : 60.15
------------------------------
<Accuracies on sketch> test class : 61.82
------------------------------
Total epoch time: 48.729

New epoch - lr: 0.003
[1/28 iteration of epoch 21/30] 
 {loss} cls : 0.093, total : 0.093 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.077, total : 0.077
<Accuracies on train> cls : 97.60
Train epoch time: 11.233
------------------------------
<Accuracies on val> class : 79.33
------------------------------
<Accuracies on test> class : 67.17
------------------------------
<Accuracies on photo> test class : 75.93
------------------------------
<Accuracies on cartoon> test class : 63.48
------------------------------
<Accuracies on sketch> test class : 65.64
------------------------------
Total epoch time: 47.556

New epoch - lr: 0.003
[1/28 iteration of epoch 22/30] 
 {loss} cls : 0.196, total : 0.196 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.073, total : 0.073
<Accuracies on train> cls : 97.43
Train epoch time: 11.323
------------------------------
<Accuracies on val> class : 74.52
------------------------------
<Accuracies on test> class : 65.96
------------------------------
<Accuracies on photo> test class : 74.85
------------------------------
<Accuracies on cartoon> test class : 58.66
------------------------------
<Accuracies on sketch> test class : 66.53
------------------------------
Total epoch time: 48.905

New epoch - lr: 0.003
[1/28 iteration of epoch 23/30] 
 {loss} cls : 0.084, total : 0.084 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.078, total : 0.078
<Accuracies on train> cls : 97.43
Train epoch time: 10.656
------------------------------
<Accuracies on val> class : 78.85
------------------------------
<Accuracies on test> class : 67.17
------------------------------
<Accuracies on photo> test class : 76.17
------------------------------
<Accuracies on cartoon> test class : 62.33
------------------------------
<Accuracies on sketch> test class : 66.23
------------------------------
Total epoch time: 52.263

New epoch - lr: 0.003
[1/28 iteration of epoch 24/30] 
 {loss} cls : 0.137, total : 0.137 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.053, total : 0.053
<Accuracies on train> cls : 97.88
Train epoch time: 11.386
------------------------------
<Accuracies on val> class : 73.56
------------------------------
<Accuracies on test> class : 66.31
------------------------------
<Accuracies on photo> test class : 76.71
------------------------------
<Accuracies on cartoon> test class : 62.41
------------------------------
<Accuracies on sketch> test class : 64.21
------------------------------
Total epoch time: 52.160

New epoch - lr: 0.003
[1/28 iteration of epoch 25/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.044, total : 0.044
<Accuracies on train> cls : 98.49
Train epoch time: 11.775
------------------------------
<Accuracies on val> class : 75.96
------------------------------
<Accuracies on test> class : 66.30
------------------------------
<Accuracies on photo> test class : 79.22
------------------------------
<Accuracies on cartoon> test class : 58.70
------------------------------
<Accuracies on sketch> test class : 65.33
------------------------------
Total epoch time: 51.955

New epoch - lr: 0.003
[1/28 iteration of epoch 26/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.047, total : 0.047
<Accuracies on train> cls : 98.49
Train epoch time: 13.101
------------------------------
<Accuracies on val> class : 75.96
------------------------------
<Accuracies on test> class : 62.72
------------------------------
<Accuracies on photo> test class : 76.89
------------------------------
<Accuracies on cartoon> test class : 56.14
------------------------------
<Accuracies on sketch> test class : 60.63
------------------------------
Total epoch time: 53.529

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 27/30] 
 {loss} cls : 0.032, total : 0.032 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.037, total : 0.037
<Accuracies on train> cls : 99.00
Train epoch time: 13.239
------------------------------
<Accuracies on val> class : 77.88
------------------------------
<Accuracies on test> class : 66.18
------------------------------
<Accuracies on photo> test class : 78.02
------------------------------
<Accuracies on cartoon> test class : 59.43
------------------------------
<Accuracies on sketch> test class : 65.18
------------------------------
Total epoch time: 49.331

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 28/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.11
Train epoch time: 13.607
------------------------------
<Accuracies on val> class : 79.33
------------------------------
<Accuracies on test> class : 66.07
------------------------------
<Accuracies on photo> test class : 79.22
------------------------------
<Accuracies on cartoon> test class : 60.49
------------------------------
<Accuracies on sketch> test class : 63.81
------------------------------
Total epoch time: 52.979

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 29/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.031, total : 0.031
<Accuracies on train> cls : 99.05
Train epoch time: 14.405
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 67.29
------------------------------
<Accuracies on photo> test class : 78.98
------------------------------
<Accuracies on cartoon> test class : 60.20
------------------------------
<Accuracies on sketch> test class : 66.56
------------------------------
Total epoch time: 49.630

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 30/30] 
 {loss} cls : 0.025, total : 0.025 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.33
Train epoch time: 12.151
------------------------------
<Accuracies on val> class : 79.81
------------------------------
<Accuracies on test> class : 66.50
------------------------------
<Accuracies on photo> test class : 78.20
------------------------------
<Accuracies on cartoon> test class : 60.92
------------------------------
<Accuracies on sketch> test class : 64.85
------------------------------
Total epoch time: 43.598

******************************
Best val 0.798077, corresponding test 0.664988 - best test: 0.67292

******************************
Best val 0.7980769276618958, corresponding photo test 0.7820359468460083

******************************
Best val 0.7980769276618958, corresponding cartoon test 0.6092150211334229

******************************
Best val 0.7980769276618958, corresponding sketch test 0.6485110521316528
