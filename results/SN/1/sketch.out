WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/55 iteration of epoch 1/30] 
 {loss} cls : 2.070, total : 2.070 
 {acc} cls : 17.19
[31/55 iteration of epoch 1/30] 
 {loss} cls : 0.742, total : 0.742 
 {acc} cls : 76.56
------------------------------
<Losses on train> cls : 2.036, total : 2.036
<Accuracies on train> cls : 59.80
Train epoch time: 18.271
------------------------------
<Accuracies on val> class : 79.40
------------------------------
<Accuracies on test> class : 26.10
------------------------------
<Accuracies on photo> test class : 18.02
------------------------------
<Accuracies on cartoon> test class : 41.68
------------------------------
<Accuracies on art_painting> test class : 14.84
------------------------------
Total epoch time: 51.867

New epoch - lr: 0.003
[1/55 iteration of epoch 2/30] 
 {loss} cls : 0.547, total : 0.547 
 {acc} cls : 76.56
[31/55 iteration of epoch 2/30] 
 {loss} cls : 0.331, total : 0.331 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.431, total : 0.431
<Accuracies on train> cls : 84.12
Train epoch time: 18.504
------------------------------
<Accuracies on val> class : 83.92
------------------------------
<Accuracies on test> class : 27.90
------------------------------
<Accuracies on photo> test class : 16.53
------------------------------
<Accuracies on cartoon> test class : 44.45
------------------------------
<Accuracies on art_painting> test class : 18.21
------------------------------
Total epoch time: 50.558

New epoch - lr: 0.003
[1/55 iteration of epoch 3/30] 
 {loss} cls : 0.373, total : 0.373 
 {acc} cls : 85.94
[31/55 iteration of epoch 3/30] 
 {loss} cls : 0.186, total : 0.186 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.276, total : 0.276
<Accuracies on train> cls : 90.62
Train epoch time: 16.819
------------------------------
<Accuracies on val> class : 91.21
------------------------------
<Accuracies on test> class : 33.88
------------------------------
<Accuracies on photo> test class : 29.64
------------------------------
<Accuracies on cartoon> test class : 45.95
------------------------------
<Accuracies on art_painting> test class : 23.54
------------------------------
Total epoch time: 48.854

New epoch - lr: 0.003
[1/55 iteration of epoch 4/30] 
 {loss} cls : 0.118, total : 0.118 
 {acc} cls : 95.31
[31/55 iteration of epoch 4/30] 
 {loss} cls : 0.191, total : 0.191 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.185, total : 0.185
<Accuracies on train> cls : 93.35
Train epoch time: 16.679
------------------------------
<Accuracies on val> class : 86.43
------------------------------
<Accuracies on test> class : 33.97
------------------------------
<Accuracies on photo> test class : 26.23
------------------------------
<Accuracies on cartoon> test class : 48.21
------------------------------
<Accuracies on art_painting> test class : 23.97
------------------------------
Total epoch time: 48.751

New epoch - lr: 0.003
[1/55 iteration of epoch 5/30] 
 {loss} cls : 0.201, total : 0.201 
 {acc} cls : 92.19
[31/55 iteration of epoch 5/30] 
 {loss} cls : 0.108, total : 0.108 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.156, total : 0.156
<Accuracies on train> cls : 94.20
Train epoch time: 15.729
------------------------------
<Accuracies on val> class : 90.45
------------------------------
<Accuracies on test> class : 35.04
------------------------------
<Accuracies on photo> test class : 27.78
------------------------------
<Accuracies on cartoon> test class : 47.61
------------------------------
<Accuracies on art_painting> test class : 26.56
------------------------------
Total epoch time: 49.086

New epoch - lr: 0.003
[1/55 iteration of epoch 6/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 100.00
[31/55 iteration of epoch 6/30] 
 {loss} cls : 0.067, total : 0.067 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.123, total : 0.123
<Accuracies on train> cls : 95.45
Train epoch time: 15.376
------------------------------
<Accuracies on val> class : 91.21
------------------------------
<Accuracies on test> class : 40.20
------------------------------
<Accuracies on photo> test class : 30.54
------------------------------
<Accuracies on cartoon> test class : 52.65
------------------------------
<Accuracies on art_painting> test class : 33.84
------------------------------
Total epoch time: 50.550

New epoch - lr: 0.003
[1/55 iteration of epoch 7/30] 
 {loss} cls : 0.096, total : 0.096 
 {acc} cls : 95.31
[31/55 iteration of epoch 7/30] 
 {loss} cls : 0.098, total : 0.098 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.087, total : 0.087
<Accuracies on train> cls : 97.19
Train epoch time: 15.325
------------------------------
<Accuracies on val> class : 90.95
------------------------------
<Accuracies on test> class : 32.93
------------------------------
<Accuracies on photo> test class : 23.53
------------------------------
<Accuracies on cartoon> test class : 47.99
------------------------------
<Accuracies on art_painting> test class : 23.34
------------------------------
Total epoch time: 48.248

New epoch - lr: 0.003
[1/55 iteration of epoch 8/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
[31/55 iteration of epoch 8/30] 
 {loss} cls : 0.159, total : 0.159 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.066, total : 0.066
<Accuracies on train> cls : 97.81
Train epoch time: 15.559
------------------------------
<Accuracies on val> class : 91.46
------------------------------
<Accuracies on test> class : 34.61
------------------------------
<Accuracies on photo> test class : 27.78
------------------------------
<Accuracies on cartoon> test class : 48.08
------------------------------
<Accuracies on art_painting> test class : 24.76
------------------------------
Total epoch time: 50.840

New epoch - lr: 0.003
[1/55 iteration of epoch 9/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 100.00
[31/55 iteration of epoch 9/30] 
 {loss} cls : 0.103, total : 0.103 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.061, total : 0.061
<Accuracies on train> cls : 97.90
Train epoch time: 15.040
------------------------------
<Accuracies on val> class : 92.46
------------------------------
<Accuracies on test> class : 36.46
------------------------------
<Accuracies on photo> test class : 30.06
------------------------------
<Accuracies on cartoon> test class : 50.09
------------------------------
<Accuracies on art_painting> test class : 26.07
------------------------------
Total epoch time: 49.564

New epoch - lr: 0.003
[1/55 iteration of epoch 10/30] 
 {loss} cls : 0.024, total : 0.024 
 {acc} cls : 98.44
[31/55 iteration of epoch 10/30] 
 {loss} cls : 0.096, total : 0.096 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.062, total : 0.062
<Accuracies on train> cls : 97.87
Train epoch time: 15.240
------------------------------
<Accuracies on val> class : 90.95
------------------------------
<Accuracies on test> class : 39.13
------------------------------
<Accuracies on photo> test class : 32.22
------------------------------
<Accuracies on cartoon> test class : 52.35
------------------------------
<Accuracies on art_painting> test class : 29.64
------------------------------
Total epoch time: 49.783

New epoch - lr: 0.003
[1/55 iteration of epoch 11/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 100.00
[31/55 iteration of epoch 11/30] 
 {loss} cls : 0.057, total : 0.057 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.050, total : 0.050
<Accuracies on train> cls : 98.04
Train epoch time: 15.264
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 36.85
------------------------------
<Accuracies on photo> test class : 29.58
------------------------------
<Accuracies on cartoon> test class : 47.91
------------------------------
<Accuracies on art_painting> test class : 30.13
------------------------------
Total epoch time: 51.801

New epoch - lr: 0.003
[1/55 iteration of epoch 12/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 100.00
[31/55 iteration of epoch 12/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.047, total : 0.047
<Accuracies on train> cls : 98.55
Train epoch time: 16.270
------------------------------
<Accuracies on val> class : 92.21
------------------------------
<Accuracies on test> class : 39.44
------------------------------
<Accuracies on photo> test class : 34.91
------------------------------
<Accuracies on cartoon> test class : 49.96
------------------------------
<Accuracies on art_painting> test class : 31.10
------------------------------
Total epoch time: 52.659

New epoch - lr: 0.003
[1/55 iteration of epoch 13/30] 
 {loss} cls : 0.032, total : 0.032 
 {acc} cls : 100.00
[31/55 iteration of epoch 13/30] 
 {loss} cls : 0.065, total : 0.065 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.032, total : 0.032
<Accuracies on train> cls : 98.92
Train epoch time: 16.934
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 36.82
------------------------------
<Accuracies on photo> test class : 30.96
------------------------------
<Accuracies on cartoon> test class : 49.62
------------------------------
<Accuracies on art_painting> test class : 26.95
------------------------------
Total epoch time: 51.168

New epoch - lr: 0.003
[1/55 iteration of epoch 14/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/55 iteration of epoch 14/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.037, total : 0.037
<Accuracies on train> cls : 98.64
Train epoch time: 17.839
------------------------------
<Accuracies on val> class : 93.47
------------------------------
<Accuracies on test> class : 33.95
------------------------------
<Accuracies on photo> test class : 25.15
------------------------------
<Accuracies on cartoon> test class : 50.21
------------------------------
<Accuracies on art_painting> test class : 22.51
------------------------------
Total epoch time: 52.683

New epoch - lr: 0.003
[1/55 iteration of epoch 15/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 100.00
[31/55 iteration of epoch 15/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.09
Train epoch time: 17.351
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 39.44
------------------------------
<Accuracies on photo> test class : 32.75
------------------------------
<Accuracies on cartoon> test class : 52.30
------------------------------
<Accuracies on art_painting> test class : 30.18
------------------------------
Total epoch time: 53.583

New epoch - lr: 0.003
[1/55 iteration of epoch 16/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
[31/55 iteration of epoch 16/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 99.01
Train epoch time: 18.173
------------------------------
<Accuracies on val> class : 93.47
------------------------------
<Accuracies on test> class : 35.22
------------------------------
<Accuracies on photo> test class : 23.89
------------------------------
<Accuracies on cartoon> test class : 52.26
------------------------------
<Accuracies on art_painting> test class : 24.95
------------------------------
Total epoch time: 52.011

New epoch - lr: 0.003
[1/55 iteration of epoch 17/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/55 iteration of epoch 17/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 98.98
Train epoch time: 17.985
------------------------------
<Accuracies on val> class : 92.21
------------------------------
<Accuracies on test> class : 35.43
------------------------------
<Accuracies on photo> test class : 23.83
------------------------------
<Accuracies on cartoon> test class : 53.67
------------------------------
<Accuracies on art_painting> test class : 24.02
------------------------------
Total epoch time: 50.104

New epoch - lr: 0.003
[1/55 iteration of epoch 18/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/55 iteration of epoch 18/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.43
Train epoch time: 19.357
------------------------------
<Accuracies on val> class : 91.96
------------------------------
<Accuracies on test> class : 38.47
------------------------------
<Accuracies on photo> test class : 31.14
------------------------------
<Accuracies on cartoon> test class : 52.35
------------------------------
<Accuracies on art_painting> test class : 28.56
------------------------------
Total epoch time: 49.570

New epoch - lr: 0.003
[1/55 iteration of epoch 19/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
[31/55 iteration of epoch 19/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.35
Train epoch time: 19.220
------------------------------
<Accuracies on val> class : 91.46
------------------------------
<Accuracies on test> class : 36.82
------------------------------
<Accuracies on photo> test class : 27.07
------------------------------
<Accuracies on cartoon> test class : 53.37
------------------------------
<Accuracies on art_painting> test class : 25.83
------------------------------
Total epoch time: 47.580

New epoch - lr: 0.003
[1/55 iteration of epoch 20/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
[31/55 iteration of epoch 20/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 98.84
Train epoch time: 17.513
------------------------------
<Accuracies on val> class : 91.96
------------------------------
<Accuracies on test> class : 36.74
------------------------------
<Accuracies on photo> test class : 29.82
------------------------------
<Accuracies on cartoon> test class : 50.30
------------------------------
<Accuracies on art_painting> test class : 26.86
------------------------------
Total epoch time: 46.781

New epoch - lr: 0.003
[1/55 iteration of epoch 21/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 100.00
[31/55 iteration of epoch 21/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.40
Train epoch time: 17.150
------------------------------
<Accuracies on val> class : 92.46
------------------------------
<Accuracies on test> class : 38.09
------------------------------
<Accuracies on photo> test class : 32.69
------------------------------
<Accuracies on cartoon> test class : 49.27
------------------------------
<Accuracies on art_painting> test class : 29.69
------------------------------
Total epoch time: 52.302

New epoch - lr: 0.003
[1/55 iteration of epoch 22/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
[31/55 iteration of epoch 22/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.60
Train epoch time: 18.253
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 37.81
------------------------------
<Accuracies on photo> test class : 29.28
------------------------------
<Accuracies on cartoon> test class : 52.13
------------------------------
<Accuracies on art_painting> test class : 28.37
------------------------------
Total epoch time: 51.605

New epoch - lr: 0.003
[1/55 iteration of epoch 23/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
[31/55 iteration of epoch 23/30] 
 {loss} cls : 0.038, total : 0.038 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.60
Train epoch time: 17.456
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 39.52
------------------------------
<Accuracies on photo> test class : 31.80
------------------------------
<Accuracies on cartoon> test class : 53.03
------------------------------
<Accuracies on art_painting> test class : 30.37
------------------------------
Total epoch time: 49.394

New epoch - lr: 0.003
[1/55 iteration of epoch 24/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
[31/55 iteration of epoch 24/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.52
Train epoch time: 17.260
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 37.68
------------------------------
<Accuracies on photo> test class : 28.68
------------------------------
<Accuracies on cartoon> test class : 52.73
------------------------------
<Accuracies on art_painting> test class : 27.78
------------------------------
Total epoch time: 50.661

New epoch - lr: 0.003
[1/55 iteration of epoch 25/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/55 iteration of epoch 25/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.32
Train epoch time: 18.621
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 39.79
------------------------------
<Accuracies on photo> test class : 32.99
------------------------------
<Accuracies on cartoon> test class : 53.58
------------------------------
<Accuracies on art_painting> test class : 29.54
------------------------------
Total epoch time: 50.978

New epoch - lr: 0.003
[1/55 iteration of epoch 26/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
[31/55 iteration of epoch 26/30] 
 {loss} cls : 0.042, total : 0.042 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.46
Train epoch time: 17.660
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 37.12
------------------------------
<Accuracies on photo> test class : 30.12
------------------------------
<Accuracies on cartoon> test class : 51.11
------------------------------
<Accuracies on art_painting> test class : 26.81
------------------------------
Total epoch time: 50.178

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 27/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/55 iteration of epoch 27/30] 
 {loss} cls : 0.076, total : 0.076 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.83
Train epoch time: 18.511
------------------------------
<Accuracies on val> class : 91.96
------------------------------
<Accuracies on test> class : 37.35
------------------------------
<Accuracies on photo> test class : 29.82
------------------------------
<Accuracies on cartoon> test class : 53.07
------------------------------
<Accuracies on art_painting> test class : 25.49
------------------------------
Total epoch time: 49.616

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 28/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
[31/55 iteration of epoch 28/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.77
Train epoch time: 18.942
------------------------------
<Accuracies on val> class : 91.71
------------------------------
<Accuracies on test> class : 37.78
------------------------------
<Accuracies on photo> test class : 31.08
------------------------------
<Accuracies on cartoon> test class : 52.60
------------------------------
<Accuracies on art_painting> test class : 26.27
------------------------------
Total epoch time: 49.126

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 29/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
[31/55 iteration of epoch 29/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.69
Train epoch time: 16.462
------------------------------
<Accuracies on val> class : 92.71
------------------------------
<Accuracies on test> class : 37.51
------------------------------
<Accuracies on photo> test class : 30.96
------------------------------
<Accuracies on cartoon> test class : 52.26
------------------------------
<Accuracies on art_painting> test class : 25.98
------------------------------
Total epoch time: 43.405

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 30/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
[31/55 iteration of epoch 30/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.69
Train epoch time: 15.150
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 37.18
------------------------------
<Accuracies on photo> test class : 29.34
------------------------------
<Accuracies on cartoon> test class : 53.20
------------------------------
<Accuracies on art_painting> test class : 25.24
------------------------------
Total epoch time: 42.119

******************************
Best val 0.937186, corresponding test 0.376773 - best test: 0.402013

******************************
Best val 0.9371859431266785, corresponding photo test 0.28682634234428406

******************************
Best val 0.9371859431266785, corresponding cartoon test 0.5273037552833557

******************************
Best val 0.9371859431266785, corresponding art_painting test 0.27783203125
