WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.124, total : 2.124 
 {acc} cls : 14.06
------------------------------
<Losses on train> cls : 2.299, total : 2.299
<Accuracies on train> cls : 47.28
Train epoch time: 12.428
------------------------------
<Accuracies on val> class : 65.50
------------------------------
<Accuracies on test> class : 27.10
------------------------------
<Accuracies on cartoon> test class : 24.53
------------------------------
<Accuracies on art_painting> test class : 28.42
------------------------------
<Accuracies on sketch> test class : 27.95
------------------------------
Total epoch time: 54.552

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.786, total : 0.786 
 {acc} cls : 70.31
------------------------------
<Losses on train> cls : 0.662, total : 0.662
<Accuracies on train> cls : 76.49
Train epoch time: 12.978
------------------------------
<Accuracies on val> class : 75.44
------------------------------
<Accuracies on test> class : 27.91
------------------------------
<Accuracies on cartoon> test class : 26.96
------------------------------
<Accuracies on art_painting> test class : 32.76
------------------------------
<Accuracies on sketch> test class : 25.94
------------------------------
Total epoch time: 53.855

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.316, total : 0.316 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.454, total : 0.454
<Accuracies on train> cls : 83.70
Train epoch time: 11.753
------------------------------
<Accuracies on val> class : 80.70
------------------------------
<Accuracies on test> class : 31.93
------------------------------
<Accuracies on cartoon> test class : 26.75
------------------------------
<Accuracies on art_painting> test class : 35.84
------------------------------
<Accuracies on sketch> test class : 32.99
------------------------------
Total epoch time: 51.628

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.493, total : 0.493 
 {acc} cls : 82.81
------------------------------
<Losses on train> cls : 0.398, total : 0.398
<Accuracies on train> cls : 85.33
Train epoch time: 11.698
------------------------------
<Accuracies on val> class : 85.96
------------------------------
<Accuracies on test> class : 41.82
------------------------------
<Accuracies on cartoon> test class : 38.99
------------------------------
<Accuracies on art_painting> test class : 38.43
------------------------------
<Accuracies on sketch> test class : 45.28
------------------------------
Total epoch time: 52.955

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.243, total : 0.243 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.289, total : 0.289
<Accuracies on train> cls : 89.67
Train epoch time: 10.818
------------------------------
<Accuracies on val> class : 86.55
------------------------------
<Accuracies on test> class : 32.59
------------------------------
<Accuracies on cartoon> test class : 28.11
------------------------------
<Accuracies on art_painting> test class : 37.70
------------------------------
<Accuracies on sketch> test class : 32.60
------------------------------
Total epoch time: 53.306

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.132, total : 0.132 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.224, total : 0.224
<Accuracies on train> cls : 92.46
Train epoch time: 10.591
------------------------------
<Accuracies on val> class : 81.87
------------------------------
<Accuracies on test> class : 31.16
------------------------------
<Accuracies on cartoon> test class : 27.43
------------------------------
<Accuracies on art_painting> test class : 44.82
------------------------------
<Accuracies on sketch> test class : 26.27
------------------------------
Total epoch time: 52.349

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.087, total : 0.087 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.152, total : 0.152
<Accuracies on train> cls : 94.70
Train epoch time: 10.796
------------------------------
<Accuracies on val> class : 85.96
------------------------------
<Accuracies on test> class : 39.69
------------------------------
<Accuracies on cartoon> test class : 37.71
------------------------------
<Accuracies on art_painting> test class : 40.04
------------------------------
<Accuracies on sketch> test class : 40.70
------------------------------
Total epoch time: 51.220

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.124, total : 0.124 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.150, total : 0.150
<Accuracies on train> cls : 94.63
Train epoch time: 12.035
------------------------------
<Accuracies on val> class : 84.80
------------------------------
<Accuracies on test> class : 31.81
------------------------------
<Accuracies on cartoon> test class : 32.98
------------------------------
<Accuracies on art_painting> test class : 44.78
------------------------------
<Accuracies on sketch> test class : 24.36
------------------------------
Total epoch time: 52.830

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.073, total : 0.073 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.125, total : 0.125
<Accuracies on train> cls : 95.79
Train epoch time: 11.608
------------------------------
<Accuracies on val> class : 85.38
------------------------------
<Accuracies on test> class : 35.12
------------------------------
<Accuracies on cartoon> test class : 32.59
------------------------------
<Accuracies on art_painting> test class : 45.31
------------------------------
<Accuracies on sketch> test class : 31.31
------------------------------
Total epoch time: 52.834

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.124, total : 0.124 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.103, total : 0.103
<Accuracies on train> cls : 96.54
Train epoch time: 11.375
------------------------------
<Accuracies on val> class : 85.96
------------------------------
<Accuracies on test> class : 44.95
------------------------------
<Accuracies on cartoon> test class : 39.55
------------------------------
<Accuracies on art_painting> test class : 38.48
------------------------------
<Accuracies on sketch> test class : 51.54
------------------------------
Total epoch time: 55.162

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.083, total : 0.083 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.076, total : 0.076
<Accuracies on train> cls : 97.42
Train epoch time: 11.474
------------------------------
<Accuracies on val> class : 85.96
------------------------------
<Accuracies on test> class : 39.73
------------------------------
<Accuracies on cartoon> test class : 33.11
------------------------------
<Accuracies on art_painting> test class : 46.48
------------------------------
<Accuracies on sketch> test class : 40.16
------------------------------
Total epoch time: 56.681

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.138, total : 0.138 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.058, total : 0.058
<Accuracies on train> cls : 98.03
Train epoch time: 11.589
------------------------------
<Accuracies on val> class : 84.80
------------------------------
<Accuracies on test> class : 39.45
------------------------------
<Accuracies on cartoon> test class : 34.64
------------------------------
<Accuracies on art_painting> test class : 46.83
------------------------------
<Accuracies on sketch> test class : 38.48
------------------------------
Total epoch time: 57.590

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.058, total : 0.058
<Accuracies on train> cls : 97.69
Train epoch time: 10.697
------------------------------
<Accuracies on val> class : 87.13
------------------------------
<Accuracies on test> class : 38.76
------------------------------
<Accuracies on cartoon> test class : 34.47
------------------------------
<Accuracies on art_painting> test class : 43.95
------------------------------
<Accuracies on sketch> test class : 38.61
------------------------------
Total epoch time: 55.812

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.17
Train epoch time: 11.472
------------------------------
<Accuracies on val> class : 85.38
------------------------------
<Accuracies on test> class : 40.09
------------------------------
<Accuracies on cartoon> test class : 37.54
------------------------------
<Accuracies on art_painting> test class : 47.22
------------------------------
<Accuracies on sketch> test class : 37.90
------------------------------
Total epoch time: 54.786

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.047, total : 0.047
<Accuracies on train> cls : 98.44
Train epoch time: 12.500
------------------------------
<Accuracies on val> class : 84.21
------------------------------
<Accuracies on test> class : 40.75
------------------------------
<Accuracies on cartoon> test class : 38.27
------------------------------
<Accuracies on art_painting> test class : 49.32
------------------------------
<Accuracies on sketch> test class : 37.77
------------------------------
Total epoch time: 57.010

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.042, total : 0.042
<Accuracies on train> cls : 98.57
Train epoch time: 11.745
------------------------------
<Accuracies on val> class : 85.96
------------------------------
<Accuracies on test> class : 40.82
------------------------------
<Accuracies on cartoon> test class : 37.71
------------------------------
<Accuracies on art_painting> test class : 48.19
------------------------------
<Accuracies on sketch> test class : 38.84
------------------------------
Total epoch time: 53.817

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.038, total : 0.038 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.035, total : 0.035
<Accuracies on train> cls : 98.57
Train epoch time: 12.484
------------------------------
<Accuracies on val> class : 89.47
------------------------------
<Accuracies on test> class : 38.54
------------------------------
<Accuracies on cartoon> test class : 37.63
------------------------------
<Accuracies on art_painting> test class : 43.99
------------------------------
<Accuracies on sketch> test class : 36.24
------------------------------
Total epoch time: 53.993

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.074, total : 0.074 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.91
Train epoch time: 12.862
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 35.30
------------------------------
<Accuracies on cartoon> test class : 32.72
------------------------------
<Accuracies on art_painting> test class : 47.95
------------------------------
<Accuracies on sketch> test class : 30.24
------------------------------
Total epoch time: 50.915

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.32
Train epoch time: 12.316
------------------------------
<Accuracies on val> class : 87.72
------------------------------
<Accuracies on test> class : 36.81
------------------------------
<Accuracies on cartoon> test class : 33.75
------------------------------
<Accuracies on art_painting> test class : 49.56
------------------------------
<Accuracies on sketch> test class : 31.99
------------------------------
Total epoch time: 51.076

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.036, total : 0.036 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.034, total : 0.034
<Accuracies on train> cls : 98.64
Train epoch time: 12.811
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 32.10
------------------------------
<Accuracies on cartoon> test class : 29.65
------------------------------
<Accuracies on art_painting> test class : 43.65
------------------------------
<Accuracies on sketch> test class : 27.54
------------------------------
Total epoch time: 57.088

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 98.78
Train epoch time: 11.080
------------------------------
<Accuracies on val> class : 91.23
------------------------------
<Accuracies on test> class : 34.82
------------------------------
<Accuracies on cartoon> test class : 30.50
------------------------------
<Accuracies on art_painting> test class : 46.24
------------------------------
<Accuracies on sketch> test class : 31.43
------------------------------
Total epoch time: 55.071

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.026, total : 0.026
<Accuracies on train> cls : 99.12
Train epoch time: 10.345
------------------------------
<Accuracies on val> class : 90.06
------------------------------
<Accuracies on test> class : 32.76
------------------------------
<Accuracies on cartoon> test class : 29.05
------------------------------
<Accuracies on art_painting> test class : 43.41
------------------------------
<Accuracies on sketch> test class : 29.42
------------------------------
Total epoch time: 53.024

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 99.05
Train epoch time: 9.971
------------------------------
<Accuracies on val> class : 87.72
------------------------------
<Accuracies on test> class : 34.01
------------------------------
<Accuracies on cartoon> test class : 31.02
------------------------------
<Accuracies on art_painting> test class : 47.75
------------------------------
<Accuracies on sketch> test class : 28.63
------------------------------
Total epoch time: 54.602

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.12
Train epoch time: 9.824
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 36.55
------------------------------
<Accuracies on cartoon> test class : 32.51
------------------------------
<Accuracies on art_painting> test class : 46.14
------------------------------
<Accuracies on sketch> test class : 33.95
------------------------------
Total epoch time: 53.391

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.18
Train epoch time: 10.081
------------------------------
<Accuracies on val> class : 88.89
------------------------------
<Accuracies on test> class : 39.21
------------------------------
<Accuracies on cartoon> test class : 35.45
------------------------------
<Accuracies on art_painting> test class : 44.04
------------------------------
<Accuracies on sketch> test class : 38.94
------------------------------
Total epoch time: 53.491

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.73
Train epoch time: 10.039
------------------------------
<Accuracies on val> class : 86.55
------------------------------
<Accuracies on test> class : 43.14
------------------------------
<Accuracies on cartoon> test class : 38.40
------------------------------
<Accuracies on art_painting> test class : 47.07
------------------------------
<Accuracies on sketch> test class : 43.93
------------------------------
Total epoch time: 54.166

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.055, total : 0.055 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.59
Train epoch time: 9.926
------------------------------
<Accuracies on val> class : 86.55
------------------------------
<Accuracies on test> class : 41.09
------------------------------
<Accuracies on cartoon> test class : 37.71
------------------------------
<Accuracies on art_painting> test class : 47.17
------------------------------
<Accuracies on sketch> test class : 39.93
------------------------------
Total epoch time: 47.148

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.32
Train epoch time: 9.522
------------------------------
<Accuracies on val> class : 87.72
------------------------------
<Accuracies on test> class : 39.98
------------------------------
<Accuracies on cartoon> test class : 36.82
------------------------------
<Accuracies on art_painting> test class : 46.88
------------------------------
<Accuracies on sketch> test class : 38.28
------------------------------
Total epoch time: 45.380

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.46
Train epoch time: 8.691
------------------------------
<Accuracies on val> class : 88.30
------------------------------
<Accuracies on test> class : 40.67
------------------------------
<Accuracies on cartoon> test class : 36.18
------------------------------
<Accuracies on art_painting> test class : 47.95
------------------------------
<Accuracies on sketch> test class : 39.55
------------------------------
Total epoch time: 40.137

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.86
Train epoch time: 8.530
------------------------------
<Accuracies on val> class : 87.72
------------------------------
<Accuracies on test> class : 38.84
------------------------------
<Accuracies on cartoon> test class : 34.90
------------------------------
<Accuracies on art_painting> test class : 46.92
------------------------------
<Accuracies on sketch> test class : 36.98
------------------------------
Total epoch time: 37.587

******************************
Best val 0.912281, corresponding test 0.348155 - best test: 0.449465

******************************
Best val 0.9122806787490845, corresponding cartoon test 0.3050341308116913

******************************
Best val 0.9122806787490845, corresponding art_painting test 0.46240234375

******************************
Best val 0.9122806787490845, corresponding sketch test 0.3143293559551239
