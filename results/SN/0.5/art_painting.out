WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/28 iteration of epoch 1/30] 
 {loss} cls : 2.178, total : 2.178 
 {acc} cls : 9.38
------------------------------
<Losses on train> cls : 6.288, total : 6.288
<Accuracies on train> cls : 22.82
Train epoch time: 18.171
------------------------------
<Accuracies on val> class : 30.77
------------------------------
<Accuracies on test> class : 23.72
------------------------------
<Accuracies on photo> test class : 47.25
------------------------------
<Accuracies on cartoon> test class : 20.73
------------------------------
<Accuracies on sketch> test class : 15.50
------------------------------
Total epoch time: 61.725

New epoch - lr: 0.003
[1/28 iteration of epoch 2/30] 
 {loss} cls : 2.158, total : 2.158 
 {acc} cls : 43.75
------------------------------
<Losses on train> cls : 1.795, total : 1.795
<Accuracies on train> cls : 46.65
Train epoch time: 14.054
------------------------------
<Accuracies on val> class : 36.06
------------------------------
<Accuracies on test> class : 33.44
------------------------------
<Accuracies on photo> test class : 27.90
------------------------------
<Accuracies on cartoon> test class : 30.55
------------------------------
<Accuracies on sketch> test class : 37.52
------------------------------
Total epoch time: 48.575

New epoch - lr: 0.003
[1/28 iteration of epoch 3/30] 
 {loss} cls : 1.521, total : 1.521 
 {acc} cls : 46.88
------------------------------
<Losses on train> cls : 1.203, total : 1.203
<Accuracies on train> cls : 59.26
Train epoch time: 12.395
------------------------------
<Accuracies on val> class : 62.02
------------------------------
<Accuracies on test> class : 44.67
------------------------------
<Accuracies on photo> test class : 63.89
------------------------------
<Accuracies on cartoon> test class : 47.18
------------------------------
<Accuracies on sketch> test class : 35.00
------------------------------
Total epoch time: 46.084

New epoch - lr: 0.003
[1/28 iteration of epoch 4/30] 
 {loss} cls : 1.007, total : 1.007 
 {acc} cls : 64.06
------------------------------
<Losses on train> cls : 0.890, total : 0.890
<Accuracies on train> cls : 69.98
Train epoch time: 11.461
------------------------------
<Accuracies on val> class : 64.90
------------------------------
<Accuracies on test> class : 44.62
------------------------------
<Accuracies on photo> test class : 64.07
------------------------------
<Accuracies on cartoon> test class : 45.14
------------------------------
<Accuracies on sketch> test class : 36.04
------------------------------
Total epoch time: 43.744

New epoch - lr: 0.003
[1/28 iteration of epoch 5/30] 
 {loss} cls : 0.644, total : 0.644 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.742, total : 0.742
<Accuracies on train> cls : 74.61
Train epoch time: 11.583
------------------------------
<Accuracies on val> class : 68.27
------------------------------
<Accuracies on test> class : 53.13
------------------------------
<Accuracies on photo> test class : 67.07
------------------------------
<Accuracies on cartoon> test class : 51.07
------------------------------
<Accuracies on sketch> test class : 48.43
------------------------------
Total epoch time: 44.390

New epoch - lr: 0.003
[1/28 iteration of epoch 6/30] 
 {loss} cls : 0.481, total : 0.481 
 {acc} cls : 84.38
------------------------------
<Losses on train> cls : 0.566, total : 0.566
<Accuracies on train> cls : 79.91
Train epoch time: 11.212
------------------------------
<Accuracies on val> class : 73.56
------------------------------
<Accuracies on test> class : 58.04
------------------------------
<Accuracies on photo> test class : 73.65
------------------------------
<Accuracies on cartoon> test class : 54.82
------------------------------
<Accuracies on sketch> test class : 53.32
------------------------------
Total epoch time: 44.338

New epoch - lr: 0.003
[1/28 iteration of epoch 7/30] 
 {loss} cls : 0.464, total : 0.464 
 {acc} cls : 84.38
------------------------------
<Losses on train> cls : 0.514, total : 0.514
<Accuracies on train> cls : 81.70
Train epoch time: 11.729
------------------------------
<Accuracies on val> class : 68.75
------------------------------
<Accuracies on test> class : 54.39
------------------------------
<Accuracies on photo> test class : 69.76
------------------------------
<Accuracies on cartoon> test class : 49.62
------------------------------
<Accuracies on sketch> test class : 50.70
------------------------------
Total epoch time: 43.603

New epoch - lr: 0.003
[1/28 iteration of epoch 8/30] 
 {loss} cls : 0.574, total : 0.574 
 {acc} cls : 79.69
------------------------------
<Losses on train> cls : 0.455, total : 0.455
<Accuracies on train> cls : 83.48
Train epoch time: 11.746
------------------------------
<Accuracies on val> class : 70.67
------------------------------
<Accuracies on test> class : 58.49
------------------------------
<Accuracies on photo> test class : 73.41
------------------------------
<Accuracies on cartoon> test class : 54.44
------------------------------
<Accuracies on sketch> test class : 54.57
------------------------------
Total epoch time: 44.518

New epoch - lr: 0.003
[1/28 iteration of epoch 9/30] 
 {loss} cls : 0.339, total : 0.339 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.317, total : 0.317
<Accuracies on train> cls : 89.01
Train epoch time: 12.436
------------------------------
<Accuracies on val> class : 74.04
------------------------------
<Accuracies on test> class : 55.16
------------------------------
<Accuracies on photo> test class : 70.30
------------------------------
<Accuracies on cartoon> test class : 55.46
------------------------------
<Accuracies on sketch> test class : 48.54
------------------------------
Total epoch time: 47.894

New epoch - lr: 0.003
[1/28 iteration of epoch 10/30] 
 {loss} cls : 0.163, total : 0.163 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.325, total : 0.325
<Accuracies on train> cls : 88.84
Train epoch time: 12.541
------------------------------
<Accuracies on val> class : 74.04
------------------------------
<Accuracies on test> class : 63.62
------------------------------
<Accuracies on photo> test class : 77.90
------------------------------
<Accuracies on cartoon> test class : 53.46
------------------------------
<Accuracies on sketch> test class : 63.60
------------------------------
Total epoch time: 47.072

New epoch - lr: 0.003
[1/28 iteration of epoch 11/30] 
 {loss} cls : 0.340, total : 0.340 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.253, total : 0.253
<Accuracies on train> cls : 91.02
Train epoch time: 13.378
------------------------------
<Accuracies on val> class : 74.04
------------------------------
<Accuracies on test> class : 59.80
------------------------------
<Accuracies on photo> test class : 70.96
------------------------------
<Accuracies on cartoon> test class : 56.87
------------------------------
<Accuracies on sketch> test class : 56.81
------------------------------
Total epoch time: 46.862

New epoch - lr: 0.003
[1/28 iteration of epoch 12/30] 
 {loss} cls : 0.239, total : 0.239 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.240, total : 0.240
<Accuracies on train> cls : 91.41
Train epoch time: 12.913
------------------------------
<Accuracies on val> class : 75.00
------------------------------
<Accuracies on test> class : 64.52
------------------------------
<Accuracies on photo> test class : 77.66
------------------------------
<Accuracies on cartoon> test class : 60.45
------------------------------
<Accuracies on sketch> test class : 61.36
------------------------------
Total epoch time: 45.216

New epoch - lr: 0.003
[1/28 iteration of epoch 13/30] 
 {loss} cls : 0.236, total : 0.236 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.160, total : 0.160
<Accuracies on train> cls : 94.14
Train epoch time: 12.917
------------------------------
<Accuracies on val> class : 75.48
------------------------------
<Accuracies on test> class : 62.26
------------------------------
<Accuracies on photo> test class : 76.71
------------------------------
<Accuracies on cartoon> test class : 55.16
------------------------------
<Accuracies on sketch> test class : 60.35
------------------------------
Total epoch time: 45.807

New epoch - lr: 0.003
[1/28 iteration of epoch 14/30] 
 {loss} cls : 0.067, total : 0.067 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.130, total : 0.130
<Accuracies on train> cls : 94.92
Train epoch time: 11.414
------------------------------
<Accuracies on val> class : 76.44
------------------------------
<Accuracies on test> class : 64.64
------------------------------
<Accuracies on photo> test class : 78.02
------------------------------
<Accuracies on cartoon> test class : 57.64
------------------------------
<Accuracies on sketch> test class : 63.12
------------------------------
Total epoch time: 44.285

New epoch - lr: 0.003
[1/28 iteration of epoch 15/30] 
 {loss} cls : 0.133, total : 0.133 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.120, total : 0.120
<Accuracies on train> cls : 95.98
Train epoch time: 11.362
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 66.06
------------------------------
<Accuracies on photo> test class : 75.69
------------------------------
<Accuracies on cartoon> test class : 62.84
------------------------------
<Accuracies on sketch> test class : 63.88
------------------------------
Total epoch time: 44.422

New epoch - lr: 0.003
[1/28 iteration of epoch 16/30] 
 {loss} cls : 0.068, total : 0.068 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.098, total : 0.098
<Accuracies on train> cls : 96.71
Train epoch time: 11.313
------------------------------
<Accuracies on val> class : 73.08
------------------------------
<Accuracies on test> class : 59.90
------------------------------
<Accuracies on photo> test class : 77.78
------------------------------
<Accuracies on cartoon> test class : 53.50
------------------------------
<Accuracies on sketch> test class : 56.12
------------------------------
Total epoch time: 42.562

New epoch - lr: 0.003
[1/28 iteration of epoch 17/30] 
 {loss} cls : 0.083, total : 0.083 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.097, total : 0.097
<Accuracies on train> cls : 96.54
Train epoch time: 11.303
------------------------------
<Accuracies on val> class : 73.56
------------------------------
<Accuracies on test> class : 63.48
------------------------------
<Accuracies on photo> test class : 77.07
------------------------------
<Accuracies on cartoon> test class : 58.75
------------------------------
<Accuracies on sketch> test class : 60.52
------------------------------
Total epoch time: 43.009

New epoch - lr: 0.003
[1/28 iteration of epoch 18/30] 
 {loss} cls : 0.091, total : 0.091 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.074, total : 0.074
<Accuracies on train> cls : 97.38
Train epoch time: 11.938
------------------------------
<Accuracies on val> class : 75.48
------------------------------
<Accuracies on test> class : 62.97
------------------------------
<Accuracies on photo> test class : 76.65
------------------------------
<Accuracies on cartoon> test class : 60.28
------------------------------
<Accuracies on sketch> test class : 58.77
------------------------------
Total epoch time: 45.735

New epoch - lr: 0.003
[1/28 iteration of epoch 19/30] 
 {loss} cls : 0.114, total : 0.114 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.085, total : 0.085
<Accuracies on train> cls : 97.43
Train epoch time: 11.828
------------------------------
<Accuracies on val> class : 75.48
------------------------------
<Accuracies on test> class : 64.09
------------------------------
<Accuracies on photo> test class : 78.32
------------------------------
<Accuracies on cartoon> test class : 58.58
------------------------------
<Accuracies on sketch> test class : 61.34
------------------------------
Total epoch time: 45.735

New epoch - lr: 0.003
[1/28 iteration of epoch 20/30] 
 {loss} cls : 0.040, total : 0.040 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.058, total : 0.058
<Accuracies on train> cls : 97.99
Train epoch time: 11.512
------------------------------
<Accuracies on val> class : 77.88
------------------------------
<Accuracies on test> class : 64.91
------------------------------
<Accuracies on photo> test class : 79.52
------------------------------
<Accuracies on cartoon> test class : 60.75
------------------------------
<Accuracies on sketch> test class : 61.19
------------------------------
Total epoch time: 44.838

New epoch - lr: 0.003
[1/28 iteration of epoch 21/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.059, total : 0.059
<Accuracies on train> cls : 97.94
Train epoch time: 11.625
------------------------------
<Accuracies on val> class : 75.00
------------------------------
<Accuracies on test> class : 62.57
------------------------------
<Accuracies on photo> test class : 76.41
------------------------------
<Accuracies on cartoon> test class : 55.59
------------------------------
<Accuracies on sketch> test class : 60.86
------------------------------
Total epoch time: 43.311

New epoch - lr: 0.003
[1/28 iteration of epoch 22/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.066, total : 0.066
<Accuracies on train> cls : 97.60
Train epoch time: 12.058
------------------------------
<Accuracies on val> class : 76.44
------------------------------
<Accuracies on test> class : 63.12
------------------------------
<Accuracies on photo> test class : 75.45
------------------------------
<Accuracies on cartoon> test class : 57.47
------------------------------
<Accuracies on sketch> test class : 61.26
------------------------------
Total epoch time: 43.348

New epoch - lr: 0.003
[1/28 iteration of epoch 23/30] 
 {loss} cls : 0.024, total : 0.024 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.055, total : 0.055
<Accuracies on train> cls : 98.55
Train epoch time: 12.112
------------------------------
<Accuracies on val> class : 74.52
------------------------------
<Accuracies on test> class : 64.75
------------------------------
<Accuracies on photo> test class : 77.31
------------------------------
<Accuracies on cartoon> test class : 57.72
------------------------------
<Accuracies on sketch> test class : 63.60
------------------------------
Total epoch time: 42.782

New epoch - lr: 0.003
[1/28 iteration of epoch 24/30] 
 {loss} cls : 0.075, total : 0.075 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 97.99
Train epoch time: 12.012
------------------------------
<Accuracies on val> class : 76.92
------------------------------
<Accuracies on test> class : 66.22
------------------------------
<Accuracies on photo> test class : 79.04
------------------------------
<Accuracies on cartoon> test class : 60.03
------------------------------
<Accuracies on sketch> test class : 64.47
------------------------------
Total epoch time: 43.550

New epoch - lr: 0.003
[1/28 iteration of epoch 25/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.058, total : 0.058
<Accuracies on train> cls : 98.38
Train epoch time: 12.156
------------------------------
<Accuracies on val> class : 76.44
------------------------------
<Accuracies on test> class : 65.25
------------------------------
<Accuracies on photo> test class : 79.52
------------------------------
<Accuracies on cartoon> test class : 59.43
------------------------------
<Accuracies on sketch> test class : 62.66
------------------------------
Total epoch time: 44.742

New epoch - lr: 0.003
[1/28 iteration of epoch 26/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 99.00
Train epoch time: 11.661
------------------------------
<Accuracies on val> class : 80.77
------------------------------
<Accuracies on test> class : 66.65
------------------------------
<Accuracies on photo> test class : 78.62
------------------------------
<Accuracies on cartoon> test class : 60.28
------------------------------
<Accuracies on sketch> test class : 65.36
------------------------------
Total epoch time: 47.055

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 27/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.047, total : 0.047
<Accuracies on train> cls : 98.55
Train epoch time: 10.905
------------------------------
<Accuracies on val> class : 79.81
------------------------------
<Accuracies on test> class : 66.69
------------------------------
<Accuracies on photo> test class : 78.62
------------------------------
<Accuracies on cartoon> test class : 61.22
------------------------------
<Accuracies on sketch> test class : 64.88
------------------------------
Total epoch time: 46.451

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 28/30] 
 {loss} cls : 0.043, total : 0.043 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.041, total : 0.041
<Accuracies on train> cls : 98.66
Train epoch time: 10.717
------------------------------
<Accuracies on val> class : 79.33
------------------------------
<Accuracies on test> class : 67.10
------------------------------
<Accuracies on photo> test class : 80.00
------------------------------
<Accuracies on cartoon> test class : 59.00
------------------------------
<Accuracies on sketch> test class : 66.45
------------------------------
Total epoch time: 43.070

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 29/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.025, total : 0.025
<Accuracies on train> cls : 99.05
Train epoch time: 10.860
------------------------------
<Accuracies on val> class : 81.25
------------------------------
<Accuracies on test> class : 67.15
------------------------------
<Accuracies on photo> test class : 80.60
------------------------------
<Accuracies on cartoon> test class : 60.03
------------------------------
<Accuracies on sketch> test class : 65.69
------------------------------
Total epoch time: 41.802

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 30/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.16
Train epoch time: 10.677
------------------------------
<Accuracies on val> class : 78.85
------------------------------
<Accuracies on test> class : 67.33
------------------------------
<Accuracies on photo> test class : 80.90
------------------------------
<Accuracies on cartoon> test class : 60.03
------------------------------
<Accuracies on sketch> test class : 65.92
------------------------------
Total epoch time: 41.145

******************************
Best val 0.8125, corresponding test 0.671535 - best test: 0.673297

******************************
Best val 0.8125, corresponding photo test 0.8059880137443542

******************************
Best val 0.8125, corresponding cartoon test 0.6002559661865234

******************************
Best val 0.8125, corresponding sketch test 0.6569101810455322
