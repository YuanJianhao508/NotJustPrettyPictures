WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/32 iteration of epoch 1/30] 
 {loss} cls : 2.089, total : 2.089 
 {acc} cls : 12.50
[31/32 iteration of epoch 1/30] 
 {loss} cls : 1.490, total : 1.490 
 {acc} cls : 65.62
------------------------------
<Losses on train> cls : 2.520, total : 2.520
<Accuracies on train> cls : 39.01
Train epoch time: 18.700
------------------------------
<Accuracies on val> class : 61.18
------------------------------
<Accuracies on test> class : 37.19
------------------------------
<Accuracies on photo> test class : 44.55
------------------------------
<Accuracies on art_painting> test class : 29.20
------------------------------
<Accuracies on sketch> test class : 38.23
------------------------------
Total epoch time: 61.457

New epoch - lr: 0.003
[1/32 iteration of epoch 2/30] 
 {loss} cls : 1.384, total : 1.384 
 {acc} cls : 60.94
[31/32 iteration of epoch 2/30] 
 {loss} cls : 0.786, total : 0.786 
 {acc} cls : 73.44
------------------------------
<Losses on train> cls : 0.916, total : 0.916
<Accuracies on train> cls : 70.51
Train epoch time: 13.405
------------------------------
<Accuracies on val> class : 70.89
------------------------------
<Accuracies on test> class : 47.97
------------------------------
<Accuracies on photo> test class : 49.70
------------------------------
<Accuracies on art_painting> test class : 35.69
------------------------------
<Accuracies on sketch> test class : 53.63
------------------------------
Total epoch time: 46.958

New epoch - lr: 0.003
[1/32 iteration of epoch 3/30] 
 {loss} cls : 0.706, total : 0.706 
 {acc} cls : 75.00
[31/32 iteration of epoch 3/30] 
 {loss} cls : 0.646, total : 0.646 
 {acc} cls : 79.69
------------------------------
<Losses on train> cls : 0.536, total : 0.536
<Accuracies on train> cls : 82.42
Train epoch time: 11.693
------------------------------
<Accuracies on val> class : 82.28
------------------------------
<Accuracies on test> class : 56.64
------------------------------
<Accuracies on photo> test class : 61.74
------------------------------
<Accuracies on art_painting> test class : 42.24
------------------------------
<Accuracies on sketch> test class : 61.98
------------------------------
Total epoch time: 46.496

New epoch - lr: 0.003
[1/32 iteration of epoch 4/30] 
 {loss} cls : 0.416, total : 0.416 
 {acc} cls : 82.81
[31/32 iteration of epoch 4/30] 
 {loss} cls : 0.480, total : 0.480 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.419, total : 0.419
<Accuracies on train> cls : 85.64
Train epoch time: 10.999
------------------------------
<Accuracies on val> class : 82.70
------------------------------
<Accuracies on test> class : 57.72
------------------------------
<Accuracies on photo> test class : 57.37
------------------------------
<Accuracies on art_painting> test class : 43.90
------------------------------
<Accuracies on sketch> test class : 65.08
------------------------------
Total epoch time: 43.360

New epoch - lr: 0.003
[1/32 iteration of epoch 5/30] 
 {loss} cls : 0.251, total : 0.251 
 {acc} cls : 93.75
[31/32 iteration of epoch 5/30] 
 {loss} cls : 0.397, total : 0.397 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.311, total : 0.311
<Accuracies on train> cls : 88.77
Train epoch time: 10.961
------------------------------
<Accuracies on val> class : 83.12
------------------------------
<Accuracies on test> class : 55.42
------------------------------
<Accuracies on photo> test class : 60.90
------------------------------
<Accuracies on art_painting> test class : 38.87
------------------------------
<Accuracies on sketch> test class : 61.72
------------------------------
Total epoch time: 43.834

New epoch - lr: 0.003
[1/32 iteration of epoch 6/30] 
 {loss} cls : 0.294, total : 0.294 
 {acc} cls : 84.38
[31/32 iteration of epoch 6/30] 
 {loss} cls : 0.258, total : 0.258 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.259, total : 0.259
<Accuracies on train> cls : 90.53
Train epoch time: 11.395
------------------------------
<Accuracies on val> class : 84.81
------------------------------
<Accuracies on test> class : 54.74
------------------------------
<Accuracies on photo> test class : 53.53
------------------------------
<Accuracies on art_painting> test class : 40.33
------------------------------
<Accuracies on sketch> test class : 62.76
------------------------------
Total epoch time: 44.808

New epoch - lr: 0.003
[1/32 iteration of epoch 7/30] 
 {loss} cls : 0.162, total : 0.162 
 {acc} cls : 96.88
[31/32 iteration of epoch 7/30] 
 {loss} cls : 0.268, total : 0.268 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.199, total : 0.199
<Accuracies on train> cls : 92.63
Train epoch time: 11.435
------------------------------
<Accuracies on val> class : 87.76
------------------------------
<Accuracies on test> class : 58.21
------------------------------
<Accuracies on photo> test class : 55.21
------------------------------
<Accuracies on art_painting> test class : 40.77
------------------------------
<Accuracies on sketch> test class : 68.57
------------------------------
Total epoch time: 44.898

New epoch - lr: 0.003
[1/32 iteration of epoch 8/30] 
 {loss} cls : 0.167, total : 0.167 
 {acc} cls : 89.06
[31/32 iteration of epoch 8/30] 
 {loss} cls : 0.085, total : 0.085 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.163, total : 0.163
<Accuracies on train> cls : 93.99
Train epoch time: 11.066
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 59.37
------------------------------
<Accuracies on photo> test class : 60.00
------------------------------
<Accuracies on art_painting> test class : 43.31
------------------------------
<Accuracies on sketch> test class : 67.47
------------------------------
Total epoch time: 44.434

New epoch - lr: 0.003
[1/32 iteration of epoch 9/30] 
 {loss} cls : 0.236, total : 0.236 
 {acc} cls : 93.75
[31/32 iteration of epoch 9/30] 
 {loss} cls : 0.075, total : 0.075 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.156, total : 0.156
<Accuracies on train> cls : 94.04
Train epoch time: 12.233
------------------------------
<Accuracies on val> class : 86.92
------------------------------
<Accuracies on test> class : 61.45
------------------------------
<Accuracies on photo> test class : 65.99
------------------------------
<Accuracies on art_painting> test class : 45.36
------------------------------
<Accuracies on sketch> test class : 67.91
------------------------------
Total epoch time: 47.278

New epoch - lr: 0.003
[1/32 iteration of epoch 10/30] 
 {loss} cls : 0.064, total : 0.064 
 {acc} cls : 96.88
[31/32 iteration of epoch 10/30] 
 {loss} cls : 0.179, total : 0.179 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.118, total : 0.118
<Accuracies on train> cls : 95.95
Train epoch time: 12.250
------------------------------
<Accuracies on val> class : 86.50
------------------------------
<Accuracies on test> class : 58.53
------------------------------
<Accuracies on photo> test class : 60.60
------------------------------
<Accuracies on art_painting> test class : 42.63
------------------------------
<Accuracies on sketch> test class : 65.95
------------------------------
Total epoch time: 46.128

New epoch - lr: 0.003
[1/32 iteration of epoch 11/30] 
 {loss} cls : 0.205, total : 0.205 
 {acc} cls : 92.19
[31/32 iteration of epoch 11/30] 
 {loss} cls : 0.088, total : 0.088 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.102, total : 0.102
<Accuracies on train> cls : 96.09
Train epoch time: 12.503
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 59.02
------------------------------
<Accuracies on photo> test class : 65.87
------------------------------
<Accuracies on art_painting> test class : 42.38
------------------------------
<Accuracies on sketch> test class : 64.77
------------------------------
Total epoch time: 46.851

New epoch - lr: 0.003
[1/32 iteration of epoch 12/30] 
 {loss} cls : 0.078, total : 0.078 
 {acc} cls : 96.88
[31/32 iteration of epoch 12/30] 
 {loss} cls : 0.206, total : 0.206 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.078, total : 0.078
<Accuracies on train> cls : 97.41
Train epoch time: 13.384
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 59.24
------------------------------
<Accuracies on photo> test class : 64.01
------------------------------
<Accuracies on art_painting> test class : 46.63
------------------------------
<Accuracies on sketch> test class : 63.78
------------------------------
Total epoch time: 45.735

New epoch - lr: 0.003
[1/32 iteration of epoch 13/30] 
 {loss} cls : 0.041, total : 0.041 
 {acc} cls : 100.00
[31/32 iteration of epoch 13/30] 
 {loss} cls : 0.032, total : 0.032 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.076, total : 0.076
<Accuracies on train> cls : 97.71
Train epoch time: 13.141
------------------------------
<Accuracies on val> class : 89.87
------------------------------
<Accuracies on test> class : 60.01
------------------------------
<Accuracies on photo> test class : 62.04
------------------------------
<Accuracies on art_painting> test class : 42.77
------------------------------
<Accuracies on sketch> test class : 68.13
------------------------------
Total epoch time: 45.272

New epoch - lr: 0.003
[1/32 iteration of epoch 14/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 100.00
[31/32 iteration of epoch 14/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.055, total : 0.055
<Accuracies on train> cls : 98.14
Train epoch time: 11.593
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 61.92
------------------------------
<Accuracies on photo> test class : 65.09
------------------------------
<Accuracies on art_painting> test class : 47.75
------------------------------
<Accuracies on sketch> test class : 67.96
------------------------------
Total epoch time: 44.359

New epoch - lr: 0.003
[1/32 iteration of epoch 15/30] 
 {loss} cls : 0.082, total : 0.082 
 {acc} cls : 98.44
[31/32 iteration of epoch 15/30] 
 {loss} cls : 0.053, total : 0.053 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.057, total : 0.057
<Accuracies on train> cls : 98.14
Train epoch time: 11.019
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 59.64
------------------------------
<Accuracies on photo> test class : 64.31
------------------------------
<Accuracies on art_painting> test class : 43.41
------------------------------
<Accuracies on sketch> test class : 66.12
------------------------------
Total epoch time: 43.382

New epoch - lr: 0.003
[1/32 iteration of epoch 16/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
[31/32 iteration of epoch 16/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.053, total : 0.053
<Accuracies on train> cls : 98.34
Train epoch time: 11.300
------------------------------
<Accuracies on val> class : 90.30
------------------------------
<Accuracies on test> class : 61.80
------------------------------
<Accuracies on photo> test class : 64.85
------------------------------
<Accuracies on art_painting> test class : 45.85
------------------------------
<Accuracies on sketch> test class : 68.82
------------------------------
Total epoch time: 44.110

New epoch - lr: 0.003
[1/32 iteration of epoch 17/30] 
 {loss} cls : 0.147, total : 0.147 
 {acc} cls : 95.31
[31/32 iteration of epoch 17/30] 
 {loss} cls : 0.086, total : 0.086 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.040, total : 0.040
<Accuracies on train> cls : 98.54
Train epoch time: 11.351
------------------------------
<Accuracies on val> class : 90.72
------------------------------
<Accuracies on test> class : 61.10
------------------------------
<Accuracies on photo> test class : 62.04
------------------------------
<Accuracies on art_painting> test class : 44.73
------------------------------
<Accuracies on sketch> test class : 69.23
------------------------------
Total epoch time: 44.728

New epoch - lr: 0.003
[1/32 iteration of epoch 18/30] 
 {loss} cls : 0.039, total : 0.039 
 {acc} cls : 98.44
[31/32 iteration of epoch 18/30] 
 {loss} cls : 0.103, total : 0.103 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.051, total : 0.051
<Accuracies on train> cls : 98.54
Train epoch time: 12.366
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 59.59
------------------------------
<Accuracies on photo> test class : 59.40
------------------------------
<Accuracies on art_painting> test class : 44.78
------------------------------
<Accuracies on sketch> test class : 67.40
------------------------------
Total epoch time: 46.922

New epoch - lr: 0.003
[1/32 iteration of epoch 19/30] 
 {loss} cls : 0.097, total : 0.097 
 {acc} cls : 95.31
[31/32 iteration of epoch 19/30] 
 {loss} cls : 0.056, total : 0.056 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.063, total : 0.063
<Accuracies on train> cls : 97.85
Train epoch time: 12.543
------------------------------
<Accuracies on val> class : 89.87
------------------------------
<Accuracies on test> class : 61.33
------------------------------
<Accuracies on photo> test class : 63.17
------------------------------
<Accuracies on art_painting> test class : 46.39
------------------------------
<Accuracies on sketch> test class : 68.34
------------------------------
Total epoch time: 46.971

New epoch - lr: 0.003
[1/32 iteration of epoch 20/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 98.44
[31/32 iteration of epoch 20/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.02
Train epoch time: 12.433
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 59.03
------------------------------
<Accuracies on photo> test class : 65.33
------------------------------
<Accuracies on art_painting> test class : 46.73
------------------------------
<Accuracies on sketch> test class : 62.76
------------------------------
Total epoch time: 45.404

New epoch - lr: 0.003
[1/32 iteration of epoch 21/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
[31/32 iteration of epoch 21/30] 
 {loss} cls : 0.101, total : 0.101 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 98.97
Train epoch time: 12.746
------------------------------
<Accuracies on val> class : 90.72
------------------------------
<Accuracies on test> class : 62.29
------------------------------
<Accuracies on photo> test class : 65.63
------------------------------
<Accuracies on art_painting> test class : 44.68
------------------------------
<Accuracies on sketch> test class : 70.04
------------------------------
Total epoch time: 44.708

New epoch - lr: 0.003
[1/32 iteration of epoch 22/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 100.00
[31/32 iteration of epoch 22/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.66
Train epoch time: 13.273
------------------------------
<Accuracies on val> class : 90.72
------------------------------
<Accuracies on test> class : 62.53
------------------------------
<Accuracies on photo> test class : 66.17
------------------------------
<Accuracies on art_painting> test class : 48.58
------------------------------
<Accuracies on sketch> test class : 68.26
------------------------------
Total epoch time: 45.019

New epoch - lr: 0.003
[1/32 iteration of epoch 23/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 98.44
[31/32 iteration of epoch 23/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.02
Train epoch time: 12.954
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 64.30
------------------------------
<Accuracies on photo> test class : 65.81
------------------------------
<Accuracies on art_painting> test class : 51.17
------------------------------
<Accuracies on sketch> test class : 70.50
------------------------------
Total epoch time: 45.817

New epoch - lr: 0.003
[1/32 iteration of epoch 24/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
[31/32 iteration of epoch 24/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.51
Train epoch time: 11.758
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 63.27
------------------------------
<Accuracies on photo> test class : 65.81
------------------------------
<Accuracies on art_painting> test class : 47.17
------------------------------
<Accuracies on sketch> test class : 70.58
------------------------------
Total epoch time: 44.508

New epoch - lr: 0.003
[1/32 iteration of epoch 25/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
[31/32 iteration of epoch 25/30] 
 {loss} cls : 0.022, total : 0.022 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.56
Train epoch time: 11.402
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 62.06
------------------------------
<Accuracies on photo> test class : 64.13
------------------------------
<Accuracies on art_painting> test class : 46.68
------------------------------
<Accuracies on sketch> test class : 69.20
------------------------------
Total epoch time: 45.710

New epoch - lr: 0.003
[1/32 iteration of epoch 26/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
[31/32 iteration of epoch 26/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.66
Train epoch time: 11.075
------------------------------
<Accuracies on val> class : 92.41
------------------------------
<Accuracies on test> class : 63.82
------------------------------
<Accuracies on photo> test class : 65.45
------------------------------
<Accuracies on art_painting> test class : 48.39
------------------------------
<Accuracies on sketch> test class : 71.16
------------------------------
Total epoch time: 43.158

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 27/30] 
 {loss} cls : 0.045, total : 0.045 
 {acc} cls : 98.44
[31/32 iteration of epoch 27/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.51
Train epoch time: 11.186
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 62.34
------------------------------
<Accuracies on photo> test class : 61.02
------------------------------
<Accuracies on art_painting> test class : 46.34
------------------------------
<Accuracies on sketch> test class : 71.24
------------------------------
Total epoch time: 46.200

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 28/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 28/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.61
Train epoch time: 11.795
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 63.07
------------------------------
<Accuracies on photo> test class : 63.89
------------------------------
<Accuracies on art_painting> test class : 47.07
------------------------------
<Accuracies on sketch> test class : 71.06
------------------------------
Total epoch time: 42.414

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 29/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/32 iteration of epoch 29/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.61
Train epoch time: 11.467
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 62.97
------------------------------
<Accuracies on photo> test class : 63.35
------------------------------
<Accuracies on art_painting> test class : 47.90
------------------------------
<Accuracies on sketch> test class : 70.65
------------------------------
Total epoch time: 40.639

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 30/30] 
 {loss} cls : 0.024, total : 0.024 
 {acc} cls : 98.44
[31/32 iteration of epoch 30/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.37
Train epoch time: 11.227
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 63.36
------------------------------
<Accuracies on photo> test class : 63.95
------------------------------
<Accuracies on art_painting> test class : 47.95
------------------------------
<Accuracies on sketch> test class : 71.14
------------------------------
Total epoch time: 38.783

******************************
Best val 0.940928, corresponding test 0.629659 - best test: 0.642997

******************************
Best val 0.9409282803535461, corresponding photo test 0.6335329413414001

******************************
Best val 0.9409282803535461, corresponding art_painting test 0.47900390625

******************************
Best val 0.9409282803535461, corresponding sketch test 0.706541121006012
