WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: teston

New epoch - lr: 0.003
[1/55 iteration of epoch 1/30] 
 {loss} cls : 2.035, total : 2.035 
 {acc} cls : 9.38
[31/55 iteration of epoch 1/30] 
 {loss} cls : 0.453, total : 0.453 
 {acc} cls : 82.81
------------------------------
<Losses on train> cls : 1.240, total : 1.240
<Accuracies on train> cls : 66.62
Train epoch time: 344.491
------------------------------
<Accuracies on val> class : 88.44
------------------------------
<Accuracies on test> class : 46.70
------------------------------
<Accuracies on photo> test class : 54.49
------------------------------
<Accuracies on cartoon> test class : 49.53
------------------------------
<Accuracies on art_painting> test class : 37.11
------------------------------
Total epoch time: 366.363

New epoch - lr: 0.003
[1/55 iteration of epoch 2/30] 
 {loss} cls : 0.499, total : 0.499 
 {acc} cls : 82.03
[31/55 iteration of epoch 2/30] 
 {loss} cls : 0.332, total : 0.332 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.423, total : 0.423
<Accuracies on train> cls : 83.84
Train epoch time: 57.503
------------------------------
<Accuracies on val> class : 86.93
------------------------------
<Accuracies on test> class : 52.36
------------------------------
<Accuracies on photo> test class : 50.48
------------------------------
<Accuracies on cartoon> test class : 66.13
------------------------------
<Accuracies on art_painting> test class : 38.13
------------------------------
Total epoch time: 83.920

New epoch - lr: 0.003
[1/55 iteration of epoch 3/30] 
 {loss} cls : 0.301, total : 0.301 
 {acc} cls : 91.41
[31/55 iteration of epoch 3/30] 
 {loss} cls : 0.272, total : 0.272 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.354, total : 0.354
<Accuracies on train> cls : 86.15
Train epoch time: 40.548
------------------------------
<Accuracies on val> class : 91.96
------------------------------
<Accuracies on test> class : 58.97
------------------------------
<Accuracies on photo> test class : 63.47
------------------------------
<Accuracies on cartoon> test class : 66.98
------------------------------
<Accuracies on art_painting> test class : 46.14
------------------------------
Total epoch time: 67.931

New epoch - lr: 0.003
[1/55 iteration of epoch 4/30] 
 {loss} cls : 0.333, total : 0.333 
 {acc} cls : 85.16
[31/55 iteration of epoch 4/30] 
 {loss} cls : 0.342, total : 0.342 
 {acc} cls : 86.72
------------------------------
<Losses on train> cls : 0.347, total : 0.347
<Accuracies on train> cls : 86.18
Train epoch time: 38.107
------------------------------
<Accuracies on val> class : 89.95
------------------------------
<Accuracies on test> class : 62.09
------------------------------
<Accuracies on photo> test class : 68.50
------------------------------
<Accuracies on cartoon> test class : 68.60
------------------------------
<Accuracies on art_painting> test class : 49.41
------------------------------
Total epoch time: 63.081

New epoch - lr: 0.003
[1/55 iteration of epoch 5/30] 
 {loss} cls : 0.313, total : 0.313 
 {acc} cls : 88.28
[31/55 iteration of epoch 5/30] 
 {loss} cls : 0.226, total : 0.226 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.312, total : 0.312
<Accuracies on train> cls : 87.49
Train epoch time: 38.951
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 67.75
------------------------------
<Accuracies on photo> test class : 76.65
------------------------------
<Accuracies on cartoon> test class : 72.44
------------------------------
<Accuracies on art_painting> test class : 55.13
------------------------------
Total epoch time: 63.617

New epoch - lr: 0.003
[1/55 iteration of epoch 6/30] 
 {loss} cls : 0.400, total : 0.400 
 {acc} cls : 82.81
[31/55 iteration of epoch 6/30] 
 {loss} cls : 0.280, total : 0.280 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.289, total : 0.289
<Accuracies on train> cls : 88.58
Train epoch time: 38.378
------------------------------
<Accuracies on val> class : 92.46
------------------------------
<Accuracies on test> class : 64.15
------------------------------
<Accuracies on photo> test class : 71.32
------------------------------
<Accuracies on cartoon> test class : 72.57
------------------------------
<Accuracies on art_painting> test class : 48.68
------------------------------
Total epoch time: 62.207

New epoch - lr: 0.003
[1/55 iteration of epoch 7/30] 
 {loss} cls : 0.337, total : 0.337 
 {acc} cls : 87.50
[31/55 iteration of epoch 7/30] 
 {loss} cls : 0.271, total : 0.271 
 {acc} cls : 88.28
------------------------------
<Losses on train> cls : 0.281, total : 0.281
<Accuracies on train> cls : 89.33
Train epoch time: 38.190
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 67.95
------------------------------
<Accuracies on photo> test class : 76.77
------------------------------
<Accuracies on cartoon> test class : 75.34
------------------------------
<Accuracies on art_painting> test class : 52.29
------------------------------
Total epoch time: 62.579

New epoch - lr: 0.003
[1/55 iteration of epoch 8/30] 
 {loss} cls : 0.209, total : 0.209 
 {acc} cls : 89.84
[31/55 iteration of epoch 8/30] 
 {loss} cls : 0.298, total : 0.298 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.284, total : 0.284
<Accuracies on train> cls : 88.51
Train epoch time: 37.985
------------------------------
<Accuracies on val> class : 92.46
------------------------------
<Accuracies on test> class : 66.88
------------------------------
<Accuracies on photo> test class : 78.32
------------------------------
<Accuracies on cartoon> test class : 68.77
------------------------------
<Accuracies on art_painting> test class : 55.37
------------------------------
Total epoch time: 64.251

New epoch - lr: 0.003
[1/55 iteration of epoch 9/30] 
 {loss} cls : 0.228, total : 0.228 
 {acc} cls : 89.06
[31/55 iteration of epoch 9/30] 
 {loss} cls : 0.284, total : 0.284 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.268, total : 0.268
<Accuracies on train> cls : 89.28
Train epoch time: 36.908
------------------------------
<Accuracies on val> class : 93.47
------------------------------
<Accuracies on test> class : 71.53
------------------------------
<Accuracies on photo> test class : 81.08
------------------------------
<Accuracies on cartoon> test class : 77.99
------------------------------
<Accuracies on art_painting> test class : 56.35
------------------------------
Total epoch time: 64.283

New epoch - lr: 0.003
[1/55 iteration of epoch 10/30] 
 {loss} cls : 0.191, total : 0.191 
 {acc} cls : 92.97
[31/55 iteration of epoch 10/30] 
 {loss} cls : 0.241, total : 0.241 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.254, total : 0.254
<Accuracies on train> cls : 89.69
Train epoch time: 35.556
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 72.24
------------------------------
<Accuracies on photo> test class : 82.75
------------------------------
<Accuracies on cartoon> test class : 75.13
------------------------------
<Accuracies on art_painting> test class : 60.35
------------------------------
Total epoch time: 62.826

New epoch - lr: 0.003
[1/55 iteration of epoch 11/30] 
 {loss} cls : 0.195, total : 0.195 
 {acc} cls : 92.97
[31/55 iteration of epoch 11/30] 
 {loss} cls : 0.332, total : 0.332 
 {acc} cls : 84.38
------------------------------
<Losses on train> cls : 0.240, total : 0.240
<Accuracies on train> cls : 90.20
Train epoch time: 36.673
------------------------------
<Accuracies on val> class : 94.22
------------------------------
<Accuracies on test> class : 69.93
------------------------------
<Accuracies on photo> test class : 77.07
------------------------------
<Accuracies on cartoon> test class : 76.96
------------------------------
<Accuracies on art_painting> test class : 56.05
------------------------------
Total epoch time: 62.354

New epoch - lr: 0.003
[1/55 iteration of epoch 12/30] 
 {loss} cls : 0.272, total : 0.272 
 {acc} cls : 87.50
[31/55 iteration of epoch 12/30] 
 {loss} cls : 0.269, total : 0.269 
 {acc} cls : 86.72
------------------------------
<Losses on train> cls : 0.248, total : 0.248
<Accuracies on train> cls : 90.24
Train epoch time: 38.481
------------------------------
<Accuracies on val> class : 94.97
------------------------------
<Accuracies on test> class : 71.35
------------------------------
<Accuracies on photo> test class : 77.96
------------------------------
<Accuracies on cartoon> test class : 77.13
------------------------------
<Accuracies on art_painting> test class : 59.33
------------------------------
Total epoch time: 62.214

New epoch - lr: 0.003
[1/55 iteration of epoch 13/30] 
 {loss} cls : 0.237, total : 0.237 
 {acc} cls : 90.62
[31/55 iteration of epoch 13/30] 
 {loss} cls : 0.190, total : 0.190 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.248, total : 0.248
<Accuracies on train> cls : 90.07
Train epoch time: 41.009
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 69.14
------------------------------
<Accuracies on photo> test class : 78.86
------------------------------
<Accuracies on cartoon> test class : 73.46
------------------------------
<Accuracies on art_painting> test class : 56.25
------------------------------
Total epoch time: 63.090

New epoch - lr: 0.003
[1/55 iteration of epoch 14/30] 
 {loss} cls : 0.228, total : 0.228 
 {acc} cls : 89.06
[31/55 iteration of epoch 14/30] 
 {loss} cls : 0.267, total : 0.267 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.249, total : 0.249
<Accuracies on train> cls : 90.10
Train epoch time: 39.170
------------------------------
<Accuracies on val> class : 93.22
------------------------------
<Accuracies on test> class : 72.72
------------------------------
<Accuracies on photo> test class : 81.68
------------------------------
<Accuracies on cartoon> test class : 77.18
------------------------------
<Accuracies on art_painting> test class : 60.30
------------------------------
Total epoch time: 62.787

New epoch - lr: 0.003
[1/55 iteration of epoch 15/30] 
 {loss} cls : 0.269, total : 0.269 
 {acc} cls : 89.06
[31/55 iteration of epoch 15/30] 
 {loss} cls : 0.289, total : 0.289 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.247, total : 0.247
<Accuracies on train> cls : 89.79
Train epoch time: 37.488
------------------------------
<Accuracies on val> class : 95.23
------------------------------
<Accuracies on test> class : 74.02
------------------------------
<Accuracies on photo> test class : 82.34
------------------------------
<Accuracies on cartoon> test class : 77.35
------------------------------
<Accuracies on art_painting> test class : 63.43
------------------------------
Total epoch time: 64.914

New epoch - lr: 0.003
[1/55 iteration of epoch 16/30] 
 {loss} cls : 0.265, total : 0.265 
 {acc} cls : 89.06
[31/55 iteration of epoch 16/30] 
 {loss} cls : 0.311, total : 0.311 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.240, total : 0.240
<Accuracies on train> cls : 90.17
Train epoch time: 35.184
------------------------------
<Accuracies on val> class : 95.73
------------------------------
<Accuracies on test> class : 73.67
------------------------------
<Accuracies on photo> test class : 81.14
------------------------------
<Accuracies on cartoon> test class : 77.47
------------------------------
<Accuracies on art_painting> test class : 63.23
------------------------------
Total epoch time: 64.206

New epoch - lr: 0.003
[1/55 iteration of epoch 17/30] 
 {loss} cls : 0.221, total : 0.221 
 {acc} cls : 92.19
[31/55 iteration of epoch 17/30] 
 {loss} cls : 0.250, total : 0.250 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.235, total : 0.235
<Accuracies on train> cls : 90.58
Train epoch time: 35.916
------------------------------
<Accuracies on val> class : 93.97
------------------------------
<Accuracies on test> class : 72.24
------------------------------
<Accuracies on photo> test class : 80.24
------------------------------
<Accuracies on cartoon> test class : 76.24
------------------------------
<Accuracies on art_painting> test class : 61.13
------------------------------
Total epoch time: 62.107

New epoch - lr: 0.003
[1/55 iteration of epoch 18/30] 
 {loss} cls : 0.250, total : 0.250 
 {acc} cls : 92.19
[31/55 iteration of epoch 18/30] 
 {loss} cls : 0.188, total : 0.188 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.221, total : 0.221
<Accuracies on train> cls : 91.12
Train epoch time: 38.964
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 72.24
------------------------------
<Accuracies on photo> test class : 81.86
------------------------------
<Accuracies on cartoon> test class : 76.54
------------------------------
<Accuracies on art_painting> test class : 59.47
------------------------------
Total epoch time: 61.715

New epoch - lr: 0.003
[1/55 iteration of epoch 19/30] 
 {loss} cls : 0.267, total : 0.267 
 {acc} cls : 87.50
[31/55 iteration of epoch 19/30] 
 {loss} cls : 0.260, total : 0.260 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.233, total : 0.233
<Accuracies on train> cls : 90.62
Train epoch time: 40.140
------------------------------
<Accuracies on val> class : 92.96
------------------------------
<Accuracies on test> class : 73.56
------------------------------
<Accuracies on photo> test class : 83.29
------------------------------
<Accuracies on cartoon> test class : 77.35
------------------------------
<Accuracies on art_painting> test class : 61.28
------------------------------
Total epoch time: 61.524

New epoch - lr: 0.003
[1/55 iteration of epoch 20/30] 
 {loss} cls : 0.168, total : 0.168 
 {acc} cls : 93.75
[31/55 iteration of epoch 20/30] 
 {loss} cls : 0.196, total : 0.196 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.220, total : 0.220
<Accuracies on train> cls : 91.24
Train epoch time: 40.053
------------------------------
<Accuracies on val> class : 94.72
------------------------------
<Accuracies on test> class : 73.34
------------------------------
<Accuracies on photo> test class : 82.22
------------------------------
<Accuracies on cartoon> test class : 78.80
------------------------------
<Accuracies on art_painting> test class : 59.86
------------------------------
Total epoch time: 64.364

New epoch - lr: 0.003
[1/55 iteration of epoch 21/30] 
 {loss} cls : 0.287, total : 0.287 
 {acc} cls : 87.50
[31/55 iteration of epoch 21/30] 
 {loss} cls : 0.174, total : 0.174 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.218, total : 0.218
<Accuracies on train> cls : 91.38
Train epoch time: 37.842
------------------------------
<Accuracies on val> class : 94.47
------------------------------
<Accuracies on test> class : 73.75
------------------------------
<Accuracies on photo> test class : 81.02
------------------------------
<Accuracies on cartoon> test class : 77.56
------------------------------
<Accuracies on art_painting> test class : 63.48
------------------------------
Total epoch time: 64.704

New epoch - lr: 0.003
[1/55 iteration of epoch 22/30] 
 {loss} cls : 0.275, total : 0.275 
 {acc} cls : 89.84
[31/55 iteration of epoch 22/30] 
 {loss} cls : 0.156, total : 0.156 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.225, total : 0.225
<Accuracies on train> cls : 91.11
Train epoch time: 35.168
------------------------------
<Accuracies on val> class : 94.97
------------------------------
<Accuracies on test> class : 70.44
------------------------------
<Accuracies on photo> test class : 76.53
------------------------------
<Accuracies on cartoon> test class : 77.60
------------------------------
<Accuracies on art_painting> test class : 57.28
------------------------------
Total epoch time: 62.151

New epoch - lr: 0.003
[1/55 iteration of epoch 23/30] 
 {loss} cls : 0.256, total : 0.256 
 {acc} cls : 89.06
[31/55 iteration of epoch 23/30] 
 {loss} cls : 0.321, total : 0.321 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.213, total : 0.213
<Accuracies on train> cls : 91.53
Train epoch time: 37.414
------------------------------
<Accuracies on val> class : 94.22
------------------------------
<Accuracies on test> class : 68.31
------------------------------
<Accuracies on photo> test class : 74.37
------------------------------
<Accuracies on cartoon> test class : 74.70
------------------------------
<Accuracies on art_painting> test class : 56.05
------------------------------
Total epoch time: 64.039

New epoch - lr: 0.003
[1/55 iteration of epoch 24/30] 
 {loss} cls : 0.149, total : 0.149 
 {acc} cls : 96.09
[31/55 iteration of epoch 24/30] 
 {loss} cls : 0.231, total : 0.231 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.220, total : 0.220
<Accuracies on train> cls : 91.16
Train epoch time: 37.846
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 70.55
------------------------------
<Accuracies on photo> test class : 78.44
------------------------------
<Accuracies on cartoon> test class : 77.39
------------------------------
<Accuracies on art_painting> test class : 56.30
------------------------------
Total epoch time: 61.220

New epoch - lr: 0.003
[1/55 iteration of epoch 25/30] 
 {loss} cls : 0.250, total : 0.250 
 {acc} cls : 91.41
[31/55 iteration of epoch 25/30] 
 {loss} cls : 0.267, total : 0.267 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.217, total : 0.217
<Accuracies on train> cls : 91.26
Train epoch time: 33.458
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 70.42
------------------------------
<Accuracies on photo> test class : 78.08
------------------------------
<Accuracies on cartoon> test class : 75.68
------------------------------
<Accuracies on art_painting> test class : 58.15
------------------------------
Total epoch time: 52.527

New epoch - lr: 0.003
[1/55 iteration of epoch 26/30] 
 {loss} cls : 0.178, total : 0.178 
 {acc} cls : 92.97
[31/55 iteration of epoch 26/30] 
 {loss} cls : 0.263, total : 0.263 
 {acc} cls : 89.84
------------------------------
<Losses on train> cls : 0.207, total : 0.207
<Accuracies on train> cls : 91.80
Train epoch time: 23.836
------------------------------
<Accuracies on val> class : 93.72
------------------------------
<Accuracies on test> class : 70.44
------------------------------
<Accuracies on photo> test class : 77.43
------------------------------
<Accuracies on cartoon> test class : 76.62
------------------------------
<Accuracies on art_painting> test class : 57.67
------------------------------
Total epoch time: 37.991

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 27/30] 
 {loss} cls : 0.182, total : 0.182 
 {acc} cls : 92.19
[31/55 iteration of epoch 27/30] 
 {loss} cls : 0.217, total : 0.217 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.210, total : 0.210
<Accuracies on train> cls : 91.58
Train epoch time: 22.639
------------------------------
<Accuracies on val> class : 94.97
------------------------------
<Accuracies on test> class : 70.54
------------------------------
<Accuracies on photo> test class : 77.13
------------------------------
<Accuracies on cartoon> test class : 76.54
------------------------------
<Accuracies on art_painting> test class : 58.30
------------------------------
Total epoch time: 36.761

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 28/30] 
 {loss} cls : 0.221, total : 0.221 
 {acc} cls : 90.62
[31/55 iteration of epoch 28/30] 
 {loss} cls : 0.155, total : 0.155 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.204, total : 0.204
<Accuracies on train> cls : 91.73
Train epoch time: 22.373
------------------------------
<Accuracies on val> class : 94.97
------------------------------
<Accuracies on test> class : 69.94
------------------------------
<Accuracies on photo> test class : 76.41
------------------------------
<Accuracies on cartoon> test class : 77.26
------------------------------
<Accuracies on art_painting> test class : 56.30
------------------------------
Total epoch time: 36.701

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 29/30] 
 {loss} cls : 0.214, total : 0.214 
 {acc} cls : 92.19
[31/55 iteration of epoch 29/30] 
 {loss} cls : 0.217, total : 0.217 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.204, total : 0.204
<Accuracies on train> cls : 91.70
Train epoch time: 22.467
------------------------------
<Accuracies on val> class : 95.23
------------------------------
<Accuracies on test> class : 71.77
------------------------------
<Accuracies on photo> test class : 79.10
------------------------------
<Accuracies on cartoon> test class : 78.03
------------------------------
<Accuracies on art_painting> test class : 58.64
------------------------------
Total epoch time: 36.534

New epoch - lr: 0.0009000000000000002
[1/55 iteration of epoch 30/30] 
 {loss} cls : 0.205, total : 0.205 
 {acc} cls : 90.62
[31/55 iteration of epoch 30/30] 
 {loss} cls : 0.143, total : 0.143 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.207, total : 0.207
<Accuracies on train> cls : 91.73
Train epoch time: 22.630
------------------------------
<Accuracies on val> class : 95.48
------------------------------
<Accuracies on test> class : 70.69
------------------------------
<Accuracies on photo> test class : 78.56
------------------------------
<Accuracies on cartoon> test class : 76.15
------------------------------
<Accuracies on art_painting> test class : 58.01
------------------------------
Total epoch time: 36.668

******************************
Best val 0.957286, corresponding test 0.736721 - best test: 0.740185

******************************
Best val 0.9572864174842834, corresponding photo test 0.811377227306366

******************************
Best val 0.9572864174842834, corresponding cartoon test 0.7747440338134766

******************************
Best val 0.9572864174842834, corresponding art_painting test 0.63232421875
