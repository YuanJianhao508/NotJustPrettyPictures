
Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.015, total : 2.015 
 {acc} cls : 10.94
------------------------------
<Losses on train> cls : 1.219, total : 1.219
<Accuracies on train> cls : 69.36
Train epoch time: 20.338
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 57.61
------------------------------
<Accuracies on cartoon> test class : 62.33
------------------------------
<Accuracies on art_painting> test class : 70.51
------------------------------
<Accuracies on sketch> test class : 48.08
------------------------------
Total epoch time: 50.888

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.350, total : 0.350 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.254, total : 0.254
<Accuracies on train> cls : 92.63
Train epoch time: 18.954
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 58.95
------------------------------
<Accuracies on cartoon> test class : 62.93
------------------------------
<Accuracies on art_painting> test class : 67.92
------------------------------
<Accuracies on sketch> test class : 51.90
------------------------------
Total epoch time: 49.462

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.143, total : 0.143 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.181, total : 0.181
<Accuracies on train> cls : 94.60
Train epoch time: 18.902
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 61.71
------------------------------
<Accuracies on cartoon> test class : 67.32
------------------------------
<Accuracies on art_painting> test class : 69.68
------------------------------
<Accuracies on sketch> test class : 54.21
------------------------------
Total epoch time: 49.117

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.108, total : 0.108 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.166, total : 0.166
<Accuracies on train> cls : 95.11
Train epoch time: 19.021
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 65.33
------------------------------
<Accuracies on cartoon> test class : 68.81
------------------------------
<Accuracies on art_painting> test class : 70.12
------------------------------
<Accuracies on sketch> test class : 60.75
------------------------------
Total epoch time: 49.000

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.156, total : 0.156 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.122, total : 0.122
<Accuracies on train> cls : 95.99
Train epoch time: 19.319
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 63.11
------------------------------
<Accuracies on cartoon> test class : 64.93
------------------------------
<Accuracies on art_painting> test class : 69.24
------------------------------
<Accuracies on sketch> test class : 58.82
------------------------------
Total epoch time: 48.901

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.149, total : 0.149 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.103, total : 0.103
<Accuracies on train> cls : 97.04
Train epoch time: 18.830
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.67
------------------------------
<Accuracies on cartoon> test class : 63.40
------------------------------
<Accuracies on art_painting> test class : 68.12
------------------------------
<Accuracies on sketch> test class : 67.88
------------------------------
Total epoch time: 49.722

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.119, total : 0.119 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.098, total : 0.098
<Accuracies on train> cls : 96.74
Train epoch time: 18.957
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.14
------------------------------
<Accuracies on cartoon> test class : 68.39
------------------------------
<Accuracies on art_painting> test class : 71.58
------------------------------
<Accuracies on sketch> test class : 64.09
------------------------------
Total epoch time: 48.917

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.138, total : 0.138 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.079, total : 0.079
<Accuracies on train> cls : 97.49
Train epoch time: 17.593
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.40
------------------------------
<Accuracies on cartoon> test class : 65.96
------------------------------
<Accuracies on art_painting> test class : 70.85
------------------------------
<Accuracies on sketch> test class : 66.45
------------------------------
Total epoch time: 48.350

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.121, total : 0.121 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.088, total : 0.088
<Accuracies on train> cls : 97.35
Train epoch time: 17.280
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 67.80
------------------------------
<Accuracies on cartoon> test class : 64.12
------------------------------
<Accuracies on art_painting> test class : 70.70
------------------------------
<Accuracies on sketch> test class : 68.49
------------------------------
Total epoch time: 48.895

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.149, total : 0.149 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.078, total : 0.078
<Accuracies on train> cls : 97.59
Train epoch time: 17.796
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.58
------------------------------
<Accuracies on cartoon> test class : 66.47
------------------------------
<Accuracies on art_painting> test class : 69.29
------------------------------
<Accuracies on sketch> test class : 67.35
------------------------------
Total epoch time: 47.721

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.120, total : 0.120 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.063, total : 0.063
<Accuracies on train> cls : 98.17
Train epoch time: 18.336
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 67.13
------------------------------
<Accuracies on cartoon> test class : 65.96
------------------------------
<Accuracies on art_painting> test class : 70.17
------------------------------
<Accuracies on sketch> test class : 66.25
------------------------------
Total epoch time: 47.600

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.072, total : 0.072 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.062, total : 0.062
<Accuracies on train> cls : 97.96
Train epoch time: 18.368
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 66.52
------------------------------
<Accuracies on cartoon> test class : 65.02
------------------------------
<Accuracies on art_painting> test class : 71.24
------------------------------
<Accuracies on sketch> test class : 64.95
------------------------------
Total epoch time: 47.446

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.073, total : 0.073 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.054, total : 0.054
<Accuracies on train> cls : 98.17
Train epoch time: 18.178
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 67.11
------------------------------
<Accuracies on cartoon> test class : 65.96
------------------------------
<Accuracies on art_painting> test class : 71.63
------------------------------
<Accuracies on sketch> test class : 65.44
------------------------------
Total epoch time: 48.210

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.081, total : 0.081 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.053, total : 0.053
<Accuracies on train> cls : 98.37
Train epoch time: 17.995
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.41
------------------------------
<Accuracies on cartoon> test class : 68.39
------------------------------
<Accuracies on art_painting> test class : 70.51
------------------------------
<Accuracies on sketch> test class : 67.32
------------------------------
Total epoch time: 47.381

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.040, total : 0.040 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.043, total : 0.043
<Accuracies on train> cls : 98.74
Train epoch time: 18.983
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 68.00
------------------------------
<Accuracies on cartoon> test class : 66.25
------------------------------
<Accuracies on art_painting> test class : 70.70
------------------------------
<Accuracies on sketch> test class : 67.63
------------------------------
Total epoch time: 49.515

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.059, total : 0.059 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.046, total : 0.046
<Accuracies on train> cls : 98.47
Train epoch time: 19.324
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.37
------------------------------
<Accuracies on cartoon> test class : 69.45
------------------------------
<Accuracies on art_painting> test class : 71.68
------------------------------
<Accuracies on sketch> test class : 63.88
------------------------------
Total epoch time: 47.927

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.12
Train epoch time: 20.279
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.39
------------------------------
<Accuracies on cartoon> test class : 69.16
------------------------------
<Accuracies on art_painting> test class : 72.66
------------------------------
<Accuracies on sketch> test class : 67.83
------------------------------
Total epoch time: 48.419

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.85
Train epoch time: 20.021
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.79
------------------------------
<Accuracies on cartoon> test class : 69.88
------------------------------
<Accuracies on art_painting> test class : 72.02
------------------------------
<Accuracies on sketch> test class : 66.45
------------------------------
Total epoch time: 49.252

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.064, total : 0.064 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.035, total : 0.035
<Accuracies on train> cls : 98.85
Train epoch time: 19.787
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 70.56
------------------------------
<Accuracies on cartoon> test class : 69.97
------------------------------
<Accuracies on art_painting> test class : 71.44
------------------------------
<Accuracies on sketch> test class : 70.45
------------------------------
Total epoch time: 49.001

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.12
Train epoch time: 18.628
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 72.56
------------------------------
<Accuracies on cartoon> test class : 71.80
------------------------------
<Accuracies on art_painting> test class : 72.51
------------------------------
<Accuracies on sketch> test class : 73.05
------------------------------
Total epoch time: 49.405

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.052, total : 0.052 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.034, total : 0.034
<Accuracies on train> cls : 98.78
Train epoch time: 18.640
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 72.18
------------------------------
<Accuracies on cartoon> test class : 70.73
------------------------------
<Accuracies on art_painting> test class : 74.27
------------------------------
<Accuracies on sketch> test class : 71.95
------------------------------
Total epoch time: 47.454

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.12
Train epoch time: 18.689
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 70.63
------------------------------
<Accuracies on cartoon> test class : 71.50
------------------------------
<Accuracies on art_painting> test class : 73.29
------------------------------
<Accuracies on sketch> test class : 68.72
------------------------------
Total epoch time: 48.478

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.026, total : 0.026
<Accuracies on train> cls : 99.15
Train epoch time: 18.953
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.87
------------------------------
<Accuracies on cartoon> test class : 72.10
------------------------------
<Accuracies on art_painting> test class : 74.22
------------------------------
<Accuracies on sketch> test class : 68.39
------------------------------
Total epoch time: 50.014

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.022, total : 0.022 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.56
Train epoch time: 18.837
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.57
------------------------------
<Accuracies on cartoon> test class : 71.97
------------------------------
<Accuracies on art_painting> test class : 73.63
------------------------------
<Accuracies on sketch> test class : 68.13
------------------------------
Total epoch time: 48.817

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.56
Train epoch time: 18.483
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.23
------------------------------
<Accuracies on cartoon> test class : 71.08
------------------------------
<Accuracies on art_painting> test class : 73.19
------------------------------
<Accuracies on sketch> test class : 66.07
------------------------------
Total epoch time: 49.131

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.59
Train epoch time: 17.982
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.74
------------------------------
<Accuracies on cartoon> test class : 68.94
------------------------------
<Accuracies on art_painting> test class : 73.14
------------------------------
<Accuracies on sketch> test class : 68.44
------------------------------
Total epoch time: 49.383

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.49
Train epoch time: 17.861
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.78
------------------------------
<Accuracies on cartoon> test class : 70.22
------------------------------
<Accuracies on art_painting> test class : 73.73
------------------------------
<Accuracies on sketch> test class : 67.45
------------------------------
Total epoch time: 50.030

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.46
Train epoch time: 18.279
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.79
------------------------------
<Accuracies on cartoon> test class : 70.26
------------------------------
<Accuracies on art_painting> test class : 73.58
------------------------------
<Accuracies on sketch> test class : 67.52
------------------------------
Total epoch time: 47.883

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.69
Train epoch time: 18.603
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.33
------------------------------
<Accuracies on cartoon> test class : 69.80
------------------------------
<Accuracies on art_painting> test class : 73.54
------------------------------
<Accuracies on sketch> test class : 66.86
------------------------------
Total epoch time: 47.326

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.69
Train epoch time: 18.443
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.08
------------------------------
<Accuracies on cartoon> test class : 70.39
------------------------------
<Accuracies on art_painting> test class : 73.83
------------------------------
<Accuracies on sketch> test class : 67.93
------------------------------
Total epoch time: 49.134

******************************
Best val 1, corresponding test 0.700757 - best test: 0.725634

******************************
Best val 1.0, corresponding cartoon test 0.7039248943328857

******************************
Best val 1.0, corresponding art_painting test 0.73828125

******************************
Best val 1.0, corresponding sketch test 0.6793076992034912
