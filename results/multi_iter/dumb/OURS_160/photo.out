
Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.276, total : 2.276 
 {acc} cls : 10.94
------------------------------
<Losses on train> cls : 0.683, total : 0.683
<Accuracies on train> cls : 82.34
Train epoch time: 18.251
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 46.44
------------------------------
<Accuracies on cartoon> test class : 45.69
------------------------------
<Accuracies on art_painting> test class : 59.67
------------------------------
<Accuracies on sketch> test class : 39.98
------------------------------
Total epoch time: 49.296

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.088, total : 0.088 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.045, total : 0.045
<Accuracies on train> cls : 98.54
Train epoch time: 17.788
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 47.30
------------------------------
<Accuracies on cartoon> test class : 42.24
------------------------------
<Accuracies on art_painting> test class : 60.94
------------------------------
<Accuracies on sketch> test class : 43.22
------------------------------
Total epoch time: 47.201

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.08
Train epoch time: 17.636
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 49.01
------------------------------
<Accuracies on cartoon> test class : 47.57
------------------------------
<Accuracies on art_painting> test class : 67.72
------------------------------
<Accuracies on sketch> test class : 40.11
------------------------------
Total epoch time: 48.259

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.029, total : 0.029 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.35
Train epoch time: 17.089
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 51.83
------------------------------
<Accuracies on cartoon> test class : 49.74
------------------------------
<Accuracies on art_painting> test class : 66.26
------------------------------
<Accuracies on sketch> test class : 45.56
------------------------------
Total epoch time: 48.444

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.49
Train epoch time: 16.508
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 50.57
------------------------------
<Accuracies on cartoon> test class : 48.51
------------------------------
<Accuracies on art_painting> test class : 65.67
------------------------------
<Accuracies on sketch> test class : 43.93
------------------------------
Total epoch time: 47.548

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.56
Train epoch time: 17.312
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 52.94
------------------------------
<Accuracies on cartoon> test class : 47.10
------------------------------
<Accuracies on art_painting> test class : 67.58
------------------------------
<Accuracies on sketch> test class : 48.79
------------------------------
Total epoch time: 46.663

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.66
Train epoch time: 18.077
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 51.94
------------------------------
<Accuracies on cartoon> test class : 49.15
------------------------------
<Accuracies on art_painting> test class : 69.14
------------------------------
<Accuracies on sketch> test class : 44.64
------------------------------
Total epoch time: 47.520

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.039, total : 0.039 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.39
Train epoch time: 16.820
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 52.84
------------------------------
<Accuracies on cartoon> test class : 48.93
------------------------------
<Accuracies on art_painting> test class : 69.09
------------------------------
<Accuracies on sketch> test class : 46.70
------------------------------
Total epoch time: 47.913

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.69
Train epoch time: 18.046
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.92
------------------------------
<Accuracies on cartoon> test class : 51.96
------------------------------
<Accuracies on art_painting> test class : 66.41
------------------------------
<Accuracies on sketch> test class : 48.59
------------------------------
Total epoch time: 48.065

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.016, total : 0.016 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.66
Train epoch time: 17.142
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.97
------------------------------
<Accuracies on cartoon> test class : 48.59
------------------------------
<Accuracies on art_painting> test class : 67.68
------------------------------
<Accuracies on sketch> test class : 52.15
------------------------------
Total epoch time: 49.139

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.86
Train epoch time: 16.215
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 51.28
------------------------------
<Accuracies on cartoon> test class : 46.72
------------------------------
<Accuracies on art_painting> test class : 68.36
------------------------------
<Accuracies on sketch> test class : 45.10
------------------------------
Total epoch time: 48.887

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.86
Train epoch time: 15.892
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.00
------------------------------
<Accuracies on cartoon> test class : 48.21
------------------------------
<Accuracies on art_painting> test class : 68.80
------------------------------
<Accuracies on sketch> test class : 45.51
------------------------------
Total epoch time: 48.062

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.93
Train epoch time: 16.952
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.65
------------------------------
<Accuracies on cartoon> test class : 48.38
------------------------------
<Accuracies on art_painting> test class : 68.99
------------------------------
<Accuracies on sketch> test class : 46.68
------------------------------
Total epoch time: 47.961

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.86
Train epoch time: 17.077
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 55.40
------------------------------
<Accuracies on cartoon> test class : 49.62
------------------------------
<Accuracies on art_painting> test class : 69.92
------------------------------
<Accuracies on sketch> test class : 51.29
------------------------------
Total epoch time: 47.822

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.93
Train epoch time: 17.280
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.13
------------------------------
<Accuracies on cartoon> test class : 49.83
------------------------------
<Accuracies on art_painting> test class : 68.36
------------------------------
<Accuracies on sketch> test class : 49.27
------------------------------
Total epoch time: 49.126

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.90
Train epoch time: 16.763
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.79
------------------------------
<Accuracies on cartoon> test class : 50.60
------------------------------
<Accuracies on art_painting> test class : 68.16
------------------------------
<Accuracies on sketch> test class : 50.32
------------------------------
Total epoch time: 47.917

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.97
Train epoch time: 17.447
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.56
------------------------------
<Accuracies on cartoon> test class : 48.89
------------------------------
<Accuracies on art_painting> test class : 68.90
------------------------------
<Accuracies on sketch> test class : 48.36
------------------------------
Total epoch time: 48.174

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 100.00
Train epoch time: 18.086
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.42
------------------------------
<Accuracies on cartoon> test class : 49.10
------------------------------
<Accuracies on art_painting> test class : 68.65
------------------------------
<Accuracies on sketch> test class : 48.05
------------------------------
Total epoch time: 47.077

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.76
Train epoch time: 19.324
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.34
------------------------------
<Accuracies on cartoon> test class : 50.34
------------------------------
<Accuracies on art_painting> test class : 69.04
------------------------------
<Accuracies on sketch> test class : 49.07
------------------------------
Total epoch time: 48.061

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.90
Train epoch time: 19.601
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.46
------------------------------
<Accuracies on cartoon> test class : 50.77
------------------------------
<Accuracies on art_painting> test class : 68.46
------------------------------
<Accuracies on sketch> test class : 47.24
------------------------------
Total epoch time: 49.039

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.76
Train epoch time: 18.422
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 55.28
------------------------------
<Accuracies on cartoon> test class : 52.26
------------------------------
<Accuracies on art_painting> test class : 67.53
------------------------------
<Accuracies on sketch> test class : 50.70
------------------------------
Total epoch time: 49.594

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 100.00
Train epoch time: 17.920
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.73
------------------------------
<Accuracies on cartoon> test class : 50.94
------------------------------
<Accuracies on art_painting> test class : 68.99
------------------------------
<Accuracies on sketch> test class : 49.55
------------------------------
Total epoch time: 49.692

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.93
Train epoch time: 17.532
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.18
------------------------------
<Accuracies on cartoon> test class : 49.74
------------------------------
<Accuracies on art_painting> test class : 67.63
------------------------------
<Accuracies on sketch> test class : 49.81
------------------------------
Total epoch time: 48.560

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.97
Train epoch time: 17.896
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.77
------------------------------
<Accuracies on cartoon> test class : 50.90
------------------------------
<Accuracies on art_painting> test class : 68.07
------------------------------
<Accuracies on sketch> test class : 50.14
------------------------------
Total epoch time: 48.630

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.90
Train epoch time: 18.240
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.00
------------------------------
<Accuracies on cartoon> test class : 50.38
------------------------------
<Accuracies on art_painting> test class : 68.55
------------------------------
<Accuracies on sketch> test class : 48.56
------------------------------
Total epoch time: 48.589

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 99.97
Train epoch time: 17.417
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 55.81
------------------------------
<Accuracies on cartoon> test class : 51.96
------------------------------
<Accuracies on art_painting> test class : 67.87
------------------------------
<Accuracies on sketch> test class : 51.82
------------------------------
Total epoch time: 48.836

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 100.00
Train epoch time: 17.325
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 55.38
------------------------------
<Accuracies on cartoon> test class : 51.28
------------------------------
<Accuracies on art_painting> test class : 68.36
------------------------------
<Accuracies on sketch> test class : 51.06
------------------------------
Total epoch time: 49.556

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 99.97
Train epoch time: 16.404
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 55.13
------------------------------
<Accuracies on cartoon> test class : 51.07
------------------------------
<Accuracies on art_painting> test class : 67.87
------------------------------
<Accuracies on sketch> test class : 50.90
------------------------------
Total epoch time: 49.813

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 15.953
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 55.17
------------------------------
<Accuracies on cartoon> test class : 50.94
------------------------------
<Accuracies on art_painting> test class : 68.65
------------------------------
<Accuracies on sketch> test class : 50.67
------------------------------
Total epoch time: 49.130

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 99.93
Train epoch time: 16.088
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.73
------------------------------
<Accuracies on cartoon> test class : 50.47
------------------------------
<Accuracies on art_painting> test class : 67.63
------------------------------
<Accuracies on sketch> test class : 50.55
------------------------------
Total epoch time: 48.169

******************************
Best val 0.994152, corresponding test 0.528422 - best test: 0.558106

******************************
Best val 0.9941520690917969, corresponding cartoon test 0.48933446407318115

******************************
Best val 0.9941520690917969, corresponding art_painting test 0.69091796875

******************************
Best val 0.9941520690917969, corresponding sketch test 0.46703997254371643
