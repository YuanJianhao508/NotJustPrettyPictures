WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/28 iteration of epoch 1/30] 
 {loss} cls : 2.182, total : 2.182 
 {acc} cls : 8.59
------------------------------
<Losses on train> cls : 1.607, total : 1.607
<Accuracies on train> cls : 62.36
Train epoch time: 59.040
------------------------------
<Accuracies on val> class : 82.21
------------------------------
<Accuracies on test> class : 54.97
------------------------------
<Accuracies on photo> test class : 93.29
------------------------------
<Accuracies on cartoon> test class : 50.38
------------------------------
<Accuracies on sketch> test class : 41.41
------------------------------
Total epoch time: 87.133

New epoch - lr: 0.003
[1/28 iteration of epoch 2/30] 
 {loss} cls : 0.536, total : 0.536 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.372, total : 0.372
<Accuracies on train> cls : 88.11
Train epoch time: 43.263
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 61.66
------------------------------
<Accuracies on photo> test class : 96.35
------------------------------
<Accuracies on cartoon> test class : 58.58
------------------------------
<Accuracies on sketch> test class : 48.77
------------------------------
Total epoch time: 71.447

New epoch - lr: 0.003
[1/28 iteration of epoch 3/30] 
 {loss} cls : 0.250, total : 0.250 
 {acc} cls : 91.41
------------------------------
<Losses on train> cls : 0.194, total : 0.194
<Accuracies on train> cls : 93.30
Train epoch time: 49.731
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 65.54
------------------------------
<Accuracies on photo> test class : 96.59
------------------------------
<Accuracies on cartoon> test class : 59.04
------------------------------
<Accuracies on sketch> test class : 56.22
------------------------------
Total epoch time: 77.686

New epoch - lr: 0.003
[1/28 iteration of epoch 4/30] 
 {loss} cls : 0.096, total : 0.096 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.141, total : 0.141
<Accuracies on train> cls : 95.26
Train epoch time: 40.294
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 63.89
------------------------------
<Accuracies on photo> test class : 95.81
------------------------------
<Accuracies on cartoon> test class : 60.75
------------------------------
<Accuracies on sketch> test class : 52.20
------------------------------
Total epoch time: 69.083

New epoch - lr: 0.003
[1/28 iteration of epoch 5/30] 
 {loss} cls : 0.108, total : 0.108 
 {acc} cls : 94.53
------------------------------
<Losses on train> cls : 0.111, total : 0.111
<Accuracies on train> cls : 96.04
Train epoch time: 29.711
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 66.73
------------------------------
<Accuracies on photo> test class : 95.51
------------------------------
<Accuracies on cartoon> test class : 62.76
------------------------------
<Accuracies on sketch> test class : 56.86
------------------------------
Total epoch time: 58.515

New epoch - lr: 0.003
[1/28 iteration of epoch 6/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.083, total : 0.083
<Accuracies on train> cls : 97.18
Train epoch time: 25.723
------------------------------
<Accuracies on val> class : 91.35
------------------------------
<Accuracies on test> class : 66.18
------------------------------
<Accuracies on photo> test class : 95.81
------------------------------
<Accuracies on cartoon> test class : 62.80
------------------------------
<Accuracies on sketch> test class : 55.61
------------------------------
Total epoch time: 53.655

New epoch - lr: 0.003
[1/28 iteration of epoch 7/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.059, total : 0.059
<Accuracies on train> cls : 98.19
Train epoch time: 24.252
------------------------------
<Accuracies on val> class : 89.90
------------------------------
<Accuracies on test> class : 64.40
------------------------------
<Accuracies on photo> test class : 96.41
------------------------------
<Accuracies on cartoon> test class : 61.65
------------------------------
<Accuracies on sketch> test class : 52.43
------------------------------
Total epoch time: 52.773

New epoch - lr: 0.003
[1/28 iteration of epoch 8/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.41
Train epoch time: 23.025
------------------------------
<Accuracies on val> class : 89.42
------------------------------
<Accuracies on test> class : 63.99
------------------------------
<Accuracies on photo> test class : 96.11
------------------------------
<Accuracies on cartoon> test class : 62.12
------------------------------
<Accuracies on sketch> test class : 51.46
------------------------------
Total epoch time: 52.638

New epoch - lr: 0.003
[1/28 iteration of epoch 9/30] 
 {loss} cls : 0.022, total : 0.022 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.051, total : 0.051
<Accuracies on train> cls : 98.16
Train epoch time: 21.911
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 63.31
------------------------------
<Accuracies on photo> test class : 96.17
------------------------------
<Accuracies on cartoon> test class : 61.26
------------------------------
<Accuracies on sketch> test class : 50.57
------------------------------
Total epoch time: 51.360

New epoch - lr: 0.003
[1/28 iteration of epoch 10/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.042, total : 0.042
<Accuracies on train> cls : 98.66
Train epoch time: 21.721
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 63.48
------------------------------
<Accuracies on photo> test class : 96.53
------------------------------
<Accuracies on cartoon> test class : 64.16
------------------------------
<Accuracies on sketch> test class : 49.02
------------------------------
Total epoch time: 50.858

New epoch - lr: 0.003
[1/28 iteration of epoch 11/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.16
Train epoch time: 22.185
------------------------------
<Accuracies on val> class : 89.42
------------------------------
<Accuracies on test> class : 65.24
------------------------------
<Accuracies on photo> test class : 95.93
------------------------------
<Accuracies on cartoon> test class : 61.35
------------------------------
<Accuracies on sketch> test class : 54.52
------------------------------
Total epoch time: 50.694

New epoch - lr: 0.003
[1/28 iteration of epoch 12/30] 
 {loss} cls : 0.055, total : 0.055 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.14
Train epoch time: 22.522
------------------------------
<Accuracies on val> class : 91.35
------------------------------
<Accuracies on test> class : 66.34
------------------------------
<Accuracies on photo> test class : 96.35
------------------------------
<Accuracies on cartoon> test class : 63.78
------------------------------
<Accuracies on sketch> test class : 55.10
------------------------------
Total epoch time: 50.783

New epoch - lr: 0.003
[1/28 iteration of epoch 13/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.30
Train epoch time: 22.701
------------------------------
<Accuracies on val> class : 89.42
------------------------------
<Accuracies on test> class : 64.32
------------------------------
<Accuracies on photo> test class : 95.39
------------------------------
<Accuracies on cartoon> test class : 61.35
------------------------------
<Accuracies on sketch> test class : 52.89
------------------------------
Total epoch time: 50.582

New epoch - lr: 0.003
[1/28 iteration of epoch 14/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.50
Train epoch time: 22.483
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 63.28
------------------------------
<Accuracies on photo> test class : 96.17
------------------------------
<Accuracies on cartoon> test class : 60.71
------------------------------
<Accuracies on sketch> test class : 50.83
------------------------------
Total epoch time: 50.890

New epoch - lr: 0.003
[1/28 iteration of epoch 15/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.44
Train epoch time: 23.109
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 63.75
------------------------------
<Accuracies on photo> test class : 96.11
------------------------------
<Accuracies on cartoon> test class : 61.39
------------------------------
<Accuracies on sketch> test class : 51.41
------------------------------
Total epoch time: 52.100

New epoch - lr: 0.003
[1/28 iteration of epoch 16/30] 
 {loss} cls : 0.030, total : 0.030 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.47
Train epoch time: 21.826
------------------------------
<Accuracies on val> class : 90.38
------------------------------
<Accuracies on test> class : 65.30
------------------------------
<Accuracies on photo> test class : 96.23
------------------------------
<Accuracies on cartoon> test class : 62.93
------------------------------
<Accuracies on sketch> test class : 53.58
------------------------------
Total epoch time: 50.903

New epoch - lr: 0.003
[1/28 iteration of epoch 17/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.47
Train epoch time: 21.106
------------------------------
<Accuracies on val> class : 92.79
------------------------------
<Accuracies on test> class : 64.75
------------------------------
<Accuracies on photo> test class : 96.65
------------------------------
<Accuracies on cartoon> test class : 61.60
------------------------------
<Accuracies on sketch> test class : 53.07
------------------------------
Total epoch time: 51.343

New epoch - lr: 0.003
[1/28 iteration of epoch 18/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.55
Train epoch time: 20.764
------------------------------
<Accuracies on val> class : 91.35
------------------------------
<Accuracies on test> class : 64.96
------------------------------
<Accuracies on photo> test class : 95.93
------------------------------
<Accuracies on cartoon> test class : 62.46
------------------------------
<Accuracies on sketch> test class : 53.30
------------------------------
Total epoch time: 50.600

New epoch - lr: 0.003
[1/28 iteration of epoch 19/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.019, total : 0.019
<Accuracies on train> cls : 99.41
Train epoch time: 20.176
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 67.29
------------------------------
<Accuracies on photo> test class : 95.57
------------------------------
<Accuracies on cartoon> test class : 64.08
------------------------------
<Accuracies on sketch> test class : 57.19
------------------------------
Total epoch time: 50.562

New epoch - lr: 0.003
[1/28 iteration of epoch 20/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.61
Train epoch time: 20.303
------------------------------
<Accuracies on val> class : 92.79
------------------------------
<Accuracies on test> class : 62.99
------------------------------
<Accuracies on photo> test class : 96.29
------------------------------
<Accuracies on cartoon> test class : 60.03
------------------------------
<Accuracies on sketch> test class : 50.60
------------------------------
Total epoch time: 51.735

New epoch - lr: 0.003
[1/28 iteration of epoch 21/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.89
Train epoch time: 20.147
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 65.67
------------------------------
<Accuracies on photo> test class : 95.57
------------------------------
<Accuracies on cartoon> test class : 63.10
------------------------------
<Accuracies on sketch> test class : 54.49
------------------------------
Total epoch time: 51.345

New epoch - lr: 0.003
[1/28 iteration of epoch 22/30] 
 {loss} cls : 0.042, total : 0.042 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.64
Train epoch time: 19.921
------------------------------
<Accuracies on val> class : 92.31
------------------------------
<Accuracies on test> class : 64.95
------------------------------
<Accuracies on photo> test class : 95.87
------------------------------
<Accuracies on cartoon> test class : 62.12
------------------------------
<Accuracies on sketch> test class : 53.50
------------------------------
Total epoch time: 50.389

New epoch - lr: 0.003
[1/28 iteration of epoch 23/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.64
Train epoch time: 19.742
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 64.90
------------------------------
<Accuracies on photo> test class : 95.99
------------------------------
<Accuracies on cartoon> test class : 62.33
------------------------------
<Accuracies on sketch> test class : 53.22
------------------------------
Total epoch time: 50.067

New epoch - lr: 0.003
[1/28 iteration of epoch 24/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.72
Train epoch time: 20.136
------------------------------
<Accuracies on val> class : 92.31
------------------------------
<Accuracies on test> class : 65.23
------------------------------
<Accuracies on photo> test class : 95.99
------------------------------
<Accuracies on cartoon> test class : 63.23
------------------------------
<Accuracies on sketch> test class : 53.35
------------------------------
Total epoch time: 50.180

New epoch - lr: 0.003
[1/28 iteration of epoch 25/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.67
Train epoch time: 20.535
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 66.20
------------------------------
<Accuracies on photo> test class : 95.99
------------------------------
<Accuracies on cartoon> test class : 63.82
------------------------------
<Accuracies on sketch> test class : 54.95
------------------------------
Total epoch time: 50.545

New epoch - lr: 0.003
[1/28 iteration of epoch 26/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.39
Train epoch time: 21.366
------------------------------
<Accuracies on val> class : 90.87
------------------------------
<Accuracies on test> class : 64.57
------------------------------
<Accuracies on photo> test class : 96.29
------------------------------
<Accuracies on cartoon> test class : 62.63
------------------------------
<Accuracies on sketch> test class : 52.25
------------------------------
Total epoch time: 51.087

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 27/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.86
Train epoch time: 21.127
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 66.51
------------------------------
<Accuracies on photo> test class : 96.17
------------------------------
<Accuracies on cartoon> test class : 64.55
------------------------------
<Accuracies on sketch> test class : 55.08
------------------------------
Total epoch time: 50.618

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 28/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.83
Train epoch time: 21.670
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 65.63
------------------------------
<Accuracies on photo> test class : 96.47
------------------------------
<Accuracies on cartoon> test class : 62.76
------------------------------
<Accuracies on sketch> test class : 54.24
------------------------------
Total epoch time: 50.664

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 29/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.78
Train epoch time: 21.478
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 66.99
------------------------------
<Accuracies on photo> test class : 96.29
------------------------------
<Accuracies on cartoon> test class : 64.80
------------------------------
<Accuracies on sketch> test class : 55.84
------------------------------
Total epoch time: 48.809

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 30/30] 
 {loss} cls : 0.024, total : 0.024 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.80
Train epoch time: 20.987
------------------------------
<Accuracies on val> class : 91.83
------------------------------
<Accuracies on test> class : 66.59
------------------------------
<Accuracies on photo> test class : 96.53
------------------------------
<Accuracies on cartoon> test class : 64.76
------------------------------
<Accuracies on sketch> test class : 54.95
------------------------------
Total epoch time: 48.432

******************************
Best val 0.927885, corresponding test 0.629863 - best test: 0.67292

******************************
Best val 0.9278846383094788, corresponding photo test 0.9628742337226868

******************************
Best val 0.9278846383094788, corresponding cartoon test 0.6002559661865234

******************************
Best val 0.9278846383094788, corresponding sketch test 0.5059811472892761
