WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/32 iteration of epoch 1/30] 
 {loss} cls : 2.092, total : 2.092 
 {acc} cls : 11.72
[31/32 iteration of epoch 1/30] 
 {loss} cls : 0.593, total : 0.593 
 {acc} cls : 80.47
------------------------------
<Losses on train> cls : 1.504, total : 1.504
<Accuracies on train> cls : 63.48
Train epoch time: 62.364
------------------------------
<Accuracies on val> class : 86.08
------------------------------
<Accuracies on test> class : 62.65
------------------------------
<Accuracies on photo> test class : 82.28
------------------------------
<Accuracies on art_painting> test class : 58.94
------------------------------
<Accuracies on sketch> test class : 56.25
------------------------------
Total epoch time: 91.136

New epoch - lr: 0.003
[1/32 iteration of epoch 2/30] 
 {loss} cls : 0.458, total : 0.458 
 {acc} cls : 85.16
[31/32 iteration of epoch 2/30] 
 {loss} cls : 0.412, total : 0.412 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.322, total : 0.322
<Accuracies on train> cls : 89.09
Train epoch time: 44.056
------------------------------
<Accuracies on val> class : 90.72
------------------------------
<Accuracies on test> class : 66.75
------------------------------
<Accuracies on photo> test class : 86.11
------------------------------
<Accuracies on art_painting> test class : 59.62
------------------------------
<Accuracies on sketch> test class : 62.23
------------------------------
Total epoch time: 71.950

New epoch - lr: 0.003
[1/32 iteration of epoch 3/30] 
 {loss} cls : 0.141, total : 0.141 
 {acc} cls : 93.75
[31/32 iteration of epoch 3/30] 
 {loss} cls : 0.271, total : 0.271 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.176, total : 0.176
<Accuracies on train> cls : 93.36
Train epoch time: 49.736
------------------------------
<Accuracies on val> class : 90.30
------------------------------
<Accuracies on test> class : 71.99
------------------------------
<Accuracies on photo> test class : 88.50
------------------------------
<Accuracies on art_painting> test class : 68.26
------------------------------
<Accuracies on sketch> test class : 66.91
------------------------------
Total epoch time: 76.855

New epoch - lr: 0.003
[1/32 iteration of epoch 4/30] 
 {loss} cls : 0.072, total : 0.072 
 {acc} cls : 97.66
[31/32 iteration of epoch 4/30] 
 {loss} cls : 0.250, total : 0.250 
 {acc} cls : 92.97
------------------------------
<Losses on train> cls : 0.148, total : 0.148
<Accuracies on train> cls : 94.95
Train epoch time: 41.204
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 67.49
------------------------------
<Accuracies on photo> test class : 85.27
------------------------------
<Accuracies on art_painting> test class : 61.13
------------------------------
<Accuracies on sketch> test class : 63.25
------------------------------
Total epoch time: 69.116

New epoch - lr: 0.003
[1/32 iteration of epoch 5/30] 
 {loss} cls : 0.100, total : 0.100 
 {acc} cls : 96.88
[31/32 iteration of epoch 5/30] 
 {loss} cls : 0.075, total : 0.075 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.097, total : 0.097
<Accuracies on train> cls : 96.56
Train epoch time: 29.555
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 65.70
------------------------------
<Accuracies on photo> test class : 82.40
------------------------------
<Accuracies on art_painting> test class : 62.11
------------------------------
<Accuracies on sketch> test class : 60.47
------------------------------
Total epoch time: 57.595

New epoch - lr: 0.003
[1/32 iteration of epoch 6/30] 
 {loss} cls : 0.131, total : 0.131 
 {acc} cls : 96.09
[31/32 iteration of epoch 6/30] 
 {loss} cls : 0.104, total : 0.104 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.076, total : 0.076
<Accuracies on train> cls : 97.24
Train epoch time: 27.004
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 66.93
------------------------------
<Accuracies on photo> test class : 86.53
------------------------------
<Accuracies on art_painting> test class : 67.87
------------------------------
<Accuracies on sketch> test class : 58.11
------------------------------
Total epoch time: 54.828

New epoch - lr: 0.003
[1/32 iteration of epoch 7/30] 
 {loss} cls : 0.048, total : 0.048 
 {acc} cls : 98.44
[31/32 iteration of epoch 7/30] 
 {loss} cls : 0.047, total : 0.047 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.049, total : 0.049
<Accuracies on train> cls : 98.32
Train epoch time: 25.486
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 69.43
------------------------------
<Accuracies on photo> test class : 85.87
------------------------------
<Accuracies on art_painting> test class : 68.21
------------------------------
<Accuracies on sketch> test class : 63.07
------------------------------
Total epoch time: 53.160

New epoch - lr: 0.003
[1/32 iteration of epoch 8/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 100.00
[31/32 iteration of epoch 8/30] 
 {loss} cls : 0.076, total : 0.076 
 {acc} cls : 97.66
------------------------------
<Losses on train> cls : 0.059, total : 0.059
<Accuracies on train> cls : 97.71
Train epoch time: 24.039
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 72.43
------------------------------
<Accuracies on photo> test class : 88.20
------------------------------
<Accuracies on art_painting> test class : 70.21
------------------------------
<Accuracies on sketch> test class : 66.89
------------------------------
Total epoch time: 52.683

New epoch - lr: 0.003
[1/32 iteration of epoch 9/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
[31/32 iteration of epoch 9/30] 
 {loss} cls : 0.022, total : 0.022 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 99.12
Train epoch time: 22.404
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 69.83
------------------------------
<Accuracies on photo> test class : 86.95
------------------------------
<Accuracies on art_painting> test class : 69.87
------------------------------
<Accuracies on sketch> test class : 62.53
------------------------------
Total epoch time: 51.204

New epoch - lr: 0.003
[1/32 iteration of epoch 10/30] 
 {loss} cls : 0.041, total : 0.041 
 {acc} cls : 98.44
[31/32 iteration of epoch 10/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.32
Train epoch time: 21.918
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 70.77
------------------------------
<Accuracies on photo> test class : 87.96
------------------------------
<Accuracies on art_painting> test class : 70.65
------------------------------
<Accuracies on sketch> test class : 63.53
------------------------------
Total epoch time: 51.523

New epoch - lr: 0.003
[1/32 iteration of epoch 11/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 99.22
[31/32 iteration of epoch 11/30] 
 {loss} cls : 0.022, total : 0.022 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.49
Train epoch time: 21.788
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 70.52
------------------------------
<Accuracies on photo> test class : 86.47
------------------------------
<Accuracies on art_painting> test class : 69.68
------------------------------
<Accuracies on sketch> test class : 64.19
------------------------------
Total epoch time: 51.084

New epoch - lr: 0.003
[1/32 iteration of epoch 12/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 99.22
[31/32 iteration of epoch 12/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.49
Train epoch time: 22.188
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 70.73
------------------------------
<Accuracies on photo> test class : 87.31
------------------------------
<Accuracies on art_painting> test class : 71.00
------------------------------
<Accuracies on sketch> test class : 63.55
------------------------------
Total epoch time: 51.113

New epoch - lr: 0.003
[1/32 iteration of epoch 13/30] 
 {loss} cls : 0.028, total : 0.028 
 {acc} cls : 98.44
[31/32 iteration of epoch 13/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.56
Train epoch time: 22.890
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 72.43
------------------------------
<Accuracies on photo> test class : 87.31
------------------------------
<Accuracies on art_painting> test class : 70.75
------------------------------
<Accuracies on sketch> test class : 66.99
------------------------------
Total epoch time: 51.124

New epoch - lr: 0.003
[1/32 iteration of epoch 14/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
[31/32 iteration of epoch 14/30] 
 {loss} cls : 0.039, total : 0.039 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.58
Train epoch time: 22.562
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 73.14
------------------------------
<Accuracies on photo> test class : 88.62
------------------------------
<Accuracies on art_painting> test class : 72.31
------------------------------
<Accuracies on sketch> test class : 66.99
------------------------------
Total epoch time: 50.655

New epoch - lr: 0.003
[1/32 iteration of epoch 15/30] 
 {loss} cls : 0.017, total : 0.017 
 {acc} cls : 100.00
[31/32 iteration of epoch 15/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.68
Train epoch time: 23.243
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 72.71
------------------------------
<Accuracies on photo> test class : 87.31
------------------------------
<Accuracies on art_painting> test class : 69.87
------------------------------
<Accuracies on sketch> test class : 67.98
------------------------------
Total epoch time: 50.660

New epoch - lr: 0.003
[1/32 iteration of epoch 16/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 100.00
[31/32 iteration of epoch 16/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.54
Train epoch time: 22.068
------------------------------
<Accuracies on val> class : 95.36
------------------------------
<Accuracies on test> class : 70.97
------------------------------
<Accuracies on photo> test class : 86.89
------------------------------
<Accuracies on art_painting> test class : 69.09
------------------------------
<Accuracies on sketch> test class : 65.18
------------------------------
Total epoch time: 50.588

New epoch - lr: 0.003
[1/32 iteration of epoch 17/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/32 iteration of epoch 17/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.80
Train epoch time: 22.255
------------------------------
<Accuracies on val> class : 95.36
------------------------------
<Accuracies on test> class : 70.26
------------------------------
<Accuracies on photo> test class : 86.41
------------------------------
<Accuracies on art_painting> test class : 68.75
------------------------------
<Accuracies on sketch> test class : 64.19
------------------------------
Total epoch time: 51.071

New epoch - lr: 0.003
[1/32 iteration of epoch 18/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
[31/32 iteration of epoch 18/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.88
Train epoch time: 21.786
------------------------------
<Accuracies on val> class : 95.36
------------------------------
<Accuracies on test> class : 69.84
------------------------------
<Accuracies on photo> test class : 86.41
------------------------------
<Accuracies on art_painting> test class : 68.16
------------------------------
<Accuracies on sketch> test class : 63.68
------------------------------
Total epoch time: 51.531

New epoch - lr: 0.003
[1/32 iteration of epoch 19/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 99.22
[31/32 iteration of epoch 19/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.73
Train epoch time: 20.964
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 71.83
------------------------------
<Accuracies on photo> test class : 88.38
------------------------------
<Accuracies on art_painting> test class : 69.43
------------------------------
<Accuracies on sketch> test class : 66.05
------------------------------
Total epoch time: 50.321

New epoch - lr: 0.003
[1/32 iteration of epoch 20/30] 
 {loss} cls : 0.029, total : 0.029 
 {acc} cls : 99.22
[31/32 iteration of epoch 20/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.66
Train epoch time: 20.921
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 70.83
------------------------------
<Accuracies on photo> test class : 86.95
------------------------------
<Accuracies on art_painting> test class : 66.55
------------------------------
<Accuracies on sketch> test class : 66.20
------------------------------
Total epoch time: 50.718

New epoch - lr: 0.003
[1/32 iteration of epoch 21/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 21/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.78
Train epoch time: 21.206
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 71.13
------------------------------
<Accuracies on photo> test class : 87.49
------------------------------
<Accuracies on art_painting> test class : 68.41
------------------------------
<Accuracies on sketch> test class : 65.59
------------------------------
Total epoch time: 51.555

New epoch - lr: 0.003
[1/32 iteration of epoch 22/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/32 iteration of epoch 22/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.66
Train epoch time: 20.784
------------------------------
<Accuracies on val> class : 95.78
------------------------------
<Accuracies on test> class : 67.11
------------------------------
<Accuracies on photo> test class : 85.51
------------------------------
<Accuracies on art_painting> test class : 65.14
------------------------------
<Accuracies on sketch> test class : 60.32
------------------------------
Total epoch time: 51.536

New epoch - lr: 0.003
[1/32 iteration of epoch 23/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 23/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.83
Train epoch time: 20.518
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 66.13
------------------------------
<Accuracies on photo> test class : 86.11
------------------------------
<Accuracies on art_painting> test class : 65.43
------------------------------
<Accuracies on sketch> test class : 58.00
------------------------------
Total epoch time: 51.264

New epoch - lr: 0.003
[1/32 iteration of epoch 24/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
[31/32 iteration of epoch 24/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.63
Train epoch time: 20.086
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 69.30
------------------------------
<Accuracies on photo> test class : 86.35
------------------------------
<Accuracies on art_painting> test class : 68.26
------------------------------
<Accuracies on sketch> test class : 62.59
------------------------------
Total epoch time: 50.790

New epoch - lr: 0.003
[1/32 iteration of epoch 25/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 25/30] 
 {loss} cls : 0.015, total : 0.015 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.83
Train epoch time: 20.632
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 67.97
------------------------------
<Accuracies on photo> test class : 87.13
------------------------------
<Accuracies on art_painting> test class : 69.97
------------------------------
<Accuracies on sketch> test class : 58.79
------------------------------
Total epoch time: 50.676

New epoch - lr: 0.003
[1/32 iteration of epoch 26/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 26/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.88
Train epoch time: 20.487
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 69.79
------------------------------
<Accuracies on photo> test class : 87.66
------------------------------
<Accuracies on art_painting> test class : 70.26
------------------------------
<Accuracies on sketch> test class : 61.95
------------------------------
Total epoch time: 49.967

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 27/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
[31/32 iteration of epoch 27/30] 
 {loss} cls : 0.028, total : 0.028 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.88
Train epoch time: 21.044
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 68.34
------------------------------
<Accuracies on photo> test class : 87.49
------------------------------
<Accuracies on art_painting> test class : 68.70
------------------------------
<Accuracies on sketch> test class : 60.02
------------------------------
Total epoch time: 50.279

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 28/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 28/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.88
Train epoch time: 21.928
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 69.16
------------------------------
<Accuracies on photo> test class : 87.19
------------------------------
<Accuracies on art_painting> test class : 69.24
------------------------------
<Accuracies on sketch> test class : 61.47
------------------------------
Total epoch time: 50.796

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 29/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/32 iteration of epoch 29/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.85
Train epoch time: 22.488
------------------------------
<Accuracies on val> class : 95.36
------------------------------
<Accuracies on test> class : 68.13
------------------------------
<Accuracies on photo> test class : 86.65
------------------------------
<Accuracies on art_painting> test class : 67.97
------------------------------
<Accuracies on sketch> test class : 60.35
------------------------------
Total epoch time: 48.907

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 30/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/32 iteration of epoch 30/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.85
Train epoch time: 21.186
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 70.68
------------------------------
<Accuracies on photo> test class : 87.72
------------------------------
<Accuracies on art_painting> test class : 69.58
------------------------------
<Accuracies on sketch> test class : 64.01
------------------------------
Total epoch time: 46.971

******************************
Best val 0.957806, corresponding test 0.671113 - best test: 0.731398

******************************
Best val 0.9578059315681458, corresponding photo test 0.8550898432731628

******************************
Best val 0.9578059315681458, corresponding art_painting test 0.6513671875

******************************
Best val 0.9578059315681458, corresponding sketch test 0.6032069325447083
