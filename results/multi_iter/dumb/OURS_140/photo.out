
Loading experiment PACS/ResNet18_step

Sample Strategy: all

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.168, total : 2.168 
 {acc} cls : 7.81
------------------------------
<Losses on train> cls : 0.635, total : 0.635
<Accuracies on train> cls : 80.03
Train epoch time: 17.950
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 44.59
------------------------------
<Accuracies on cartoon> test class : 38.10
------------------------------
<Accuracies on art_painting> test class : 66.55
------------------------------
<Accuracies on sketch> test class : 37.01
------------------------------
Total epoch time: 49.321

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.032, total : 0.032 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.54
Train epoch time: 17.203
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 46.36
------------------------------
<Accuracies on cartoon> test class : 37.41
------------------------------
<Accuracies on art_painting> test class : 65.97
------------------------------
<Accuracies on sketch> test class : 41.49
------------------------------
Total epoch time: 47.652

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 98.98
Train epoch time: 17.488
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 46.94
------------------------------
<Accuracies on cartoon> test class : 39.25
------------------------------
<Accuracies on art_painting> test class : 62.99
------------------------------
<Accuracies on sketch> test class : 43.17
------------------------------
Total epoch time: 47.433

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.29
Train epoch time: 16.811
------------------------------
<Accuracies on val> class : 97.66
------------------------------
<Accuracies on test> class : 50.61
------------------------------
<Accuracies on cartoon> test class : 43.94
------------------------------
<Accuracies on art_painting> test class : 66.80
------------------------------
<Accuracies on sketch> test class : 46.14
------------------------------
Total epoch time: 48.026

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.52
Train epoch time: 15.991
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 48.64
------------------------------
<Accuracies on cartoon> test class : 41.77
------------------------------
<Accuracies on art_painting> test class : 66.85
------------------------------
<Accuracies on sketch> test class : 43.24
------------------------------
Total epoch time: 47.631

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.028, total : 0.028 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.52
Train epoch time: 17.600
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 47.01
------------------------------
<Accuracies on cartoon> test class : 44.33
------------------------------
<Accuracies on art_painting> test class : 63.57
------------------------------
<Accuracies on sketch> test class : 39.98
------------------------------
Total epoch time: 47.364

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.52
Train epoch time: 18.601
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 50.40
------------------------------
<Accuracies on cartoon> test class : 42.96
------------------------------
<Accuracies on art_painting> test class : 67.24
------------------------------
<Accuracies on sketch> test class : 46.07
------------------------------
Total epoch time: 50.141

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.52
Train epoch time: 18.149
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 51.82
------------------------------
<Accuracies on cartoon> test class : 47.57
------------------------------
<Accuracies on art_painting> test class : 68.07
------------------------------
<Accuracies on sketch> test class : 45.89
------------------------------
Total epoch time: 50.245

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.73
Train epoch time: 18.296
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 50.47
------------------------------
<Accuracies on cartoon> test class : 46.97
------------------------------
<Accuracies on art_painting> test class : 64.70
------------------------------
<Accuracies on sketch> test class : 45.15
------------------------------
Total epoch time: 48.881

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.73
Train epoch time: 18.191
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 50.59
------------------------------
<Accuracies on cartoon> test class : 42.79
------------------------------
<Accuracies on art_painting> test class : 68.02
------------------------------
<Accuracies on sketch> test class : 46.17
------------------------------
Total epoch time: 49.749

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.80
Train epoch time: 17.991
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 48.97
------------------------------
<Accuracies on cartoon> test class : 46.25
------------------------------
<Accuracies on art_painting> test class : 68.26
------------------------------
<Accuracies on sketch> test class : 40.54
------------------------------
Total epoch time: 50.614

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.80
Train epoch time: 17.051
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 48.71
------------------------------
<Accuracies on cartoon> test class : 43.90
------------------------------
<Accuracies on art_painting> test class : 67.58
------------------------------
<Accuracies on sketch> test class : 41.74
------------------------------
Total epoch time: 49.595

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.90
Train epoch time: 16.383
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 49.61
------------------------------
<Accuracies on cartoon> test class : 45.52
------------------------------
<Accuracies on art_painting> test class : 68.21
------------------------------
<Accuracies on sketch> test class : 42.35
------------------------------
Total epoch time: 49.035

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 100.00
Train epoch time: 17.643
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 49.25
------------------------------
<Accuracies on cartoon> test class : 46.67
------------------------------
<Accuracies on art_painting> test class : 68.02
------------------------------
<Accuracies on sketch> test class : 41.00
------------------------------
Total epoch time: 49.142

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.80
Train epoch time: 17.658
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 50.64
------------------------------
<Accuracies on cartoon> test class : 49.49
------------------------------
<Accuracies on art_painting> test class : 68.95
------------------------------
<Accuracies on sketch> test class : 41.79
------------------------------
Total epoch time: 50.003

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.93
Train epoch time: 17.397
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 50.25
------------------------------
<Accuracies on cartoon> test class : 50.17
------------------------------
<Accuracies on art_painting> test class : 66.99
------------------------------
<Accuracies on sketch> test class : 41.56
------------------------------
Total epoch time: 50.058

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.83
Train epoch time: 16.930
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 52.18
------------------------------
<Accuracies on cartoon> test class : 46.72
------------------------------
<Accuracies on art_painting> test class : 68.31
------------------------------
<Accuracies on sketch> test class : 47.03
------------------------------
Total epoch time: 51.552

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.90
Train epoch time: 16.838
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 50.87
------------------------------
<Accuracies on cartoon> test class : 47.27
------------------------------
<Accuracies on art_painting> test class : 68.95
------------------------------
<Accuracies on sketch> test class : 43.60
------------------------------
Total epoch time: 50.921

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.86
Train epoch time: 16.408
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.45
------------------------------
<Accuracies on cartoon> test class : 49.40
------------------------------
<Accuracies on art_painting> test class : 67.19
------------------------------
<Accuracies on sketch> test class : 46.58
------------------------------
Total epoch time: 50.443

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.93
Train epoch time: 16.381
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.38
------------------------------
<Accuracies on cartoon> test class : 50.04
------------------------------
<Accuracies on art_painting> test class : 68.07
------------------------------
<Accuracies on sketch> test class : 47.72
------------------------------
Total epoch time: 49.405

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.90
Train epoch time: 17.256
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.09
------------------------------
<Accuracies on cartoon> test class : 48.85
------------------------------
<Accuracies on art_painting> test class : 67.48
------------------------------
<Accuracies on sketch> test class : 45.99
------------------------------
Total epoch time: 49.281

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 99.97
Train epoch time: 17.659
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.40
------------------------------
<Accuracies on cartoon> test class : 49.06
------------------------------
<Accuracies on art_painting> test class : 66.85
------------------------------
<Accuracies on sketch> test class : 46.86
------------------------------
Total epoch time: 49.200

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.002, total : 0.002
<Accuracies on train> cls : 99.97
Train epoch time: 17.863
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 54.55
------------------------------
<Accuracies on cartoon> test class : 49.27
------------------------------
<Accuracies on art_painting> test class : 68.16
------------------------------
<Accuracies on sketch> test class : 50.60
------------------------------
Total epoch time: 49.294

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 17.714
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.06
------------------------------
<Accuracies on cartoon> test class : 48.72
------------------------------
<Accuracies on art_painting> test class : 68.60
------------------------------
<Accuracies on sketch> test class : 47.54
------------------------------
Total epoch time: 49.685

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.003, total : 0.003
<Accuracies on train> cls : 99.97
Train epoch time: 16.963
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.72
------------------------------
<Accuracies on cartoon> test class : 47.87
------------------------------
<Accuracies on art_painting> test class : 66.89
------------------------------
<Accuracies on sketch> test class : 48.23
------------------------------
Total epoch time: 51.464

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 16.596
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.48
------------------------------
<Accuracies on cartoon> test class : 48.38
------------------------------
<Accuracies on art_painting> test class : 67.97
------------------------------
<Accuracies on sketch> test class : 48.97
------------------------------
Total epoch time: 50.630

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 16.427
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.42
------------------------------
<Accuracies on cartoon> test class : 49.27
------------------------------
<Accuracies on art_painting> test class : 67.43
------------------------------
<Accuracies on sketch> test class : 48.59
------------------------------
Total epoch time: 50.841

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 16.586
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 53.32
------------------------------
<Accuracies on cartoon> test class : 48.34
------------------------------
<Accuracies on art_painting> test class : 68.51
------------------------------
<Accuracies on sketch> test class : 48.38
------------------------------
Total epoch time: 49.818

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 17.367
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.82
------------------------------
<Accuracies on cartoon> test class : 48.25
------------------------------
<Accuracies on art_painting> test class : 68.26
------------------------------
<Accuracies on sketch> test class : 47.49
------------------------------
Total epoch time: 49.488

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.001, total : 0.001
<Accuracies on train> cls : 100.00
Train epoch time: 17.393
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 52.90
------------------------------
<Accuracies on cartoon> test class : 48.38
------------------------------
<Accuracies on art_painting> test class : 68.85
------------------------------
<Accuracies on sketch> test class : 47.29
------------------------------
Total epoch time: 48.437

******************************
Best val 0.994152, corresponding test 0.518207 - best test: 0.545487

******************************
Best val 0.9941520690917969, corresponding cartoon test 0.4756825864315033

******************************
Best val 0.9941520690917969, corresponding art_painting test 0.6806640625

******************************
Best val 0.9941520690917969, corresponding sketch test 0.45889538526535034
