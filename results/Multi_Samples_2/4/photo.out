
Loading experiment PACS/ResNet18_step

Sample Strategy: all_m

New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.096, total : 2.096 
 {acc} cls : 6.25
------------------------------
<Losses on train> cls : 0.735, total : 0.735
<Accuracies on train> cls : 79.38
Train epoch time: 10.726
------------------------------
<Accuracies on val> class : 95.32
------------------------------
<Accuracies on test> class : 53.80
------------------------------
<Accuracies on cartoon> test class : 56.36
------------------------------
<Accuracies on art_painting> test class : 61.08
------------------------------
<Accuracies on sketch> test class : 48.49
------------------------------
Total epoch time: 28.077

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.059, total : 0.059 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.072, total : 0.072
<Accuracies on train> cls : 97.35
Train epoch time: 10.305
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 61.28
------------------------------
<Accuracies on cartoon> test class : 62.03
------------------------------
<Accuracies on art_painting> test class : 66.65
------------------------------
<Accuracies on sketch> test class : 58.03
------------------------------
Total epoch time: 27.919

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.055, total : 0.055
<Accuracies on train> cls : 97.96
Train epoch time: 10.384
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 64.90
------------------------------
<Accuracies on cartoon> test class : 65.15
------------------------------
<Accuracies on art_painting> test class : 69.53
------------------------------
<Accuracies on sketch> test class : 62.33
------------------------------
Total epoch time: 27.418

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.30
Train epoch time: 10.472
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 64.69
------------------------------
<Accuracies on cartoon> test class : 66.55
------------------------------
<Accuracies on art_painting> test class : 68.85
------------------------------
<Accuracies on sketch> test class : 61.42
------------------------------
Total epoch time: 27.572

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.072, total : 0.072 
 {acc} cls : 96.09
------------------------------
<Losses on train> cls : 0.038, total : 0.038
<Accuracies on train> cls : 98.37
Train epoch time: 10.602
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 61.42
------------------------------
<Accuracies on cartoon> test class : 62.46
------------------------------
<Accuracies on art_painting> test class : 70.95
------------------------------
<Accuracies on sketch> test class : 55.84
------------------------------
Total epoch time: 27.831

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 99.01
Train epoch time: 10.649
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 64.48
------------------------------
<Accuracies on cartoon> test class : 66.34
------------------------------
<Accuracies on art_painting> test class : 66.21
------------------------------
<Accuracies on sketch> test class : 62.46
------------------------------
Total epoch time: 27.254

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 98.78
Train epoch time: 10.769
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 65.04
------------------------------
<Accuracies on cartoon> test class : 68.60
------------------------------
<Accuracies on art_painting> test class : 72.17
------------------------------
<Accuracies on sketch> test class : 59.20
------------------------------
Total epoch time: 28.255

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.85
Train epoch time: 10.605
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 68.04
------------------------------
<Accuracies on cartoon> test class : 71.97
------------------------------
<Accuracies on art_painting> test class : 71.48
------------------------------
<Accuracies on sketch> test class : 63.91
------------------------------
Total epoch time: 27.248

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.05
Train epoch time: 10.693
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 65.10
------------------------------
<Accuracies on cartoon> test class : 65.23
------------------------------
<Accuracies on art_painting> test class : 72.51
------------------------------
<Accuracies on sketch> test class : 61.16
------------------------------
Total epoch time: 27.367

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.028, total : 0.028
<Accuracies on train> cls : 99.08
Train epoch time: 10.635
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 67.02
------------------------------
<Accuracies on cartoon> test class : 70.78
------------------------------
<Accuracies on art_painting> test class : 70.12
------------------------------
<Accuracies on sketch> test class : 63.17
------------------------------
Total epoch time: 27.468

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.025, total : 0.025
<Accuracies on train> cls : 98.95
Train epoch time: 10.587
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 66.49
------------------------------
<Accuracies on cartoon> test class : 68.69
------------------------------
<Accuracies on art_painting> test class : 72.12
------------------------------
<Accuracies on sketch> test class : 62.26
------------------------------
Total epoch time: 27.797

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.056, total : 0.056 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.025, total : 0.025
<Accuracies on train> cls : 99.18
Train epoch time: 10.654
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 70.83
------------------------------
<Accuracies on cartoon> test class : 70.44
------------------------------
<Accuracies on art_painting> test class : 71.00
------------------------------
<Accuracies on sketch> test class : 70.98
------------------------------
Total epoch time: 27.427

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.42
Train epoch time: 10.326
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 68.66
------------------------------
<Accuracies on cartoon> test class : 68.94
------------------------------
<Accuracies on art_painting> test class : 72.61
------------------------------
<Accuracies on sketch> test class : 66.43
------------------------------
Total epoch time: 27.039

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.041, total : 0.041 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.42
Train epoch time: 10.380
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 70.94
------------------------------
<Accuracies on cartoon> test class : 72.74
------------------------------
<Accuracies on art_painting> test class : 73.14
------------------------------
<Accuracies on sketch> test class : 68.72
------------------------------
Total epoch time: 27.076

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.15
Train epoch time: 10.094
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.11
------------------------------
<Accuracies on cartoon> test class : 71.89
------------------------------
<Accuracies on art_painting> test class : 72.12
------------------------------
<Accuracies on sketch> test class : 68.01
------------------------------
Total epoch time: 27.281

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.008, total : 0.008 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.35
Train epoch time: 10.047
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 63.91
------------------------------
<Accuracies on cartoon> test class : 66.42
------------------------------
<Accuracies on art_painting> test class : 72.71
------------------------------
<Accuracies on sketch> test class : 57.83
------------------------------
Total epoch time: 26.672

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.59
Train epoch time: 10.155
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 71.39
------------------------------
<Accuracies on cartoon> test class : 72.65
------------------------------
<Accuracies on art_painting> test class : 74.61
------------------------------
<Accuracies on sketch> test class : 68.95
------------------------------
Total epoch time: 27.300

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.59
Train epoch time: 10.271
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 70.71
------------------------------
<Accuracies on cartoon> test class : 72.10
------------------------------
<Accuracies on art_painting> test class : 74.95
------------------------------
<Accuracies on sketch> test class : 67.68
------------------------------
Total epoch time: 27.285

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.46
Train epoch time: 9.885
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 72.66
------------------------------
<Accuracies on cartoon> test class : 74.62
------------------------------
<Accuracies on art_painting> test class : 75.05
------------------------------
<Accuracies on sketch> test class : 70.25
------------------------------
Total epoch time: 26.466

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.80
Train epoch time: 10.211
------------------------------
<Accuracies on val> class : 98.83
------------------------------
<Accuracies on test> class : 72.18
------------------------------
<Accuracies on cartoon> test class : 75.43
------------------------------
<Accuracies on art_painting> test class : 74.56
------------------------------
<Accuracies on sketch> test class : 69.00
------------------------------
Total epoch time: 26.877

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.66
Train epoch time: 9.944
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 72.26
------------------------------
<Accuracies on cartoon> test class : 75.04
------------------------------
<Accuracies on art_painting> test class : 73.14
------------------------------
<Accuracies on sketch> test class : 70.15
------------------------------
Total epoch time: 26.596

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.46
Train epoch time: 9.975
------------------------------
<Accuracies on val> class : 98.25
------------------------------
<Accuracies on test> class : 68.50
------------------------------
<Accuracies on cartoon> test class : 74.36
------------------------------
<Accuracies on art_painting> test class : 73.78
------------------------------
<Accuracies on sketch> test class : 62.26
------------------------------
Total epoch time: 27.029

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.013, total : 0.013
<Accuracies on train> cls : 99.66
Train epoch time: 9.948
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 71.06
------------------------------
<Accuracies on cartoon> test class : 75.60
------------------------------
<Accuracies on art_painting> test class : 74.02
------------------------------
<Accuracies on sketch> test class : 66.81
------------------------------
Total epoch time: 26.916

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.69
Train epoch time: 9.947
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 69.91
------------------------------
<Accuracies on cartoon> test class : 74.53
------------------------------
<Accuracies on art_painting> test class : 73.78
------------------------------
<Accuracies on sketch> test class : 65.13
------------------------------
Total epoch time: 26.941

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.83
Train epoch time: 10.028
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 69.86
------------------------------
<Accuracies on cartoon> test class : 74.02
------------------------------
<Accuracies on art_painting> test class : 74.56
------------------------------
<Accuracies on sketch> test class : 64.93
------------------------------
Total epoch time: 26.725

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 99.22
------------------------------
<Losses on train> cls : 0.010, total : 0.010
<Accuracies on train> cls : 99.69
Train epoch time: 10.064
------------------------------
<Accuracies on val> class : 100.00
------------------------------
<Accuracies on test> class : 72.03
------------------------------
<Accuracies on cartoon> test class : 76.79
------------------------------
<Accuracies on art_painting> test class : 75.05
------------------------------
<Accuracies on sketch> test class : 67.63
------------------------------
Total epoch time: 27.181

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.028, total : 0.028 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.83
Train epoch time: 10.593
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 72.12
------------------------------
<Accuracies on cartoon> test class : 75.81
------------------------------
<Accuracies on art_painting> test class : 74.90
------------------------------
<Accuracies on sketch> test class : 68.47
------------------------------
Total epoch time: 27.309

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.80
Train epoch time: 10.042
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 71.55
------------------------------
<Accuracies on cartoon> test class : 75.43
------------------------------
<Accuracies on art_painting> test class : 75.24
------------------------------
<Accuracies on sketch> test class : 67.32
------------------------------
Total epoch time: 26.965

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.86
Train epoch time: 10.135
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 71.22
------------------------------
<Accuracies on cartoon> test class : 74.62
------------------------------
<Accuracies on art_painting> test class : 74.71
------------------------------
<Accuracies on sketch> test class : 67.37
------------------------------
Total epoch time: 26.908

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.73
Train epoch time: 10.299
------------------------------
<Accuracies on val> class : 99.42
------------------------------
<Accuracies on test> class : 70.40
------------------------------
<Accuracies on cartoon> test class : 74.02
------------------------------
<Accuracies on art_painting> test class : 75.20
------------------------------
<Accuracies on sketch> test class : 65.74
------------------------------
Total epoch time: 27.070

******************************
Best val 1, corresponding test 0.720346 - best test: 0.726595

******************************
Best val 1.0, corresponding cartoon test 0.7679181098937988

******************************
Best val 1.0, corresponding art_painting test 0.75048828125

******************************
Best val 1.0, corresponding sketch test 0.6762534976005554
