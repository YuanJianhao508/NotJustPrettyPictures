WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/28 iteration of epoch 1/30] 
 {loss} cls : 2.112, total : 2.112 
 {acc} cls : 15.62
------------------------------
<Losses on train> cls : 5.304, total : 5.304
<Accuracies on train> cls : 19.81
Train epoch time: 14.358
------------------------------
<Accuracies on val> class : 18.75
------------------------------
<Accuracies on test> class : 17.97
------------------------------
<Accuracies on photo> test class : 20.00
------------------------------
<Accuracies on cartoon> test class : 14.42
------------------------------
<Accuracies on sketch> test class : 19.22
------------------------------
Total epoch time: 44.392

New epoch - lr: 0.003
[1/28 iteration of epoch 2/30] 
 {loss} cls : 3.005, total : 3.005 
 {acc} cls : 26.56
------------------------------
<Losses on train> cls : 2.367, total : 2.367
<Accuracies on train> cls : 31.36
Train epoch time: 13.710
------------------------------
<Accuracies on val> class : 35.10
------------------------------
<Accuracies on test> class : 25.36
------------------------------
<Accuracies on photo> test class : 25.03
------------------------------
<Accuracies on cartoon> test class : 27.39
------------------------------
<Accuracies on sketch> test class : 24.28
------------------------------
Total epoch time: 45.282

New epoch - lr: 0.003
[1/28 iteration of epoch 3/30] 
 {loss} cls : 1.865, total : 1.865 
 {acc} cls : 23.44
------------------------------
<Losses on train> cls : 1.602, total : 1.602
<Accuracies on train> cls : 45.98
Train epoch time: 13.005
------------------------------
<Accuracies on val> class : 45.67
------------------------------
<Accuracies on test> class : 37.90
------------------------------
<Accuracies on photo> test class : 50.90
------------------------------
<Accuracies on cartoon> test class : 31.95
------------------------------
<Accuracies on sketch> test class : 35.91
------------------------------
Total epoch time: 44.262

New epoch - lr: 0.003
[1/28 iteration of epoch 4/30] 
 {loss} cls : 1.317, total : 1.317 
 {acc} cls : 48.44
------------------------------
<Losses on train> cls : 1.332, total : 1.332
<Accuracies on train> cls : 57.53
Train epoch time: 11.577
------------------------------
<Accuracies on val> class : 63.94
------------------------------
<Accuracies on test> class : 48.95
------------------------------
<Accuracies on photo> test class : 61.32
------------------------------
<Accuracies on cartoon> test class : 48.81
------------------------------
<Accuracies on sketch> test class : 43.78
------------------------------
Total epoch time: 43.831

New epoch - lr: 0.003
[1/28 iteration of epoch 5/30] 
 {loss} cls : 1.056, total : 1.056 
 {acc} cls : 60.94
------------------------------
<Losses on train> cls : 0.964, total : 0.964
<Accuracies on train> cls : 69.42
Train epoch time: 10.644
------------------------------
<Accuracies on val> class : 66.35
------------------------------
<Accuracies on test> class : 55.63
------------------------------
<Accuracies on photo> test class : 69.16
------------------------------
<Accuracies on cartoon> test class : 55.08
------------------------------
<Accuracies on sketch> test class : 50.22
------------------------------
Total epoch time: 44.300

New epoch - lr: 0.003
[1/28 iteration of epoch 6/30] 
 {loss} cls : 0.820, total : 0.820 
 {acc} cls : 71.88
------------------------------
<Losses on train> cls : 0.781, total : 0.781
<Accuracies on train> cls : 74.22
Train epoch time: 11.243
------------------------------
<Accuracies on val> class : 66.83
------------------------------
<Accuracies on test> class : 55.24
------------------------------
<Accuracies on photo> test class : 70.66
------------------------------
<Accuracies on cartoon> test class : 50.00
------------------------------
<Accuracies on sketch> test class : 51.82
------------------------------
Total epoch time: 45.788

New epoch - lr: 0.003
[1/28 iteration of epoch 7/30] 
 {loss} cls : 0.878, total : 0.878 
 {acc} cls : 67.19
------------------------------
<Losses on train> cls : 0.647, total : 0.647
<Accuracies on train> cls : 78.07
Train epoch time: 11.156
------------------------------
<Accuracies on val> class : 71.15
------------------------------
<Accuracies on test> class : 58.67
------------------------------
<Accuracies on photo> test class : 72.10
------------------------------
<Accuracies on cartoon> test class : 53.37
------------------------------
<Accuracies on sketch> test class : 56.12
------------------------------
Total epoch time: 44.328

New epoch - lr: 0.003
[1/28 iteration of epoch 8/30] 
 {loss} cls : 0.388, total : 0.388 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.529, total : 0.529
<Accuracies on train> cls : 81.53
Train epoch time: 10.301
------------------------------
<Accuracies on val> class : 72.12
------------------------------
<Accuracies on test> class : 65.01
------------------------------
<Accuracies on photo> test class : 77.19
------------------------------
<Accuracies on cartoon> test class : 56.83
------------------------------
<Accuracies on sketch> test class : 64.72
------------------------------
Total epoch time: 42.346

New epoch - lr: 0.003
[1/28 iteration of epoch 9/30] 
 {loss} cls : 0.267, total : 0.267 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.394, total : 0.394
<Accuracies on train> cls : 86.10
Train epoch time: 10.137
------------------------------
<Accuracies on val> class : 74.52
------------------------------
<Accuracies on test> class : 61.56
------------------------------
<Accuracies on photo> test class : 74.97
------------------------------
<Accuracies on cartoon> test class : 53.28
------------------------------
<Accuracies on sketch> test class : 60.80
------------------------------
Total epoch time: 41.948

New epoch - lr: 0.003
[1/28 iteration of epoch 10/30] 
 {loss} cls : 0.461, total : 0.461 
 {acc} cls : 82.81
------------------------------
<Losses on train> cls : 0.333, total : 0.333
<Accuracies on train> cls : 88.28
Train epoch time: 10.308
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 61.74
------------------------------
<Accuracies on photo> test class : 77.66
------------------------------
<Accuracies on cartoon> test class : 53.11
------------------------------
<Accuracies on sketch> test class : 60.12
------------------------------
Total epoch time: 41.607

New epoch - lr: 0.003
[1/28 iteration of epoch 11/30] 
 {loss} cls : 0.290, total : 0.290 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.262, total : 0.262
<Accuracies on train> cls : 90.79
Train epoch time: 10.384
------------------------------
<Accuracies on val> class : 75.48
------------------------------
<Accuracies on test> class : 64.94
------------------------------
<Accuracies on photo> test class : 78.56
------------------------------
<Accuracies on cartoon> test class : 56.31
------------------------------
<Accuracies on sketch> test class : 64.29
------------------------------
Total epoch time: 43.227

New epoch - lr: 0.003
[1/28 iteration of epoch 12/30] 
 {loss} cls : 0.101, total : 0.101 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.278, total : 0.278
<Accuracies on train> cls : 90.90
Train epoch time: 10.282
------------------------------
<Accuracies on val> class : 75.00
------------------------------
<Accuracies on test> class : 64.75
------------------------------
<Accuracies on photo> test class : 78.98
------------------------------
<Accuracies on cartoon> test class : 57.25
------------------------------
<Accuracies on sketch> test class : 63.17
------------------------------
Total epoch time: 42.234

New epoch - lr: 0.003
[1/28 iteration of epoch 13/30] 
 {loss} cls : 0.128, total : 0.128 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.216, total : 0.216
<Accuracies on train> cls : 92.13
Train epoch time: 10.611
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 62.73
------------------------------
<Accuracies on photo> test class : 71.68
------------------------------
<Accuracies on cartoon> test class : 56.31
------------------------------
<Accuracies on sketch> test class : 62.76
------------------------------
Total epoch time: 41.035

New epoch - lr: 0.003
[1/28 iteration of epoch 14/30] 
 {loss} cls : 0.211, total : 0.211 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.193, total : 0.193
<Accuracies on train> cls : 93.81
Train epoch time: 11.278
------------------------------
<Accuracies on val> class : 75.96
------------------------------
<Accuracies on test> class : 64.17
------------------------------
<Accuracies on photo> test class : 74.37
------------------------------
<Accuracies on cartoon> test class : 56.74
------------------------------
<Accuracies on sketch> test class : 64.27
------------------------------
Total epoch time: 44.252

New epoch - lr: 0.003
[1/28 iteration of epoch 15/30] 
 {loss} cls : 0.278, total : 0.278 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.202, total : 0.202
<Accuracies on train> cls : 92.86
Train epoch time: 11.682
------------------------------
<Accuracies on val> class : 73.56
------------------------------
<Accuracies on test> class : 60.87
------------------------------
<Accuracies on photo> test class : 74.43
------------------------------
<Accuracies on cartoon> test class : 54.74
------------------------------
<Accuracies on sketch> test class : 58.77
------------------------------
Total epoch time: 45.225

New epoch - lr: 0.003
[1/28 iteration of epoch 16/30] 
 {loss} cls : 0.072, total : 0.072 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.140, total : 0.140
<Accuracies on train> cls : 94.59
Train epoch time: 12.335
------------------------------
<Accuracies on val> class : 74.04
------------------------------
<Accuracies on test> class : 68.89
------------------------------
<Accuracies on photo> test class : 77.13
------------------------------
<Accuracies on cartoon> test class : 63.87
------------------------------
<Accuracies on sketch> test class : 68.39
------------------------------
Total epoch time: 44.756

New epoch - lr: 0.003
[1/28 iteration of epoch 17/30] 
 {loss} cls : 0.199, total : 0.199 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.130, total : 0.130
<Accuracies on train> cls : 95.59
Train epoch time: 11.255
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 67.03
------------------------------
<Accuracies on photo> test class : 78.38
------------------------------
<Accuracies on cartoon> test class : 58.87
------------------------------
<Accuracies on sketch> test class : 67.07
------------------------------
Total epoch time: 43.415

New epoch - lr: 0.003
[1/28 iteration of epoch 18/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.120, total : 0.120
<Accuracies on train> cls : 95.26
Train epoch time: 10.372
------------------------------
<Accuracies on val> class : 76.44
------------------------------
<Accuracies on test> class : 65.05
------------------------------
<Accuracies on photo> test class : 74.85
------------------------------
<Accuracies on cartoon> test class : 58.32
------------------------------
<Accuracies on sketch> test class : 64.90
------------------------------
Total epoch time: 41.707

New epoch - lr: 0.003
[1/28 iteration of epoch 19/30] 
 {loss} cls : 0.084, total : 0.084 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.104, total : 0.104
<Accuracies on train> cls : 96.60
Train epoch time: 10.175
------------------------------
<Accuracies on val> class : 79.81
------------------------------
<Accuracies on test> class : 66.11
------------------------------
<Accuracies on photo> test class : 79.76
------------------------------
<Accuracies on cartoon> test class : 57.47
------------------------------
<Accuracies on sketch> test class : 65.46
------------------------------
Total epoch time: 42.486

New epoch - lr: 0.003
[1/28 iteration of epoch 20/30] 
 {loss} cls : 0.088, total : 0.088 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.097, total : 0.097
<Accuracies on train> cls : 96.54
Train epoch time: 9.785
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 64.79
------------------------------
<Accuracies on photo> test class : 79.64
------------------------------
<Accuracies on cartoon> test class : 55.33
------------------------------
<Accuracies on sketch> test class : 64.11
------------------------------
Total epoch time: 42.202

New epoch - lr: 0.003
[1/28 iteration of epoch 21/30] 
 {loss} cls : 0.048, total : 0.048 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.093, total : 0.093
<Accuracies on train> cls : 97.21
Train epoch time: 9.825
------------------------------
<Accuracies on val> class : 76.92
------------------------------
<Accuracies on test> class : 67.47
------------------------------
<Accuracies on photo> test class : 79.52
------------------------------
<Accuracies on cartoon> test class : 60.20
------------------------------
<Accuracies on sketch> test class : 66.68
------------------------------
Total epoch time: 41.649

New epoch - lr: 0.003
[1/28 iteration of epoch 22/30] 
 {loss} cls : 0.201, total : 0.201 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.057, total : 0.057
<Accuracies on train> cls : 97.94
Train epoch time: 9.797
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 64.96
------------------------------
<Accuracies on photo> test class : 79.40
------------------------------
<Accuracies on cartoon> test class : 59.13
------------------------------
<Accuracies on sketch> test class : 62.31
------------------------------
Total epoch time: 40.922

New epoch - lr: 0.003
[1/28 iteration of epoch 23/30] 
 {loss} cls : 0.086, total : 0.086 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.068, total : 0.068
<Accuracies on train> cls : 97.54
Train epoch time: 9.702
------------------------------
<Accuracies on val> class : 82.21
------------------------------
<Accuracies on test> class : 66.44
------------------------------
<Accuracies on photo> test class : 80.36
------------------------------
<Accuracies on cartoon> test class : 58.28
------------------------------
<Accuracies on sketch> test class : 65.39
------------------------------
Total epoch time: 43.081

New epoch - lr: 0.003
[1/28 iteration of epoch 24/30] 
 {loss} cls : 0.063, total : 0.063 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.068, total : 0.068
<Accuracies on train> cls : 97.88
Train epoch time: 10.175
------------------------------
<Accuracies on val> class : 77.88
------------------------------
<Accuracies on test> class : 69.78
------------------------------
<Accuracies on photo> test class : 79.58
------------------------------
<Accuracies on cartoon> test class : 62.50
------------------------------
<Accuracies on sketch> test class : 69.97
------------------------------
Total epoch time: 42.813

New epoch - lr: 0.003
[1/28 iteration of epoch 25/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.058, total : 0.058
<Accuracies on train> cls : 97.94
Train epoch time: 10.247
------------------------------
<Accuracies on val> class : 79.33
------------------------------
<Accuracies on test> class : 67.56
------------------------------
<Accuracies on photo> test class : 82.34
------------------------------
<Accuracies on cartoon> test class : 57.59
------------------------------
<Accuracies on sketch> test class : 67.22
------------------------------
Total epoch time: 43.518

New epoch - lr: 0.003
[1/28 iteration of epoch 26/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 99.00
Train epoch time: 10.065
------------------------------
<Accuracies on val> class : 80.77
------------------------------
<Accuracies on test> class : 66.78
------------------------------
<Accuracies on photo> test class : 82.22
------------------------------
<Accuracies on cartoon> test class : 57.98
------------------------------
<Accuracies on sketch> test class : 65.46
------------------------------
Total epoch time: 42.116

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 27/30] 
 {loss} cls : 0.049, total : 0.049 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.031, total : 0.031
<Accuracies on train> cls : 98.88
Train epoch time: 10.120
------------------------------
<Accuracies on val> class : 82.21
------------------------------
<Accuracies on test> class : 68.45
------------------------------
<Accuracies on photo> test class : 80.24
------------------------------
<Accuracies on cartoon> test class : 60.84
------------------------------
<Accuracies on sketch> test class : 67.98
------------------------------
Total epoch time: 41.512

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 28/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.037, total : 0.037
<Accuracies on train> cls : 98.83
Train epoch time: 10.878
------------------------------
<Accuracies on val> class : 82.69
------------------------------
<Accuracies on test> class : 67.93
------------------------------
<Accuracies on photo> test class : 81.68
------------------------------
<Accuracies on cartoon> test class : 59.56
------------------------------
<Accuracies on sketch> test class : 67.09
------------------------------
Total epoch time: 42.362

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 29/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.39
Train epoch time: 9.426
------------------------------
<Accuracies on val> class : 81.73
------------------------------
<Accuracies on test> class : 67.91
------------------------------
<Accuracies on photo> test class : 81.44
------------------------------
<Accuracies on cartoon> test class : 59.68
------------------------------
<Accuracies on sketch> test class : 67.07
------------------------------
Total epoch time: 38.781

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 30/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.44
Train epoch time: 9.536
------------------------------
<Accuracies on val> class : 81.73
------------------------------
<Accuracies on test> class : 68.48
------------------------------
<Accuracies on photo> test class : 81.20
------------------------------
<Accuracies on cartoon> test class : 60.28
------------------------------
<Accuracies on sketch> test class : 67.96
------------------------------
Total epoch time: 36.138

******************************
Best val 0.826923, corresponding test 0.67934 - best test: 0.697847

******************************
Best val 0.8269230723381042, corresponding photo test 0.8167664408683777

******************************
Best val 0.8269230723381042, corresponding cartoon test 0.5955631136894226

******************************
Best val 0.8269230723381042, corresponding sketch test 0.6709086298942566
