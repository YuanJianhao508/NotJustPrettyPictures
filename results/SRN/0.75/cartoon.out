WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/32 iteration of epoch 1/30] 
 {loss} cls : 2.071, total : 2.071 
 {acc} cls : 7.81
[31/32 iteration of epoch 1/30] 
 {loss} cls : 1.011, total : 1.011 
 {acc} cls : 65.62
------------------------------
<Losses on train> cls : 4.384, total : 4.384
<Accuracies on train> cls : 37.01
Train epoch time: 14.621
------------------------------
<Accuracies on val> class : 66.67
------------------------------
<Accuracies on test> class : 35.36
------------------------------
<Accuracies on photo> test class : 42.16
------------------------------
<Accuracies on art_painting> test class : 30.37
------------------------------
<Accuracies on sketch> test class : 35.07
------------------------------
Total epoch time: 44.694

New epoch - lr: 0.003
[1/32 iteration of epoch 2/30] 
 {loss} cls : 1.417, total : 1.417 
 {acc} cls : 65.62
[31/32 iteration of epoch 2/30] 
 {loss} cls : 0.477, total : 0.477 
 {acc} cls : 79.69
------------------------------
<Losses on train> cls : 0.996, total : 0.996
<Accuracies on train> cls : 70.70
Train epoch time: 12.697
------------------------------
<Accuracies on val> class : 76.79
------------------------------
<Accuracies on test> class : 49.99
------------------------------
<Accuracies on photo> test class : 47.84
------------------------------
<Accuracies on art_painting> test class : 39.55
------------------------------
<Accuracies on sketch> test class : 56.35
------------------------------
Total epoch time: 41.688

New epoch - lr: 0.003
[1/32 iteration of epoch 3/30] 
 {loss} cls : 0.749, total : 0.749 
 {acc} cls : 78.12
[31/32 iteration of epoch 3/30] 
 {loss} cls : 0.451, total : 0.451 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.620, total : 0.620
<Accuracies on train> cls : 79.39
Train epoch time: 12.809
------------------------------
<Accuracies on val> class : 78.06
------------------------------
<Accuracies on test> class : 49.74
------------------------------
<Accuracies on photo> test class : 50.00
------------------------------
<Accuracies on art_painting> test class : 40.43
------------------------------
<Accuracies on sketch> test class : 54.49
------------------------------
Total epoch time: 45.236

New epoch - lr: 0.003
[1/32 iteration of epoch 4/30] 
 {loss} cls : 0.570, total : 0.570 
 {acc} cls : 82.81
[31/32 iteration of epoch 4/30] 
 {loss} cls : 0.504, total : 0.504 
 {acc} cls : 78.12
------------------------------
<Losses on train> cls : 0.418, total : 0.418
<Accuracies on train> cls : 86.43
Train epoch time: 12.764
------------------------------
<Accuracies on val> class : 78.06
------------------------------
<Accuracies on test> class : 57.09
------------------------------
<Accuracies on photo> test class : 57.96
------------------------------
<Accuracies on art_painting> test class : 46.97
------------------------------
<Accuracies on sketch> test class : 62.00
------------------------------
Total epoch time: 41.565

New epoch - lr: 0.003
[1/32 iteration of epoch 5/30] 
 {loss} cls : 0.462, total : 0.462 
 {acc} cls : 85.94
[31/32 iteration of epoch 5/30] 
 {loss} cls : 0.517, total : 0.517 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.396, total : 0.396
<Accuracies on train> cls : 87.30
Train epoch time: 12.093
------------------------------
<Accuracies on val> class : 85.23
------------------------------
<Accuracies on test> class : 58.25
------------------------------
<Accuracies on photo> test class : 57.07
------------------------------
<Accuracies on art_painting> test class : 46.97
------------------------------
<Accuracies on sketch> test class : 64.62
------------------------------
Total epoch time: 41.752

New epoch - lr: 0.003
[1/32 iteration of epoch 6/30] 
 {loss} cls : 0.310, total : 0.310 
 {acc} cls : 87.50
[31/32 iteration of epoch 6/30] 
 {loss} cls : 0.295, total : 0.295 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.271, total : 0.271
<Accuracies on train> cls : 90.28
Train epoch time: 11.140
------------------------------
<Accuracies on val> class : 90.30
------------------------------
<Accuracies on test> class : 57.81
------------------------------
<Accuracies on photo> test class : 56.47
------------------------------
<Accuracies on art_painting> test class : 45.46
------------------------------
<Accuracies on sketch> test class : 64.83
------------------------------
Total epoch time: 42.226

New epoch - lr: 0.003
[1/32 iteration of epoch 7/30] 
 {loss} cls : 0.307, total : 0.307 
 {acc} cls : 89.06
[31/32 iteration of epoch 7/30] 
 {loss} cls : 0.093, total : 0.093 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.213, total : 0.213
<Accuracies on train> cls : 92.92
Train epoch time: 10.344
------------------------------
<Accuracies on val> class : 89.87
------------------------------
<Accuracies on test> class : 59.10
------------------------------
<Accuracies on photo> test class : 58.38
------------------------------
<Accuracies on art_painting> test class : 48.05
------------------------------
<Accuracies on sketch> test class : 65.16
------------------------------
Total epoch time: 39.485

New epoch - lr: 0.003
[1/32 iteration of epoch 8/30] 
 {loss} cls : 0.196, total : 0.196 
 {acc} cls : 95.31
[31/32 iteration of epoch 8/30] 
 {loss} cls : 0.083, total : 0.083 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.147, total : 0.147
<Accuracies on train> cls : 95.36
Train epoch time: 10.382
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 58.22
------------------------------
<Accuracies on photo> test class : 53.77
------------------------------
<Accuracies on art_painting> test class : 47.75
------------------------------
<Accuracies on sketch> test class : 65.56
------------------------------
Total epoch time: 40.547

New epoch - lr: 0.003
[1/32 iteration of epoch 9/30] 
 {loss} cls : 0.194, total : 0.194 
 {acc} cls : 93.75
[31/32 iteration of epoch 9/30] 
 {loss} cls : 0.265, total : 0.265 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.153, total : 0.153
<Accuracies on train> cls : 94.97
Train epoch time: 10.347
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 60.01
------------------------------
<Accuracies on photo> test class : 60.36
------------------------------
<Accuracies on art_painting> test class : 45.36
------------------------------
<Accuracies on sketch> test class : 67.50
------------------------------
Total epoch time: 40.958

New epoch - lr: 0.003
[1/32 iteration of epoch 10/30] 
 {loss} cls : 0.104, total : 0.104 
 {acc} cls : 95.31
[31/32 iteration of epoch 10/30] 
 {loss} cls : 0.139, total : 0.139 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.131, total : 0.131
<Accuracies on train> cls : 95.70
Train epoch time: 10.293
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 60.08
------------------------------
<Accuracies on photo> test class : 62.16
------------------------------
<Accuracies on art_painting> test class : 45.75
------------------------------
<Accuracies on sketch> test class : 66.66
------------------------------
Total epoch time: 41.042

New epoch - lr: 0.003
[1/32 iteration of epoch 11/30] 
 {loss} cls : 0.108, total : 0.108 
 {acc} cls : 98.44
[31/32 iteration of epoch 11/30] 
 {loss} cls : 0.034, total : 0.034 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.092, total : 0.092
<Accuracies on train> cls : 96.58
Train epoch time: 10.043
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 60.25
------------------------------
<Accuracies on photo> test class : 64.55
------------------------------
<Accuracies on art_painting> test class : 49.07
------------------------------
<Accuracies on sketch> test class : 64.24
------------------------------
Total epoch time: 39.348

New epoch - lr: 0.003
[1/32 iteration of epoch 12/30] 
 {loss} cls : 0.159, total : 0.159 
 {acc} cls : 92.19
[31/32 iteration of epoch 12/30] 
 {loss} cls : 0.111, total : 0.111 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.090, total : 0.090
<Accuracies on train> cls : 96.73
Train epoch time: 10.383
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 56.89
------------------------------
<Accuracies on photo> test class : 52.10
------------------------------
<Accuracies on art_painting> test class : 44.73
------------------------------
<Accuracies on sketch> test class : 65.26
------------------------------
Total epoch time: 40.825

New epoch - lr: 0.003
[1/32 iteration of epoch 13/30] 
 {loss} cls : 0.074, total : 0.074 
 {acc} cls : 98.44
[31/32 iteration of epoch 13/30] 
 {loss} cls : 0.025, total : 0.025 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.076, total : 0.076
<Accuracies on train> cls : 97.36
Train epoch time: 10.829
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 60.04
------------------------------
<Accuracies on photo> test class : 61.44
------------------------------
<Accuracies on art_painting> test class : 46.39
------------------------------
<Accuracies on sketch> test class : 66.56
------------------------------
Total epoch time: 41.369

New epoch - lr: 0.003
[1/32 iteration of epoch 14/30] 
 {loss} cls : 0.042, total : 0.042 
 {acc} cls : 100.00
[31/32 iteration of epoch 14/30] 
 {loss} cls : 0.193, total : 0.193 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.081, total : 0.081
<Accuracies on train> cls : 97.17
Train epoch time: 11.198
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 62.22
------------------------------
<Accuracies on photo> test class : 66.35
------------------------------
<Accuracies on art_painting> test class : 52.25
------------------------------
<Accuracies on sketch> test class : 65.67
------------------------------
Total epoch time: 41.034

New epoch - lr: 0.003
[1/32 iteration of epoch 15/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
[31/32 iteration of epoch 15/30] 
 {loss} cls : 0.091, total : 0.091 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.063, total : 0.063
<Accuracies on train> cls : 97.85
Train epoch time: 10.233
------------------------------
<Accuracies on val> class : 89.87
------------------------------
<Accuracies on test> class : 56.62
------------------------------
<Accuracies on photo> test class : 57.90
------------------------------
<Accuracies on art_painting> test class : 46.73
------------------------------
<Accuracies on sketch> test class : 61.24
------------------------------
Total epoch time: 41.437

New epoch - lr: 0.003
[1/32 iteration of epoch 16/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
[31/32 iteration of epoch 16/30] 
 {loss} cls : 0.086, total : 0.086 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.057, total : 0.057
<Accuracies on train> cls : 98.14
Train epoch time: 10.303
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 60.31
------------------------------
<Accuracies on photo> test class : 62.40
------------------------------
<Accuracies on art_painting> test class : 47.07
------------------------------
<Accuracies on sketch> test class : 66.33
------------------------------
Total epoch time: 41.861

New epoch - lr: 0.003
[1/32 iteration of epoch 17/30] 
 {loss} cls : 0.113, total : 0.113 
 {acc} cls : 96.88
[31/32 iteration of epoch 17/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.044, total : 0.044
<Accuracies on train> cls : 98.49
Train epoch time: 10.236
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 61.08
------------------------------
<Accuracies on photo> test class : 61.68
------------------------------
<Accuracies on art_painting> test class : 49.66
------------------------------
<Accuracies on sketch> test class : 66.79
------------------------------
Total epoch time: 41.145

New epoch - lr: 0.003
[1/32 iteration of epoch 18/30] 
 {loss} cls : 0.060, total : 0.060 
 {acc} cls : 98.44
[31/32 iteration of epoch 18/30] 
 {loss} cls : 0.098, total : 0.098 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 99.12
Train epoch time: 10.277
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 60.91
------------------------------
<Accuracies on photo> test class : 62.04
------------------------------
<Accuracies on art_painting> test class : 50.24
------------------------------
<Accuracies on sketch> test class : 66.00
------------------------------
Total epoch time: 41.455

New epoch - lr: 0.003
[1/32 iteration of epoch 19/30] 
 {loss} cls : 0.075, total : 0.075 
 {acc} cls : 96.88
[31/32 iteration of epoch 19/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.032, total : 0.032
<Accuracies on train> cls : 98.88
Train epoch time: 10.246
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 62.12
------------------------------
<Accuracies on photo> test class : 64.61
------------------------------
<Accuracies on art_painting> test class : 50.10
------------------------------
<Accuracies on sketch> test class : 67.32
------------------------------
Total epoch time: 42.196

New epoch - lr: 0.003
[1/32 iteration of epoch 20/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 20/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.22
Train epoch time: 9.582
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 59.74
------------------------------
<Accuracies on photo> test class : 61.38
------------------------------
<Accuracies on art_painting> test class : 48.39
------------------------------
<Accuracies on sketch> test class : 64.95
------------------------------
Total epoch time: 39.968

New epoch - lr: 0.003
[1/32 iteration of epoch 21/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 100.00
[31/32 iteration of epoch 21/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.61
Train epoch time: 10.102
------------------------------
<Accuracies on val> class : 94.09
------------------------------
<Accuracies on test> class : 62.00
------------------------------
<Accuracies on photo> test class : 64.73
------------------------------
<Accuracies on art_painting> test class : 50.83
------------------------------
<Accuracies on sketch> test class : 66.66
------------------------------
Total epoch time: 41.198

New epoch - lr: 0.003
[1/32 iteration of epoch 22/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
[31/32 iteration of epoch 22/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.027, total : 0.027
<Accuracies on train> cls : 99.02
Train epoch time: 10.291
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 60.98
------------------------------
<Accuracies on photo> test class : 61.08
------------------------------
<Accuracies on art_painting> test class : 47.85
------------------------------
<Accuracies on sketch> test class : 67.78
------------------------------
Total epoch time: 41.303

New epoch - lr: 0.003
[1/32 iteration of epoch 23/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 100.00
[31/32 iteration of epoch 23/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.018, total : 0.018
<Accuracies on train> cls : 99.41
Train epoch time: 9.860
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 62.10
------------------------------
<Accuracies on photo> test class : 59.76
------------------------------
<Accuracies on art_painting> test class : 47.66
------------------------------
<Accuracies on sketch> test class : 70.63
------------------------------
Total epoch time: 40.535

New epoch - lr: 0.003
[1/32 iteration of epoch 24/30] 
 {loss} cls : 0.021, total : 0.021 
 {acc} cls : 100.00
[31/32 iteration of epoch 24/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.22
Train epoch time: 10.076
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 62.46
------------------------------
<Accuracies on photo> test class : 62.28
------------------------------
<Accuracies on art_painting> test class : 49.41
------------------------------
<Accuracies on sketch> test class : 69.33
------------------------------
Total epoch time: 41.206

New epoch - lr: 0.003
[1/32 iteration of epoch 25/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
[31/32 iteration of epoch 25/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.07
Train epoch time: 10.813
------------------------------
<Accuracies on val> class : 92.83
------------------------------
<Accuracies on test> class : 62.36
------------------------------
<Accuracies on photo> test class : 62.22
------------------------------
<Accuracies on art_painting> test class : 49.07
------------------------------
<Accuracies on sketch> test class : 69.36
------------------------------
Total epoch time: 41.234

New epoch - lr: 0.003
[1/32 iteration of epoch 26/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/32 iteration of epoch 26/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.22
Train epoch time: 10.458
------------------------------
<Accuracies on val> class : 94.94
------------------------------
<Accuracies on test> class : 62.17
------------------------------
<Accuracies on photo> test class : 61.92
------------------------------
<Accuracies on art_painting> test class : 48.24
------------------------------
<Accuracies on sketch> test class : 69.53
------------------------------
Total epoch time: 39.996

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 27/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/32 iteration of epoch 27/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.37
Train epoch time: 10.629
------------------------------
<Accuracies on val> class : 94.51
------------------------------
<Accuracies on test> class : 62.50
------------------------------
<Accuracies on photo> test class : 64.01
------------------------------
<Accuracies on art_painting> test class : 47.41
------------------------------
<Accuracies on sketch> test class : 69.71
------------------------------
Total epoch time: 39.696

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 28/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
[31/32 iteration of epoch 28/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.41
Train epoch time: 11.592
------------------------------
<Accuracies on val> class : 92.41
------------------------------
<Accuracies on test> class : 63.19
------------------------------
<Accuracies on photo> test class : 64.19
------------------------------
<Accuracies on art_painting> test class : 49.46
------------------------------
<Accuracies on sketch> test class : 69.92
------------------------------
Total epoch time: 40.403

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 29/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
[31/32 iteration of epoch 29/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.61
Train epoch time: 11.061
------------------------------
<Accuracies on val> class : 93.25
------------------------------
<Accuracies on test> class : 63.76
------------------------------
<Accuracies on photo> test class : 65.81
------------------------------
<Accuracies on art_painting> test class : 49.12
------------------------------
<Accuracies on sketch> test class : 70.53
------------------------------
Total epoch time: 38.578

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 30/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 30/30] 
 {loss} cls : 0.011, total : 0.011 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.66
Train epoch time: 10.672
------------------------------
<Accuracies on val> class : 93.67
------------------------------
<Accuracies on test> class : 63.27
------------------------------
<Accuracies on photo> test class : 65.69
------------------------------
<Accuracies on art_painting> test class : 50.10
------------------------------
<Accuracies on sketch> test class : 69.10
------------------------------
Total epoch time: 37.461

******************************
Best val 0.949367, corresponding test 0.621682 - best test: 0.637636

******************************
Best val 0.949367105960846, corresponding photo test 0.6191616654396057

******************************
Best val 0.949367105960846, corresponding art_painting test 0.482421875

******************************
Best val 0.949367105960846, corresponding sketch test 0.6953423023223877
