WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/23 iteration of epoch 1/30] 
 {loss} cls : 2.234, total : 2.234 
 {acc} cls : 9.38
------------------------------
<Losses on train> cls : 1.653, total : 1.653
<Accuracies on train> cls : 50.68
Train epoch time: 11.367
------------------------------
<Accuracies on val> class : 69.01
------------------------------
<Accuracies on test> class : 18.60
------------------------------
<Accuracies on cartoon> test class : 14.59
------------------------------
<Accuracies on art_painting> test class : 28.47
------------------------------
<Accuracies on sketch> test class : 15.86
------------------------------
Total epoch time: 43.902

New epoch - lr: 0.003
[1/23 iteration of epoch 2/30] 
 {loss} cls : 0.954, total : 0.954 
 {acc} cls : 67.19
------------------------------
<Losses on train> cls : 0.583, total : 0.583
<Accuracies on train> cls : 78.87
Train epoch time: 10.576
------------------------------
<Accuracies on val> class : 80.12
------------------------------
<Accuracies on test> class : 40.08
------------------------------
<Accuracies on cartoon> test class : 35.49
------------------------------
<Accuracies on art_painting> test class : 38.72
------------------------------
<Accuracies on sketch> test class : 43.52
------------------------------
Total epoch time: 42.808

New epoch - lr: 0.003
[1/23 iteration of epoch 3/30] 
 {loss} cls : 0.262, total : 0.262 
 {acc} cls : 85.94
------------------------------
<Losses on train> cls : 0.393, total : 0.393
<Accuracies on train> cls : 84.58
Train epoch time: 11.051
------------------------------
<Accuracies on val> class : 81.29
------------------------------
<Accuracies on test> class : 40.14
------------------------------
<Accuracies on cartoon> test class : 33.36
------------------------------
<Accuracies on art_painting> test class : 39.65
------------------------------
<Accuracies on sketch> test class : 44.44
------------------------------
Total epoch time: 44.040

New epoch - lr: 0.003
[1/23 iteration of epoch 4/30] 
 {loss} cls : 0.179, total : 0.179 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.307, total : 0.307
<Accuracies on train> cls : 88.65
Train epoch time: 9.848
------------------------------
<Accuracies on val> class : 88.30
------------------------------
<Accuracies on test> class : 39.88
------------------------------
<Accuracies on cartoon> test class : 34.47
------------------------------
<Accuracies on art_painting> test class : 44.04
------------------------------
<Accuracies on sketch> test class : 40.93
------------------------------
Total epoch time: 44.564

New epoch - lr: 0.003
[1/23 iteration of epoch 5/30] 
 {loss} cls : 0.090, total : 0.090 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.183, total : 0.183
<Accuracies on train> cls : 93.07
Train epoch time: 8.998
------------------------------
<Accuracies on val> class : 86.55
------------------------------
<Accuracies on test> class : 42.71
------------------------------
<Accuracies on cartoon> test class : 34.56
------------------------------
<Accuracies on art_painting> test class : 45.70
------------------------------
<Accuracies on sketch> test class : 46.02
------------------------------
Total epoch time: 42.210

New epoch - lr: 0.003
[1/23 iteration of epoch 6/30] 
 {loss} cls : 0.142, total : 0.142 
 {acc} cls : 93.75
------------------------------
<Losses on train> cls : 0.153, total : 0.153
<Accuracies on train> cls : 94.57
Train epoch time: 8.387
------------------------------
<Accuracies on val> class : 92.40
------------------------------
<Accuracies on test> class : 44.38
------------------------------
<Accuracies on cartoon> test class : 40.74
------------------------------
<Accuracies on art_painting> test class : 48.05
------------------------------
<Accuracies on sketch> test class : 44.64
------------------------------
Total epoch time: 43.316

New epoch - lr: 0.003
[1/23 iteration of epoch 7/30] 
 {loss} cls : 0.060, total : 0.060 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.118, total : 0.118
<Accuracies on train> cls : 95.79
Train epoch time: 8.206
------------------------------
<Accuracies on val> class : 90.06
------------------------------
<Accuracies on test> class : 41.63
------------------------------
<Accuracies on cartoon> test class : 36.22
------------------------------
<Accuracies on art_painting> test class : 49.22
------------------------------
<Accuracies on sketch> test class : 40.90
------------------------------
Total epoch time: 41.769

New epoch - lr: 0.003
[1/23 iteration of epoch 8/30] 
 {loss} cls : 0.036, total : 0.036 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.100, total : 0.100
<Accuracies on train> cls : 96.26
Train epoch time: 7.868
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 45.36
------------------------------
<Accuracies on cartoon> test class : 39.08
------------------------------
<Accuracies on art_painting> test class : 47.95
------------------------------
<Accuracies on sketch> test class : 47.75
------------------------------
Total epoch time: 41.291

New epoch - lr: 0.003
[1/23 iteration of epoch 9/30] 
 {loss} cls : 0.079, total : 0.079 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.062, total : 0.062
<Accuracies on train> cls : 97.15
Train epoch time: 8.626
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 43.56
------------------------------
<Accuracies on cartoon> test class : 34.00
------------------------------
<Accuracies on art_painting> test class : 43.85
------------------------------
<Accuracies on sketch> test class : 49.12
------------------------------
Total epoch time: 41.610

New epoch - lr: 0.003
[1/23 iteration of epoch 10/30] 
 {loss} cls : 0.035, total : 0.035 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.065, total : 0.065
<Accuracies on train> cls : 97.76
Train epoch time: 8.052
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 43.59
------------------------------
<Accuracies on cartoon> test class : 33.62
------------------------------
<Accuracies on art_painting> test class : 47.80
------------------------------
<Accuracies on sketch> test class : 47.34
------------------------------
Total epoch time: 44.898

New epoch - lr: 0.003
[1/23 iteration of epoch 11/30] 
 {loss} cls : 0.142, total : 0.142 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.041, total : 0.041
<Accuracies on train> cls : 98.85
Train epoch time: 9.671
------------------------------
<Accuracies on val> class : 92.40
------------------------------
<Accuracies on test> class : 48.04
------------------------------
<Accuracies on cartoon> test class : 38.74
------------------------------
<Accuracies on art_painting> test class : 46.88
------------------------------
<Accuracies on sketch> test class : 54.19
------------------------------
Total epoch time: 46.948

New epoch - lr: 0.003
[1/23 iteration of epoch 12/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.041, total : 0.041
<Accuracies on train> cls : 98.91
Train epoch time: 9.353
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 37.58
------------------------------
<Accuracies on cartoon> test class : 31.14
------------------------------
<Accuracies on art_painting> test class : 50.24
------------------------------
<Accuracies on sketch> test class : 34.82
------------------------------
Total epoch time: 48.830

New epoch - lr: 0.003
[1/23 iteration of epoch 13/30] 
 {loss} cls : 0.033, total : 0.033 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.78
Train epoch time: 9.056
------------------------------
<Accuracies on val> class : 92.40
------------------------------
<Accuracies on test> class : 41.31
------------------------------
<Accuracies on cartoon> test class : 33.11
------------------------------
<Accuracies on art_painting> test class : 47.46
------------------------------
<Accuracies on sketch> test class : 42.99
------------------------------
Total epoch time: 47.209

New epoch - lr: 0.003
[1/23 iteration of epoch 14/30] 
 {loss} cls : 0.035, total : 0.035 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.053, total : 0.053
<Accuracies on train> cls : 98.23
Train epoch time: 9.542
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 45.45
------------------------------
<Accuracies on cartoon> test class : 37.41
------------------------------
<Accuracies on art_painting> test class : 48.97
------------------------------
<Accuracies on sketch> test class : 48.41
------------------------------
Total epoch time: 47.957

New epoch - lr: 0.003
[1/23 iteration of epoch 15/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.033, total : 0.033
<Accuracies on train> cls : 98.71
Train epoch time: 11.094
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 41.63
------------------------------
<Accuracies on cartoon> test class : 37.63
------------------------------
<Accuracies on art_painting> test class : 51.56
------------------------------
<Accuracies on sketch> test class : 38.84
------------------------------
Total epoch time: 48.725

New epoch - lr: 0.003
[1/23 iteration of epoch 16/30] 
 {loss} cls : 0.071, total : 0.071 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.038, total : 0.038
<Accuracies on train> cls : 98.51
Train epoch time: 10.866
------------------------------
<Accuracies on val> class : 92.40
------------------------------
<Accuracies on test> class : 41.23
------------------------------
<Accuracies on cartoon> test class : 38.57
------------------------------
<Accuracies on art_painting> test class : 51.17
------------------------------
<Accuracies on sketch> test class : 37.64
------------------------------
Total epoch time: 47.626

New epoch - lr: 0.003
[1/23 iteration of epoch 17/30] 
 {loss} cls : 0.006, total : 0.006 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.032, total : 0.032
<Accuracies on train> cls : 99.12
Train epoch time: 10.629
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 41.95
------------------------------
<Accuracies on cartoon> test class : 38.23
------------------------------
<Accuracies on art_painting> test class : 52.93
------------------------------
<Accuracies on sketch> test class : 38.46
------------------------------
Total epoch time: 47.022

New epoch - lr: 0.003
[1/23 iteration of epoch 18/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.030, total : 0.030
<Accuracies on train> cls : 98.91
Train epoch time: 10.610
------------------------------
<Accuracies on val> class : 92.40
------------------------------
<Accuracies on test> class : 42.18
------------------------------
<Accuracies on cartoon> test class : 37.67
------------------------------
<Accuracies on art_painting> test class : 52.54
------------------------------
<Accuracies on sketch> test class : 39.48
------------------------------
Total epoch time: 48.159

New epoch - lr: 0.003
[1/23 iteration of epoch 19/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.25
Train epoch time: 10.217
------------------------------
<Accuracies on val> class : 94.15
------------------------------
<Accuracies on test> class : 47.21
------------------------------
<Accuracies on cartoon> test class : 39.85
------------------------------
<Accuracies on art_painting> test class : 51.56
------------------------------
<Accuracies on sketch> test class : 49.33
------------------------------
Total epoch time: 46.934

New epoch - lr: 0.003
[1/23 iteration of epoch 20/30] 
 {loss} cls : 0.010, total : 0.010 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.39
Train epoch time: 10.215
------------------------------
<Accuracies on val> class : 92.40
------------------------------
<Accuracies on test> class : 48.13
------------------------------
<Accuracies on cartoon> test class : 40.27
------------------------------
<Accuracies on art_painting> test class : 51.71
------------------------------
<Accuracies on sketch> test class : 50.95
------------------------------
Total epoch time: 48.027

New epoch - lr: 0.003
[1/23 iteration of epoch 21/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.59
Train epoch time: 9.796
------------------------------
<Accuracies on val> class : 91.81
------------------------------
<Accuracies on test> class : 45.87
------------------------------
<Accuracies on cartoon> test class : 37.41
------------------------------
<Accuracies on art_painting> test class : 53.17
------------------------------
<Accuracies on sketch> test class : 47.11
------------------------------
Total epoch time: 46.424

New epoch - lr: 0.003
[1/23 iteration of epoch 22/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.011, total : 0.011
<Accuracies on train> cls : 99.59
Train epoch time: 9.680
------------------------------
<Accuracies on val> class : 90.64
------------------------------
<Accuracies on test> class : 45.93
------------------------------
<Accuracies on cartoon> test class : 42.28
------------------------------
<Accuracies on art_painting> test class : 53.22
------------------------------
<Accuracies on sketch> test class : 44.31
------------------------------
Total epoch time: 47.878

New epoch - lr: 0.003
[1/23 iteration of epoch 23/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.020, total : 0.020
<Accuracies on train> cls : 99.39
Train epoch time: 9.829
------------------------------
<Accuracies on val> class : 93.57
------------------------------
<Accuracies on test> class : 44.96
------------------------------
<Accuracies on cartoon> test class : 38.95
------------------------------
<Accuracies on art_painting> test class : 51.42
------------------------------
<Accuracies on sketch> test class : 45.18
------------------------------
Total epoch time: 45.867

New epoch - lr: 0.003
[1/23 iteration of epoch 24/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.009, total : 0.009
<Accuracies on train> cls : 99.73
Train epoch time: 10.875
------------------------------
<Accuracies on val> class : 92.98
------------------------------
<Accuracies on test> class : 44.81
------------------------------
<Accuracies on cartoon> test class : 37.80
------------------------------
<Accuracies on art_painting> test class : 51.51
------------------------------
<Accuracies on sketch> test class : 45.51
------------------------------
Total epoch time: 47.945

New epoch - lr: 0.003
[1/23 iteration of epoch 25/30] 
 {loss} cls : 0.014, total : 0.014 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.006, total : 0.006
<Accuracies on train> cls : 99.86
Train epoch time: 10.219
------------------------------
<Accuracies on val> class : 93.57
------------------------------
<Accuracies on test> class : 46.47
------------------------------
<Accuracies on cartoon> test class : 42.36
------------------------------
<Accuracies on art_painting> test class : 51.95
------------------------------
<Accuracies on sketch> test class : 46.07
------------------------------
Total epoch time: 47.630

New epoch - lr: 0.003
[1/23 iteration of epoch 26/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.007, total : 0.007
<Accuracies on train> cls : 99.80
Train epoch time: 10.035
------------------------------
<Accuracies on val> class : 93.57
------------------------------
<Accuracies on test> class : 47.27
------------------------------
<Accuracies on cartoon> test class : 41.42
------------------------------
<Accuracies on art_painting> test class : 51.86
------------------------------
<Accuracies on sketch> test class : 48.36
------------------------------
Total epoch time: 46.936

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 27/30] 
 {loss} cls : 0.000, total : 0.000 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.86
Train epoch time: 10.085
------------------------------
<Accuracies on val> class : 94.15
------------------------------
<Accuracies on test> class : 47.64
------------------------------
<Accuracies on cartoon> test class : 40.74
------------------------------
<Accuracies on art_painting> test class : 52.69
------------------------------
<Accuracies on sketch> test class : 49.12
------------------------------
Total epoch time: 47.903

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 28/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.93
Train epoch time: 10.306
------------------------------
<Accuracies on val> class : 94.15
------------------------------
<Accuracies on test> class : 47.00
------------------------------
<Accuracies on cartoon> test class : 39.85
------------------------------
<Accuracies on art_painting> test class : 52.64
------------------------------
<Accuracies on sketch> test class : 48.33
------------------------------
Total epoch time: 47.704

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 29/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.005, total : 0.005
<Accuracies on train> cls : 99.80
Train epoch time: 9.556
------------------------------
<Accuracies on val> class : 94.15
------------------------------
<Accuracies on test> class : 46.67
------------------------------
<Accuracies on cartoon> test class : 39.42
------------------------------
<Accuracies on art_painting> test class : 53.12
------------------------------
<Accuracies on sketch> test class : 47.62
------------------------------
Total epoch time: 42.903

New epoch - lr: 0.0009000000000000002
[1/23 iteration of epoch 30/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.004, total : 0.004
<Accuracies on train> cls : 99.93
Train epoch time: 8.723
------------------------------
<Accuracies on val> class : 94.15
------------------------------
<Accuracies on test> class : 46.92
------------------------------
<Accuracies on cartoon> test class : 40.15
------------------------------
<Accuracies on art_painting> test class : 53.03
------------------------------
<Accuracies on sketch> test class : 47.77
------------------------------
Total epoch time: 40.634

******************************
Best val 0.94152, corresponding test 0.469174 - best test: 0.481312

******************************
Best val 0.9415204524993896, corresponding cartoon test 0.401450514793396

******************************
Best val 0.9415204524993896, corresponding art_painting test 0.5302734375

******************************
Best val 0.9415204524993896, corresponding sketch test 0.4777297079563141
