WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/32 iteration of epoch 1/30] 
 {loss} cls : 2.234, total : 2.234 
 {acc} cls : 10.94
[31/32 iteration of epoch 1/30] 
 {loss} cls : 0.959, total : 0.959 
 {acc} cls : 67.19
------------------------------
<Losses on train> cls : 3.200, total : 3.200
<Accuracies on train> cls : 44.63
Train epoch time: 13.522
------------------------------
<Accuracies on val> class : 70.46
------------------------------
<Accuracies on test> class : 39.15
------------------------------
<Accuracies on photo> test class : 31.62
------------------------------
<Accuracies on art_painting> test class : 31.98
------------------------------
<Accuracies on sketch> test class : 46.09
------------------------------
Total epoch time: 41.852

New epoch - lr: 0.003
[1/32 iteration of epoch 2/30] 
 {loss} cls : 0.808, total : 0.808 
 {acc} cls : 71.88
[31/32 iteration of epoch 2/30] 
 {loss} cls : 0.751, total : 0.751 
 {acc} cls : 78.12
------------------------------
<Losses on train> cls : 0.819, total : 0.819
<Accuracies on train> cls : 73.29
Train epoch time: 11.938
------------------------------
<Accuracies on val> class : 78.06
------------------------------
<Accuracies on test> class : 50.54
------------------------------
<Accuracies on photo> test class : 58.32
------------------------------
<Accuracies on art_painting> test class : 40.09
------------------------------
<Accuracies on sketch> test class : 52.69
------------------------------
Total epoch time: 40.179

New epoch - lr: 0.003
[1/32 iteration of epoch 3/30] 
 {loss} cls : 0.763, total : 0.763 
 {acc} cls : 78.12
[31/32 iteration of epoch 3/30] 
 {loss} cls : 0.463, total : 0.463 
 {acc} cls : 87.50
------------------------------
<Losses on train> cls : 0.557, total : 0.557
<Accuracies on train> cls : 81.01
Train epoch time: 12.011
------------------------------
<Accuracies on val> class : 73.42
------------------------------
<Accuracies on test> class : 52.40
------------------------------
<Accuracies on photo> test class : 55.57
------------------------------
<Accuracies on art_painting> test class : 42.29
------------------------------
<Accuracies on sketch> test class : 56.32
------------------------------
Total epoch time: 40.359

New epoch - lr: 0.003
[1/32 iteration of epoch 4/30] 
 {loss} cls : 0.897, total : 0.897 
 {acc} cls : 73.44
[31/32 iteration of epoch 4/30] 
 {loss} cls : 0.299, total : 0.299 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.405, total : 0.405
<Accuracies on train> cls : 85.55
Train epoch time: 11.322
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 59.07
------------------------------
<Accuracies on photo> test class : 59.10
------------------------------
<Accuracies on art_painting> test class : 42.19
------------------------------
<Accuracies on sketch> test class : 67.85
------------------------------
Total epoch time: 40.521

New epoch - lr: 0.003
[1/32 iteration of epoch 5/30] 
 {loss} cls : 0.436, total : 0.436 
 {acc} cls : 79.69
[31/32 iteration of epoch 5/30] 
 {loss} cls : 0.450, total : 0.450 
 {acc} cls : 81.25
------------------------------
<Losses on train> cls : 0.333, total : 0.333
<Accuracies on train> cls : 88.87
Train epoch time: 11.330
------------------------------
<Accuracies on val> class : 84.81
------------------------------
<Accuracies on test> class : 58.19
------------------------------
<Accuracies on photo> test class : 58.32
------------------------------
<Accuracies on art_painting> test class : 45.17
------------------------------
<Accuracies on sketch> test class : 64.93
------------------------------
Total epoch time: 40.060

New epoch - lr: 0.003
[1/32 iteration of epoch 6/30] 
 {loss} cls : 0.291, total : 0.291 
 {acc} cls : 93.75
[31/32 iteration of epoch 6/30] 
 {loss} cls : 0.410, total : 0.410 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.220, total : 0.220
<Accuracies on train> cls : 92.77
Train epoch time: 10.744
------------------------------
<Accuracies on val> class : 85.65
------------------------------
<Accuracies on test> class : 59.96
------------------------------
<Accuracies on photo> test class : 63.59
------------------------------
<Accuracies on art_painting> test class : 43.21
------------------------------
<Accuracies on sketch> test class : 67.14
------------------------------
Total epoch time: 39.415

New epoch - lr: 0.003
[1/32 iteration of epoch 7/30] 
 {loss} cls : 0.094, total : 0.094 
 {acc} cls : 96.88
[31/32 iteration of epoch 7/30] 
 {loss} cls : 0.076, total : 0.076 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.192, total : 0.192
<Accuracies on train> cls : 93.31
Train epoch time: 10.989
------------------------------
<Accuracies on val> class : 90.72
------------------------------
<Accuracies on test> class : 57.53
------------------------------
<Accuracies on photo> test class : 51.68
------------------------------
<Accuracies on art_painting> test class : 42.97
------------------------------
<Accuracies on sketch> test class : 67.60
------------------------------
Total epoch time: 41.121

New epoch - lr: 0.003
[1/32 iteration of epoch 8/30] 
 {loss} cls : 0.246, total : 0.246 
 {acc} cls : 90.62
[31/32 iteration of epoch 8/30] 
 {loss} cls : 0.085, total : 0.085 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.162, total : 0.162
<Accuracies on train> cls : 94.58
Train epoch time: 10.971
------------------------------
<Accuracies on val> class : 92.41
------------------------------
<Accuracies on test> class : 60.72
------------------------------
<Accuracies on photo> test class : 63.05
------------------------------
<Accuracies on art_painting> test class : 44.24
------------------------------
<Accuracies on sketch> test class : 68.31
------------------------------
Total epoch time: 40.241

New epoch - lr: 0.003
[1/32 iteration of epoch 9/30] 
 {loss} cls : 0.183, total : 0.183 
 {acc} cls : 92.19
[31/32 iteration of epoch 9/30] 
 {loss} cls : 0.070, total : 0.070 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.126, total : 0.126
<Accuracies on train> cls : 95.46
Train epoch time: 11.300
------------------------------
<Accuracies on val> class : 89.87
------------------------------
<Accuracies on test> class : 63.96
------------------------------
<Accuracies on photo> test class : 61.08
------------------------------
<Accuracies on art_painting> test class : 48.24
------------------------------
<Accuracies on sketch> test class : 73.38
------------------------------
Total epoch time: 40.500

New epoch - lr: 0.003
[1/32 iteration of epoch 10/30] 
 {loss} cls : 0.073, total : 0.073 
 {acc} cls : 96.88
[31/32 iteration of epoch 10/30] 
 {loss} cls : 0.075, total : 0.075 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.104, total : 0.104
<Accuracies on train> cls : 96.04
Train epoch time: 10.861
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 63.15
------------------------------
<Accuracies on photo> test class : 60.00
------------------------------
<Accuracies on art_painting> test class : 49.80
------------------------------
<Accuracies on sketch> test class : 71.44
------------------------------
Total epoch time: 40.417

New epoch - lr: 0.003
[1/32 iteration of epoch 11/30] 
 {loss} cls : 0.089, total : 0.089 
 {acc} cls : 95.31
[31/32 iteration of epoch 11/30] 
 {loss} cls : 0.143, total : 0.143 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.077, total : 0.077
<Accuracies on train> cls : 97.31
Train epoch time: 11.099
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 62.08
------------------------------
<Accuracies on photo> test class : 62.16
------------------------------
<Accuracies on art_painting> test class : 45.46
------------------------------
<Accuracies on sketch> test class : 70.71
------------------------------
Total epoch time: 46.340

New epoch - lr: 0.003
[1/32 iteration of epoch 12/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 100.00
[31/32 iteration of epoch 12/30] 
 {loss} cls : 0.080, total : 0.080 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.089, total : 0.089
<Accuracies on train> cls : 97.02
Train epoch time: 12.191
------------------------------
<Accuracies on val> class : 92.83
------------------------------
<Accuracies on test> class : 61.14
------------------------------
<Accuracies on photo> test class : 60.12
------------------------------
<Accuracies on art_painting> test class : 44.82
------------------------------
<Accuracies on sketch> test class : 70.07
------------------------------
Total epoch time: 46.761

New epoch - lr: 0.003
[1/32 iteration of epoch 13/30] 
 {loss} cls : 0.037, total : 0.037 
 {acc} cls : 98.44
[31/32 iteration of epoch 13/30] 
 {loss} cls : 0.108, total : 0.108 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.071, total : 0.071
<Accuracies on train> cls : 97.51
Train epoch time: 12.383
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 64.03
------------------------------
<Accuracies on photo> test class : 65.63
------------------------------
<Accuracies on art_painting> test class : 48.78
------------------------------
<Accuracies on sketch> test class : 71.29
------------------------------
Total epoch time: 45.940

New epoch - lr: 0.003
[1/32 iteration of epoch 14/30] 
 {loss} cls : 0.082, total : 0.082 
 {acc} cls : 98.44
[31/32 iteration of epoch 14/30] 
 {loss} cls : 0.031, total : 0.031 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.056, total : 0.056
<Accuracies on train> cls : 98.05
Train epoch time: 12.170
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 62.77
------------------------------
<Accuracies on photo> test class : 66.11
------------------------------
<Accuracies on art_painting> test class : 48.58
------------------------------
<Accuracies on sketch> test class : 68.75
------------------------------
Total epoch time: 45.630

New epoch - lr: 0.003
[1/32 iteration of epoch 15/30] 
 {loss} cls : 0.040, total : 0.040 
 {acc} cls : 98.44
[31/32 iteration of epoch 15/30] 
 {loss} cls : 0.068, total : 0.068 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 97.95
Train epoch time: 11.276
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 65.50
------------------------------
<Accuracies on photo> test class : 66.29
------------------------------
<Accuracies on art_painting> test class : 51.42
------------------------------
<Accuracies on sketch> test class : 72.51
------------------------------
Total epoch time: 45.280

New epoch - lr: 0.003
[1/32 iteration of epoch 16/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 98.44
[31/32 iteration of epoch 16/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.05
Train epoch time: 12.189
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 65.05
------------------------------
<Accuracies on photo> test class : 63.29
------------------------------
<Accuracies on art_painting> test class : 48.83
------------------------------
<Accuracies on sketch> test class : 74.24
------------------------------
Total epoch time: 45.049

New epoch - lr: 0.003
[1/32 iteration of epoch 17/30] 
 {loss} cls : 0.077, total : 0.077 
 {acc} cls : 96.88
[31/32 iteration of epoch 17/30] 
 {loss} cls : 0.020, total : 0.020 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.046, total : 0.046
<Accuracies on train> cls : 98.19
Train epoch time: 11.954
------------------------------
<Accuracies on val> class : 90.30
------------------------------
<Accuracies on test> class : 64.74
------------------------------
<Accuracies on photo> test class : 65.51
------------------------------
<Accuracies on art_painting> test class : 49.56
------------------------------
<Accuracies on sketch> test class : 72.33
------------------------------
Total epoch time: 47.650

New epoch - lr: 0.003
[1/32 iteration of epoch 18/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
[31/32 iteration of epoch 18/30] 
 {loss} cls : 0.092, total : 0.092 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.049, total : 0.049
<Accuracies on train> cls : 98.24
Train epoch time: 11.576
------------------------------
<Accuracies on val> class : 90.72
------------------------------
<Accuracies on test> class : 65.95
------------------------------
<Accuracies on photo> test class : 66.53
------------------------------
<Accuracies on art_painting> test class : 49.90
------------------------------
<Accuracies on sketch> test class : 74.06
------------------------------
Total epoch time: 45.555

New epoch - lr: 0.003
[1/32 iteration of epoch 19/30] 
 {loss} cls : 0.038, total : 0.038 
 {acc} cls : 98.44
[31/32 iteration of epoch 19/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.038, total : 0.038
<Accuracies on train> cls : 98.29
Train epoch time: 11.820
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 63.16
------------------------------
<Accuracies on photo> test class : 63.83
------------------------------
<Accuracies on art_painting> test class : 44.34
------------------------------
<Accuracies on sketch> test class : 72.69
------------------------------
Total epoch time: 46.693

New epoch - lr: 0.003
[1/32 iteration of epoch 20/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
[31/32 iteration of epoch 20/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.049, total : 0.049
<Accuracies on train> cls : 98.29
Train epoch time: 11.471
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 62.47
------------------------------
<Accuracies on photo> test class : 65.33
------------------------------
<Accuracies on art_painting> test class : 48.93
------------------------------
<Accuracies on sketch> test class : 68.31
------------------------------
Total epoch time: 45.112

New epoch - lr: 0.003
[1/32 iteration of epoch 21/30] 
 {loss} cls : 0.028, total : 0.028 
 {acc} cls : 98.44
[31/32 iteration of epoch 21/30] 
 {loss} cls : 0.117, total : 0.117 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.038, total : 0.038
<Accuracies on train> cls : 98.54
Train epoch time: 11.890
------------------------------
<Accuracies on val> class : 89.87
------------------------------
<Accuracies on test> class : 63.99
------------------------------
<Accuracies on photo> test class : 64.55
------------------------------
<Accuracies on art_painting> test class : 47.75
------------------------------
<Accuracies on sketch> test class : 72.21
------------------------------
Total epoch time: 46.757

New epoch - lr: 0.003
[1/32 iteration of epoch 22/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
[31/32 iteration of epoch 22/30] 
 {loss} cls : 0.040, total : 0.040 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.029, total : 0.029
<Accuracies on train> cls : 98.78
Train epoch time: 11.768
------------------------------
<Accuracies on val> class : 90.30
------------------------------
<Accuracies on test> class : 63.03
------------------------------
<Accuracies on photo> test class : 60.78
------------------------------
<Accuracies on art_painting> test class : 47.41
------------------------------
<Accuracies on sketch> test class : 72.13
------------------------------
Total epoch time: 45.617

New epoch - lr: 0.003
[1/32 iteration of epoch 23/30] 
 {loss} cls : 0.018, total : 0.018 
 {acc} cls : 98.44
[31/32 iteration of epoch 23/30] 
 {loss} cls : 0.012, total : 0.012 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.023, total : 0.023
<Accuracies on train> cls : 99.46
Train epoch time: 11.647
------------------------------
<Accuracies on val> class : 91.56
------------------------------
<Accuracies on test> class : 63.62
------------------------------
<Accuracies on photo> test class : 60.48
------------------------------
<Accuracies on art_painting> test class : 49.90
------------------------------
<Accuracies on sketch> test class : 72.10
------------------------------
Total epoch time: 46.891

New epoch - lr: 0.003
[1/32 iteration of epoch 24/30] 
 {loss} cls : 0.046, total : 0.046 
 {acc} cls : 98.44
[31/32 iteration of epoch 24/30] 
 {loss} cls : 0.026, total : 0.026 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.022, total : 0.022
<Accuracies on train> cls : 99.27
Train epoch time: 11.371
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 63.23
------------------------------
<Accuracies on photo> test class : 62.75
------------------------------
<Accuracies on art_painting> test class : 48.19
------------------------------
<Accuracies on sketch> test class : 71.26
------------------------------
Total epoch time: 44.934

New epoch - lr: 0.003
[1/32 iteration of epoch 25/30] 
 {loss} cls : 0.002, total : 0.002 
 {acc} cls : 100.00
[31/32 iteration of epoch 25/30] 
 {loss} cls : 0.024, total : 0.024 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.017, total : 0.017
<Accuracies on train> cls : 99.27
Train epoch time: 12.348
------------------------------
<Accuracies on val> class : 89.45
------------------------------
<Accuracies on test> class : 64.52
------------------------------
<Accuracies on photo> test class : 62.69
------------------------------
<Accuracies on art_painting> test class : 49.02
------------------------------
<Accuracies on sketch> test class : 73.38
------------------------------
Total epoch time: 46.733

New epoch - lr: 0.003
[1/32 iteration of epoch 26/30] 
 {loss} cls : 0.004, total : 0.004 
 {acc} cls : 100.00
[31/32 iteration of epoch 26/30] 
 {loss} cls : 0.009, total : 0.009 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.015, total : 0.015
<Accuracies on train> cls : 99.61
Train epoch time: 11.831
------------------------------
<Accuracies on val> class : 89.03
------------------------------
<Accuracies on test> class : 64.27
------------------------------
<Accuracies on photo> test class : 61.80
------------------------------
<Accuracies on art_painting> test class : 48.49
------------------------------
<Accuracies on sketch> test class : 73.56
------------------------------
Total epoch time: 47.230

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 27/30] 
 {loss} cls : 0.027, total : 0.027 
 {acc} cls : 98.44
[31/32 iteration of epoch 27/30] 
 {loss} cls : 0.001, total : 0.001 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.016, total : 0.016
<Accuracies on train> cls : 99.37
Train epoch time: 11.930
------------------------------
<Accuracies on val> class : 91.14
------------------------------
<Accuracies on test> class : 64.17
------------------------------
<Accuracies on photo> test class : 63.59
------------------------------
<Accuracies on art_painting> test class : 48.58
------------------------------
<Accuracies on sketch> test class : 72.54
------------------------------
Total epoch time: 46.185

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 28/30] 
 {loss} cls : 0.066, total : 0.066 
 {acc} cls : 98.44
[31/32 iteration of epoch 28/30] 
 {loss} cls : 0.036, total : 0.036 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.014, total : 0.014
<Accuracies on train> cls : 99.51
Train epoch time: 11.055
------------------------------
<Accuracies on val> class : 92.41
------------------------------
<Accuracies on test> class : 64.54
------------------------------
<Accuracies on photo> test class : 63.71
------------------------------
<Accuracies on art_painting> test class : 48.14
------------------------------
<Accuracies on sketch> test class : 73.43
------------------------------
Total epoch time: 44.960

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 29/30] 
 {loss} cls : 0.019, total : 0.019 
 {acc} cls : 100.00
[31/32 iteration of epoch 29/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.012, total : 0.012
<Accuracies on train> cls : 99.61
Train epoch time: 12.045
------------------------------
<Accuracies on val> class : 91.98
------------------------------
<Accuracies on test> class : 64.91
------------------------------
<Accuracies on photo> test class : 63.59
------------------------------
<Accuracies on art_painting> test class : 50.20
------------------------------
<Accuracies on sketch> test class : 73.15
------------------------------
Total epoch time: 45.440

New epoch - lr: 0.0009000000000000002
[1/32 iteration of epoch 30/30] 
 {loss} cls : 0.005, total : 0.005 
 {acc} cls : 100.00
[31/32 iteration of epoch 30/30] 
 {loss} cls : 0.003, total : 0.003 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.008, total : 0.008
<Accuracies on train> cls : 99.80
Train epoch time: 11.572
------------------------------
<Accuracies on val> class : 92.41
------------------------------
<Accuracies on test> class : 65.01
------------------------------
<Accuracies on photo> test class : 64.55
------------------------------
<Accuracies on art_painting> test class : 49.61
------------------------------
<Accuracies on sketch> test class : 73.22
------------------------------
Total epoch time: 42.612

******************************
Best val 0.92827, corresponding test 0.611351 - best test: 0.659474

******************************
Best val 0.9282700419425964, corresponding photo test 0.6011976003646851

******************************
Best val 0.9282700419425964, corresponding art_painting test 0.4482421875

******************************
Best val 0.9282700419425964, corresponding sketch test 0.7006871700286865
