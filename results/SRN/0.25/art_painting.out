WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:16: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

WARNING:tensorflow:From /homes/55/jianhaoy/projects/EKI/utils/tf_logger.py:20: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


Loading experiment PACS/ResNet18_step


New epoch - lr: 0.003
[1/28 iteration of epoch 1/30] 
 {loss} cls : 2.001, total : 2.001 
 {acc} cls : 14.06
------------------------------
<Losses on train> cls : 4.563, total : 4.563
<Accuracies on train> cls : 21.93
Train epoch time: 13.502
------------------------------
<Accuracies on val> class : 22.12
------------------------------
<Accuracies on test> class : 14.60
------------------------------
<Accuracies on photo> test class : 17.96
------------------------------
<Accuracies on cartoon> test class : 9.85
------------------------------
<Accuracies on sketch> test class : 16.01
------------------------------
Total epoch time: 42.758

New epoch - lr: 0.003
[1/28 iteration of epoch 2/30] 
 {loss} cls : 2.122, total : 2.122 
 {acc} cls : 34.38
------------------------------
<Losses on train> cls : 1.893, total : 1.893
<Accuracies on train> cls : 42.69
Train epoch time: 12.551
------------------------------
<Accuracies on val> class : 27.40
------------------------------
<Accuracies on test> class : 28.02
------------------------------
<Accuracies on photo> test class : 32.40
------------------------------
<Accuracies on cartoon> test class : 19.16
------------------------------
<Accuracies on sketch> test class : 31.46
------------------------------
Total epoch time: 40.790

New epoch - lr: 0.003
[1/28 iteration of epoch 3/30] 
 {loss} cls : 1.573, total : 1.573 
 {acc} cls : 48.44
------------------------------
<Losses on train> cls : 1.364, total : 1.364
<Accuracies on train> cls : 56.64
Train epoch time: 12.310
------------------------------
<Accuracies on val> class : 48.08
------------------------------
<Accuracies on test> class : 41.66
------------------------------
<Accuracies on photo> test class : 51.26
------------------------------
<Accuracies on cartoon> test class : 38.44
------------------------------
<Accuracies on sketch> test class : 39.50
------------------------------
Total epoch time: 41.751

New epoch - lr: 0.003
[1/28 iteration of epoch 4/30] 
 {loss} cls : 1.107, total : 1.107 
 {acc} cls : 57.81
------------------------------
<Losses on train> cls : 1.012, total : 1.012
<Accuracies on train> cls : 65.79
Train epoch time: 12.073
------------------------------
<Accuracies on val> class : 61.06
------------------------------
<Accuracies on test> class : 54.75
------------------------------
<Accuracies on photo> test class : 56.47
------------------------------
<Accuracies on cartoon> test class : 50.51
------------------------------
<Accuracies on sketch> test class : 56.55
------------------------------
Total epoch time: 40.598

New epoch - lr: 0.003
[1/28 iteration of epoch 5/30] 
 {loss} cls : 0.944, total : 0.944 
 {acc} cls : 71.88
------------------------------
<Losses on train> cls : 0.735, total : 0.735
<Accuracies on train> cls : 76.23
Train epoch time: 11.964
------------------------------
<Accuracies on val> class : 62.02
------------------------------
<Accuracies on test> class : 51.38
------------------------------
<Accuracies on photo> test class : 67.01
------------------------------
<Accuracies on cartoon> test class : 47.74
------------------------------
<Accuracies on sketch> test class : 46.91
------------------------------
Total epoch time: 41.718

New epoch - lr: 0.003
[1/28 iteration of epoch 6/30] 
 {loss} cls : 0.490, total : 0.490 
 {acc} cls : 84.38
------------------------------
<Losses on train> cls : 0.589, total : 0.589
<Accuracies on train> cls : 79.74
Train epoch time: 11.458
------------------------------
<Accuracies on val> class : 70.67
------------------------------
<Accuracies on test> class : 61.46
------------------------------
<Accuracies on photo> test class : 68.80
------------------------------
<Accuracies on cartoon> test class : 54.39
------------------------------
<Accuracies on sketch> test class : 62.56
------------------------------
Total epoch time: 42.012

New epoch - lr: 0.003
[1/28 iteration of epoch 7/30] 
 {loss} cls : 0.467, total : 0.467 
 {acc} cls : 73.44
------------------------------
<Losses on train> cls : 0.486, total : 0.486
<Accuracies on train> cls : 83.43
Train epoch time: 11.226
------------------------------
<Accuracies on val> class : 69.71
------------------------------
<Accuracies on test> class : 56.69
------------------------------
<Accuracies on photo> test class : 67.72
------------------------------
<Accuracies on cartoon> test class : 49.83
------------------------------
<Accuracies on sketch> test class : 56.10
------------------------------
Total epoch time: 41.198

New epoch - lr: 0.003
[1/28 iteration of epoch 8/30] 
 {loss} cls : 0.244, total : 0.244 
 {acc} cls : 92.19
------------------------------
<Losses on train> cls : 0.385, total : 0.385
<Accuracies on train> cls : 86.94
Train epoch time: 10.703
------------------------------
<Accuracies on val> class : 67.79
------------------------------
<Accuracies on test> class : 54.24
------------------------------
<Accuracies on photo> test class : 73.65
------------------------------
<Accuracies on cartoon> test class : 46.54
------------------------------
<Accuracies on sketch> test class : 50.57
------------------------------
Total epoch time: 40.478

New epoch - lr: 0.003
[1/28 iteration of epoch 9/30] 
 {loss} cls : 0.405, total : 0.405 
 {acc} cls : 84.38
------------------------------
<Losses on train> cls : 0.295, total : 0.295
<Accuracies on train> cls : 89.79
Train epoch time: 11.439
------------------------------
<Accuracies on val> class : 76.44
------------------------------
<Accuracies on test> class : 65.40
------------------------------
<Accuracies on photo> test class : 74.49
------------------------------
<Accuracies on cartoon> test class : 60.92
------------------------------
<Accuracies on sketch> test class : 64.21
------------------------------
Total epoch time: 43.481

New epoch - lr: 0.003
[1/28 iteration of epoch 10/30] 
 {loss} cls : 0.359, total : 0.359 
 {acc} cls : 89.06
------------------------------
<Losses on train> cls : 0.288, total : 0.288
<Accuracies on train> cls : 90.96
Train epoch time: 10.294
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 65.92
------------------------------
<Accuracies on photo> test class : 73.83
------------------------------
<Accuracies on cartoon> test class : 61.09
------------------------------
<Accuracies on sketch> test class : 65.44
------------------------------
Total epoch time: 41.262

New epoch - lr: 0.003
[1/28 iteration of epoch 11/30] 
 {loss} cls : 0.225, total : 0.225 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.227, total : 0.227
<Accuracies on train> cls : 92.52
Train epoch time: 11.505
------------------------------
<Accuracies on val> class : 72.12
------------------------------
<Accuracies on test> class : 59.21
------------------------------
<Accuracies on photo> test class : 74.79
------------------------------
<Accuracies on cartoon> test class : 53.63
------------------------------
<Accuracies on sketch> test class : 55.92
------------------------------
Total epoch time: 47.530

New epoch - lr: 0.003
[1/28 iteration of epoch 12/30] 
 {loss} cls : 0.264, total : 0.264 
 {acc} cls : 90.62
------------------------------
<Losses on train> cls : 0.236, total : 0.236
<Accuracies on train> cls : 92.69
Train epoch time: 10.966
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 61.85
------------------------------
<Accuracies on photo> test class : 73.29
------------------------------
<Accuracies on cartoon> test class : 56.66
------------------------------
<Accuracies on sketch> test class : 60.09
------------------------------
Total epoch time: 48.064

New epoch - lr: 0.003
[1/28 iteration of epoch 13/30] 
 {loss} cls : 0.097, total : 0.097 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.178, total : 0.178
<Accuracies on train> cls : 93.53
Train epoch time: 11.172
------------------------------
<Accuracies on val> class : 72.60
------------------------------
<Accuracies on test> class : 65.96
------------------------------
<Accuracies on photo> test class : 77.01
------------------------------
<Accuracies on cartoon> test class : 54.78
------------------------------
<Accuracies on sketch> test class : 67.93
------------------------------
Total epoch time: 47.683

New epoch - lr: 0.003
[1/28 iteration of epoch 14/30] 
 {loss} cls : 0.116, total : 0.116 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.158, total : 0.158
<Accuracies on train> cls : 94.53
Train epoch time: 11.418
------------------------------
<Accuracies on val> class : 72.12
------------------------------
<Accuracies on test> class : 63.25
------------------------------
<Accuracies on photo> test class : 72.93
------------------------------
<Accuracies on cartoon> test class : 56.74
------------------------------
<Accuracies on sketch> test class : 63.02
------------------------------
Total epoch time: 46.578

New epoch - lr: 0.003
[1/28 iteration of epoch 15/30] 
 {loss} cls : 0.084, total : 0.084 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.130, total : 0.130
<Accuracies on train> cls : 95.59
Train epoch time: 11.045
------------------------------
<Accuracies on val> class : 76.92
------------------------------
<Accuracies on test> class : 62.81
------------------------------
<Accuracies on photo> test class : 72.99
------------------------------
<Accuracies on cartoon> test class : 57.34
------------------------------
<Accuracies on sketch> test class : 61.75
------------------------------
Total epoch time: 47.599

New epoch - lr: 0.003
[1/28 iteration of epoch 16/30] 
 {loss} cls : 0.159, total : 0.159 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.105, total : 0.105
<Accuracies on train> cls : 96.32
Train epoch time: 10.580
------------------------------
<Accuracies on val> class : 76.44
------------------------------
<Accuracies on test> class : 65.08
------------------------------
<Accuracies on photo> test class : 74.31
------------------------------
<Accuracies on cartoon> test class : 59.17
------------------------------
<Accuracies on sketch> test class : 64.67
------------------------------
Total epoch time: 45.836

New epoch - lr: 0.003
[1/28 iteration of epoch 17/30] 
 {loss} cls : 0.107, total : 0.107 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.084, total : 0.084
<Accuracies on train> cls : 97.04
Train epoch time: 11.884
------------------------------
<Accuracies on val> class : 77.88
------------------------------
<Accuracies on test> class : 64.35
------------------------------
<Accuracies on photo> test class : 74.91
------------------------------
<Accuracies on cartoon> test class : 58.11
------------------------------
<Accuracies on sketch> test class : 63.58
------------------------------
Total epoch time: 49.126

New epoch - lr: 0.003
[1/28 iteration of epoch 18/30] 
 {loss} cls : 0.077, total : 0.077 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.081, total : 0.081
<Accuracies on train> cls : 97.15
Train epoch time: 11.023
------------------------------
<Accuracies on val> class : 76.92
------------------------------
<Accuracies on test> class : 65.55
------------------------------
<Accuracies on photo> test class : 75.09
------------------------------
<Accuracies on cartoon> test class : 58.79
------------------------------
<Accuracies on sketch> test class : 65.54
------------------------------
Total epoch time: 46.623

New epoch - lr: 0.003
[1/28 iteration of epoch 19/30] 
 {loss} cls : 0.050, total : 0.050 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.088, total : 0.088
<Accuracies on train> cls : 97.15
Train epoch time: 12.191
------------------------------
<Accuracies on val> class : 79.33
------------------------------
<Accuracies on test> class : 65.74
------------------------------
<Accuracies on photo> test class : 75.99
------------------------------
<Accuracies on cartoon> test class : 61.05
------------------------------
<Accuracies on sketch> test class : 64.19
------------------------------
Total epoch time: 47.638

New epoch - lr: 0.003
[1/28 iteration of epoch 20/30] 
 {loss} cls : 0.036, total : 0.036 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.071, total : 0.071
<Accuracies on train> cls : 97.43
Train epoch time: 11.785
------------------------------
<Accuracies on val> class : 74.04
------------------------------
<Accuracies on test> class : 60.90
------------------------------
<Accuracies on photo> test class : 73.53
------------------------------
<Accuracies on cartoon> test class : 53.41
------------------------------
<Accuracies on sketch> test class : 59.99
------------------------------
Total epoch time: 46.474

New epoch - lr: 0.003
[1/28 iteration of epoch 21/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.063, total : 0.063
<Accuracies on train> cls : 97.43
Train epoch time: 12.734
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 67.33
------------------------------
<Accuracies on photo> test class : 76.65
------------------------------
<Accuracies on cartoon> test class : 62.63
------------------------------
<Accuracies on sketch> test class : 66.17
------------------------------
Total epoch time: 47.100

New epoch - lr: 0.003
[1/28 iteration of epoch 22/30] 
 {loss} cls : 0.103, total : 0.103 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.077, total : 0.077
<Accuracies on train> cls : 97.32
Train epoch time: 11.935
------------------------------
<Accuracies on val> class : 72.12
------------------------------
<Accuracies on test> class : 65.83
------------------------------
<Accuracies on photo> test class : 77.66
------------------------------
<Accuracies on cartoon> test class : 59.22
------------------------------
<Accuracies on sketch> test class : 64.75
------------------------------
Total epoch time: 47.077

New epoch - lr: 0.003
[1/28 iteration of epoch 23/30] 
 {loss} cls : 0.039, total : 0.039 
 {acc} cls : 96.88
------------------------------
<Losses on train> cls : 0.052, total : 0.052
<Accuracies on train> cls : 98.05
Train epoch time: 12.892
------------------------------
<Accuracies on val> class : 77.40
------------------------------
<Accuracies on test> class : 64.71
------------------------------
<Accuracies on photo> test class : 75.15
------------------------------
<Accuracies on cartoon> test class : 61.95
------------------------------
<Accuracies on sketch> test class : 61.92
------------------------------
Total epoch time: 46.480

New epoch - lr: 0.003
[1/28 iteration of epoch 24/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.062, total : 0.062
<Accuracies on train> cls : 98.16
Train epoch time: 11.594
------------------------------
<Accuracies on val> class : 80.29
------------------------------
<Accuracies on test> class : 64.04
------------------------------
<Accuracies on photo> test class : 76.29
------------------------------
<Accuracies on cartoon> test class : 56.87
------------------------------
<Accuracies on sketch> test class : 63.12
------------------------------
Total epoch time: 48.237

New epoch - lr: 0.003
[1/28 iteration of epoch 25/30] 
 {loss} cls : 0.073, total : 0.073 
 {acc} cls : 95.31
------------------------------
<Losses on train> cls : 0.049, total : 0.049
<Accuracies on train> cls : 98.21
Train epoch time: 11.495
------------------------------
<Accuracies on val> class : 80.77
------------------------------
<Accuracies on test> class : 64.89
------------------------------
<Accuracies on photo> test class : 76.53
------------------------------
<Accuracies on cartoon> test class : 56.87
------------------------------
<Accuracies on sketch> test class : 64.72
------------------------------
Total epoch time: 47.936

New epoch - lr: 0.003
[1/28 iteration of epoch 26/30] 
 {loss} cls : 0.007, total : 0.007 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.039, total : 0.039
<Accuracies on train> cls : 98.83
Train epoch time: 11.305
------------------------------
<Accuracies on val> class : 82.69
------------------------------
<Accuracies on test> class : 67.58
------------------------------
<Accuracies on photo> test class : 78.26
------------------------------
<Accuracies on cartoon> test class : 57.94
------------------------------
<Accuracies on sketch> test class : 68.80
------------------------------
Total epoch time: 48.339

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 27/30] 
 {loss} cls : 0.013, total : 0.013 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.040, total : 0.040
<Accuracies on train> cls : 98.60
Train epoch time: 11.249
------------------------------
<Accuracies on val> class : 83.65
------------------------------
<Accuracies on test> class : 67.59
------------------------------
<Accuracies on photo> test class : 77.31
------------------------------
<Accuracies on cartoon> test class : 61.56
------------------------------
<Accuracies on sketch> test class : 67.07
------------------------------
Total epoch time: 47.179

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 28/30] 
 {loss} cls : 0.047, total : 0.047 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.024, total : 0.024
<Accuracies on train> cls : 99.27
Train epoch time: 11.569
------------------------------
<Accuracies on val> class : 82.69
------------------------------
<Accuracies on test> class : 67.62
------------------------------
<Accuracies on photo> test class : 77.90
------------------------------
<Accuracies on cartoon> test class : 60.96
------------------------------
<Accuracies on sketch> test class : 67.22
------------------------------
Total epoch time: 47.992

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 29/30] 
 {loss} cls : 0.023, total : 0.023 
 {acc} cls : 100.00
------------------------------
<Losses on train> cls : 0.035, total : 0.035
<Accuracies on train> cls : 98.94
Train epoch time: 10.552
------------------------------
<Accuracies on val> class : 81.25
------------------------------
<Accuracies on test> class : 65.55
------------------------------
<Accuracies on photo> test class : 78.02
------------------------------
<Accuracies on cartoon> test class : 58.02
------------------------------
<Accuracies on sketch> test class : 64.75
------------------------------
Total epoch time: 43.879

New epoch - lr: 0.0009000000000000002
[1/28 iteration of epoch 30/30] 
 {loss} cls : 0.062, total : 0.062 
 {acc} cls : 98.44
------------------------------
<Losses on train> cls : 0.021, total : 0.021
<Accuracies on train> cls : 99.39
Train epoch time: 10.571
------------------------------
<Accuracies on val> class : 83.17
------------------------------
<Accuracies on test> class : 66.69
------------------------------
<Accuracies on photo> test class : 77.84
------------------------------
<Accuracies on cartoon> test class : 59.64
------------------------------
<Accuracies on sketch> test class : 66.15
------------------------------
Total epoch time: 41.891

******************************
Best val 0.836538, corresponding test 0.675941 - best test: 0.676193

******************************
Best val 0.8365384340286255, corresponding photo test 0.7730538845062256

******************************
Best val 0.8365384340286255, corresponding cartoon test 0.6156143546104431

******************************
Best val 0.8365384340286255, corresponding sketch test 0.6706541180610657
